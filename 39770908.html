<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1711011676935" as="style"/><link rel="stylesheet" href="styles.css?v=1711011676935"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/getgrit/gritql">Show HN: GritQL, a Rust CLI for rewriting source code</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>morgante</span> | <span>45 comments</span></div><br/><div><div id="39772612" class="c"><input type="checkbox" id="c-39772612" checked=""/><div class="controls bullet"><span class="by">herrington_d</span><span>|</span><a href="#39773587">next</a><span>|</span><label class="collapse" for="c-39772612">[-]</label><label class="expand" for="c-39772612">[3 more]</label></div><br/><div class="children"><div class="content">Congrats from ast-grep team! Nice job Morgante!<p>GritQL shares a lot of common ground with ast-grep, which is also a code rewriter based on tree-sitter.<p>Interested folks may wonder about their difference. The key difference is that their surface APIs are quite different. 
GritQL is more like a DSL (or SQL).
while ast-grep is more like pattern language + embedded configuration in YAML. 
Check it out here if you are interested <a href="https:&#x2F;&#x2F;github.com&#x2F;ast-grep&#x2F;ast-grep">https:&#x2F;&#x2F;github.com&#x2F;ast-grep&#x2F;ast-grep</a></div><br/><div id="39775116" class="c"><input type="checkbox" id="c-39775116" checked=""/><div class="controls bullet"><span class="by">snthpy</span><span>|</span><a href="#39772612">parent</a><span>|</span><a href="#39773587">next</a><span>|</span><label class="collapse" for="c-39775116">[-]</label><label class="expand" for="c-39775116">[2 more]</label></div><br/><div class="children"><div class="content">This is great. Thanks for the link.<p>I&#x27;m just starting to learn about tree-sitter but my understanding is that it can also handle nested syntax, for example code in documentation html pages. Does sg support this a well?<p>What I would like to do is use sg to update my project&#x27;s code samples. Is that possible? What part of the docs should I look at for this?</div><br/><div id="39775593" class="c"><input type="checkbox" id="c-39775593" checked=""/><div class="controls bullet"><span class="by">herrington_d</span><span>|</span><a href="#39772612">root</a><span>|</span><a href="#39775116">parent</a><span>|</span><a href="#39773587">next</a><span>|</span><label class="collapse" for="c-39775593">[-]</label><label class="expand" for="c-39775593">[1 more]</label></div><br/><div class="children"><div class="content">Hi! This is Grit&#x27;s release news so please allow me to only briefly answer your question.
&gt; nested syntax
sg does not support it natively now and you need API to extract relevant text out.<p>For update code, I recommend first read the quick start, pattern and rule essentials<p><a href="https:&#x2F;&#x2F;ast-grep.github.io&#x2F;guide&#x2F;quick-start.html" rel="nofollow">https:&#x2F;&#x2F;ast-grep.github.io&#x2F;guide&#x2F;quick-start.html</a><p><a href="https:&#x2F;&#x2F;ast-grep.github.io&#x2F;guide&#x2F;pattern-syntax.html" rel="nofollow">https:&#x2F;&#x2F;ast-grep.github.io&#x2F;guide&#x2F;pattern-syntax.html</a><p><a href="https:&#x2F;&#x2F;ast-grep.github.io&#x2F;guide&#x2F;rule-config.html" rel="nofollow">https:&#x2F;&#x2F;ast-grep.github.io&#x2F;guide&#x2F;rule-config.html</a></div><br/></div></div></div></div></div></div><div id="39773587" class="c"><input type="checkbox" id="c-39773587" checked=""/><div class="controls bullet"><span class="by">primitivesuave</span><span>|</span><a href="#39772612">prev</a><span>|</span><a href="#39775184">next</a><span>|</span><label class="collapse" for="c-39773587">[-]</label><label class="expand" for="c-39773587">[2 more]</label></div><br/><div class="children"><div class="content">This is a great example of an open-core business model that I hope others will follow. Make something useful for everyone, and sell additional features in a hosted version (grit.io). I actually didn&#x27;t even know there was a hosted version until I clicked the outgoing links from the documentation.<p>I&#x27;ve experienced how much time these migrations take (and how error prone they are), especially once you have double-digit team sizes, so I definitely see the value proposition.</div><br/><div id="39773624" class="c"><input type="checkbox" id="c-39773624" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39773587">parent</a><span>|</span><a href="#39775184">next</a><span>|</span><label class="collapse" for="c-39773624">[-]</label><label class="expand" for="c-39773624">[1 more]</label></div><br/><div class="children"><div class="content">Thank you! We definitely want to give useful value to everyone.<p>To expand more on our business model, we see GritQL as a powerful but also relatively low-level tool. It can speed up your migration, but writing the query and generating&#x2F;testing the PRs still takes considerable time.<p>If you&#x27;d prefer to have migrations handled entirely for you, you can pay us to tackle that work. In additional to providing the migration code, we generate pull requests and hook into your CI pipeline to fix downstream test failures. [0]<p>[0] <a href="https:&#x2F;&#x2F;docs.grit.io&#x2F;workflows&#x2F;healing" rel="nofollow">https:&#x2F;&#x2F;docs.grit.io&#x2F;workflows&#x2F;healing</a></div><br/></div></div></div></div><div id="39775184" class="c"><input type="checkbox" id="c-39775184" checked=""/><div class="controls bullet"><span class="by">snthpy</span><span>|</span><a href="#39773587">prev</a><span>|</span><a href="#39772073">next</a><span>|</span><label class="collapse" for="c-39775184">[-]</label><label class="expand" for="c-39775184">[2 more]</label></div><br/><div class="children"><div class="content">This looks great! Thank you for building it. I&#x27;m looking forward to learning to use it.<p>I&#x27;m just starting to learn about tree-sitter but my understanding is that it can also handle nested syntax, for example code in documentation html pages. Does grit support this a well?<p>What I would like to do is use grit to update my project&#x27;s code samples with new releases or syntax changes. Is that possible? What part of the docs should I look at for this?</div><br/><div id="39775205" class="c"><input type="checkbox" id="c-39775205" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39775184">parent</a><span>|</span><a href="#39772073">next</a><span>|</span><label class="collapse" for="c-39775205">[-]</label><label class="expand" for="c-39775205">[1 more]</label></div><br/><div class="children"><div class="content">Yes, Grit does support embedded languages. Right now we support Vue syntax: <a href="https:&#x2F;&#x2F;github.com&#x2F;getgrit&#x2F;gritql&#x2F;blob&#x2F;4ff989e8d665cc9ffa2cbb8a9829e8c7e1072f6d&#x2F;crates&#x2F;language&#x2F;src&#x2F;javascript.rs#L173-L184">https:&#x2F;&#x2F;github.com&#x2F;getgrit&#x2F;gritql&#x2F;blob&#x2F;4ff989e8d665cc9ffa2cb...</a><p>We don&#x27;t have support for HTML yet, but if you open an issue we&#x27;re happy to explore it.</div><br/></div></div></div></div><div id="39772073" class="c"><input type="checkbox" id="c-39772073" checked=""/><div class="controls bullet"><span class="by">anotherpaulg</span><span>|</span><a href="#39775184">prev</a><span>|</span><a href="#39775496">next</a><span>|</span><label class="collapse" for="c-39772073">[-]</label><label class="expand" for="c-39772073">[4 more]</label></div><br/><div class="children"><div class="content">This looks great, thanks for building and sharing it.<p>Interested folks may also want to check out ast-grep:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;ast-grep&#x2F;ast-grep">https:&#x2F;&#x2F;github.com&#x2F;ast-grep&#x2F;ast-grep</a></div><br/><div id="39772177" class="c"><input type="checkbox" id="c-39772177" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39772073">parent</a><span>|</span><a href="#39772510">next</a><span>|</span><label class="collapse" for="c-39772177">[-]</label><label class="expand" for="c-39772177">[2 more]</label></div><br/><div class="children"><div class="content">ast-grep is great too, we&#x27;ve learned a lot from it. If you like yaml, you should definitely try ast-grep.<p>The main area GritQL shines is in taking simpler transformation patterns and composing them into complex migrations. For example, the OpenAI migration was built by incrementally handling the different edge cases we&#x27;ve seen in the wild: <a href="https:&#x2F;&#x2F;github.com&#x2F;getgrit&#x2F;stdlib&#x2F;blob&#x2F;main&#x2F;.grit&#x2F;patterns&#x2F;python&#x2F;openai.md">https:&#x2F;&#x2F;github.com&#x2F;getgrit&#x2F;stdlib&#x2F;blob&#x2F;main&#x2F;.grit&#x2F;patterns&#x2F;p...</a></div><br/><div id="39775526" class="c"><input type="checkbox" id="c-39775526" checked=""/><div class="controls bullet"><span class="by">ryanjshaw</span><span>|</span><a href="#39772073">root</a><span>|</span><a href="#39772177">parent</a><span>|</span><a href="#39772510">next</a><span>|</span><label class="collapse" for="c-39775526">[-]</label><label class="expand" for="c-39775526">[1 more]</label></div><br/><div class="children"><div class="content">Consider linking this and other complex examples in your readme, with before&#x2F;after blocks to demonstrate the power of your software.<p>I&#x27;ve spent the last 6 months building a static analyzer that mostly uses ASTs and couldn&#x27;t understand what you were offering after skimming the readme until I saw this link.<p>Now I&#x27;m thinking of how I could integrate something like this into my analyzer to simplify the implementation of some of the simpler rules.</div><br/></div></div></div></div><div id="39772510" class="c"><input type="checkbox" id="c-39772510" checked=""/><div class="controls bullet"><span class="by">herrington_d</span><span>|</span><a href="#39772073">parent</a><span>|</span><a href="#39772177">prev</a><span>|</span><a href="#39775496">next</a><span>|</span><label class="collapse" for="c-39772510">[-]</label><label class="expand" for="c-39772510">[1 more]</label></div><br/><div class="children"><div class="content">thanks for mentioning ast-grep!</div><br/></div></div></div></div><div id="39775496" class="c"><input type="checkbox" id="c-39775496" checked=""/><div class="controls bullet"><span class="by">CJefferson</span><span>|</span><a href="#39772073">prev</a><span>|</span><a href="#39773775">next</a><span>|</span><label class="collapse" for="c-39775496">[-]</label><label class="expand" for="c-39775496">[2 more]</label></div><br/><div class="children"><div class="content">Normally I wouldn&#x27;t suggest this, but have you considered integrating with AIs?<p>One tool I&#x27;ve been looking for (and I wonder if this is such a tool?) is something that can do things like rename variables in functions to &quot;more sensible names&quot;. Now, it&#x27;s not hard to get ChatGPT to read a function and suggest new names for variables, but if you ask it to also do the substitutions, there is an annoyingly high chance it break the function in the process.</div><br/><div id="39775734" class="c"><input type="checkbox" id="c-39775734" checked=""/><div class="controls bullet"><span class="by">worldsayshi</span><span>|</span><a href="#39775496">parent</a><span>|</span><a href="#39773775">next</a><span>|</span><label class="collapse" for="c-39775734">[-]</label><label class="expand" for="c-39775734">[1 more]</label></div><br/><div class="children"><div class="content">I suspect that ChatGPT would be quite challenged trying to write code in any language that wasn&#x27;t part of its training data. So a DSL that was just released would be a challenge.<p>Worth trying out though. Perhaps rule creation can be turned into function calls so it wouldn&#x27;t need to understand new syntax.</div><br/></div></div></div></div><div id="39773775" class="c"><input type="checkbox" id="c-39773775" checked=""/><div class="controls bullet"><span class="by">bilekas</span><span>|</span><a href="#39775496">prev</a><span>|</span><a href="#39772233">next</a><span>|</span><label class="collapse" for="c-39773775">[-]</label><label class="expand" for="c-39773775">[1 more]</label></div><br/><div class="children"><div class="content">This looks really interesting, especially the GritQL side of things, I remember playing around with doing something simular on a much smaller and tailored use-case so I have an idea how much effort is involved here, but seems like a really great idea to introduce a query language to move things smoother. Great work, can&#x27;t wait to play around.</div><br/></div></div><div id="39772233" class="c"><input type="checkbox" id="c-39772233" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#39773775">prev</a><span>|</span><a href="#39773440">next</a><span>|</span><label class="collapse" for="c-39772233">[-]</label><label class="expand" for="c-39772233">[4 more]</label></div><br/><div class="children"><div class="content"><i>apologies if this should be a discussion&#x2F;issue&#x2F;whatever but:</i><p>Do you envision going up against CodeQL and&#x2F;or &lt;<a href="https:&#x2F;&#x2F;www.jetbrains.com&#x2F;help&#x2F;qodana&#x2F;about-qodana.html" rel="nofollow">https:&#x2F;&#x2F;www.jetbrains.com&#x2F;help&#x2F;qodana&#x2F;about-qodana.html</a>&gt; by making semantic information available to the ast nodes? OT1H, I can imagine it could be an overwhelming increase in project scope, but OTOH it could also truly lead to some stunning transformation patterns<p>e.g. <a href="https:&#x2F;&#x2F;github.com&#x2F;github&#x2F;codeql&#x2F;blob&#x2F;v1.27.0&#x2F;java&#x2F;ql&#x2F;examples&#x2F;snippets&#x2F;unusedlocalvar.ql">https:&#x2F;&#x2F;github.com&#x2F;github&#x2F;codeql&#x2F;blob&#x2F;v1.27.0&#x2F;java&#x2F;ql&#x2F;exampl...</a> or even more &quot;textual&quot; semantics such as<p><pre><code>  var foo = &quot;hello&quot;.substring(1); &#x2F;&#x2F; knowing &quot;foo&quot; is a String
</code></pre>
Since you already have GitLab on your docs page, if I could pay for CodeQL over on GL that would be a game changer IMHO</div><br/><div id="39772274" class="c"><input type="checkbox" id="c-39772274" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39772233">parent</a><span>|</span><a href="#39773440">next</a><span>|</span><label class="collapse" for="c-39772274">[-]</label><label class="expand" for="c-39772274">[3 more]</label></div><br/><div class="children"><div class="content">One of the specific design goals we had was to make sure that the query engine isn&#x27;t tightly coupled to AST nodes.<p>We started with the AST, since that&#x27;s ultimately the foundation for code but the goal is to add more graphs on top. So you could do a query like this to find all cases where a function called `unsafe` is queried with an unknown value:<p>`unsafe($val)` where $val &lt;: type `unknown`<p>Is your interest in CodeQL primarily for security scans?</div><br/><div id="39772430" class="c"><input type="checkbox" id="c-39772430" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#39772233">root</a><span>|</span><a href="#39772274">parent</a><span>|</span><a href="#39773440">next</a><span>|</span><label class="collapse" for="c-39772430">[-]</label><label class="expand" for="c-39772430">[2 more]</label></div><br/><div class="children"><div class="content">security is up there, but from reading the examples in CodeQL it just seemed like it would be possible to express some truly great versions of &quot;don&#x27;t do that&quot; rules in it. I am a total JetBrains fanboi, and their introspections are world-class, but getting Qodana to run to completion before the heat death of the universe has proven to require more glucose than I have to offer it. Thus, I&#x27;m always interested in alternate implementations, even though I am <i>acutely</i> aware of the computational complexity of what I&#x27;m asking<p>I recalled another link I wish I had included in my question from the SourceGraph folks <a href="https:&#x2F;&#x2F;github.com&#x2F;sourcegraph&#x2F;scip#scip-code-intelligence-protocol">https:&#x2F;&#x2F;github.com&#x2F;sourcegraph&#x2F;scip#scip-code-intelligence-p...</a> which started out life as &quot;Language Server Indexing Protocol&quot; and seems to solve some similar project-wide introspection questions but TBH since their rug pull I&#x27;ve been a lot less willing to hitch my wagon to their train</div><br/><div id="39772470" class="c"><input type="checkbox" id="c-39772470" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39772233">root</a><span>|</span><a href="#39772430">parent</a><span>|</span><a href="#39773440">next</a><span>|</span><label class="collapse" for="c-39772470">[-]</label><label class="expand" for="c-39772470">[1 more]</label></div><br/><div class="children"><div class="content">Makes sense, we internally use GritQL as a super linter for some codebase-specific patterns. It&#x27;s pretty easy to set up: <a href="https:&#x2F;&#x2F;docs.grit.io&#x2F;guides&#x2F;ci" rel="nofollow">https:&#x2F;&#x2F;docs.grit.io&#x2F;guides&#x2F;ci</a><p>We&#x27;ve looked at both LSIF and SCIP from SourceGraph, though I expect we&#x27;ll end up building our own index to allow for more complex queries. We&#x27;re also incorporating some LLM functionality to express conditions you can&#x27;t program deterministically.<p>If you&#x27;re interested in being a design partner for some of our auto-review features feel free to email morgante@grit.io.</div><br/></div></div></div></div></div></div></div></div><div id="39773440" class="c"><input type="checkbox" id="c-39773440" checked=""/><div class="controls bullet"><span class="by">jcranmer</span><span>|</span><a href="#39772233">prev</a><span>|</span><a href="#39771635">next</a><span>|</span><label class="collapse" for="c-39773440">[-]</label><label class="expand" for="c-39773440">[2 more]</label></div><br/><div class="children"><div class="content">Sounds like a cool tool.<p>The ability to write rewrites as regular code fragments with metavariables feels like some ideas I&#x27;ve had in the past. However, it seems to me that your tool lacks the ability to do something like (in C&#x2F;C++&#x2F;etc. terms) &quot;replace every use of S::method($arg1) with S::method2(arg1, nullptr, $arg1)&quot;, where you have to do some amount of name resolution to know that x-&gt;method is a call to S::method, which seems like it is somewhat less useful for several kinds of rewrites I&#x27;m interested in.<p>(One of the main things I keep playing around with in my head is converting a C codebase into C++ by converting its ad-hoc vtable implementation into regular C++ virtual methods.)</div><br/><div id="39773568" class="c"><input type="checkbox" id="c-39773568" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39773440">parent</a><span>|</span><a href="#39771635">next</a><span>|</span><label class="collapse" for="c-39773568">[-]</label><label class="expand" for="c-39773568">[1 more]</label></div><br/><div class="children"><div class="content">We don&#x27;t have semantic information yet (it&#x27;s on the roadmap), but in many cases it&#x27;s sufficient to get that information from the AST by looking where the variable was originally defined.<p>For example: <a href="https:&#x2F;&#x2F;app.grit.io&#x2F;studio?key=TteyWLNGZGWFIC9EOiCRi" rel="nofollow">https:&#x2F;&#x2F;app.grit.io&#x2F;studio?key=TteyWLNGZGWFIC9EOiCRi</a><p>`$x.old($arg)` =&gt; `$x.new(&quot;method&quot;, _, $arg)` where {
    $program &lt;: contains `$x = new Thing($_)`
}<p>---<p>Long term we want to incorporate more semantic analysis, but for quick rewrites this has been pretty effective for us.</div><br/></div></div></div></div><div id="39771635" class="c"><input type="checkbox" id="c-39771635" checked=""/><div class="controls bullet"><span class="by">rattray</span><span>|</span><a href="#39773440">prev</a><span>|</span><a href="#39774945">next</a><span>|</span><label class="collapse" for="c-39771635">[-]</label><label class="expand" for="c-39771635">[3 more]</label></div><br/><div class="children"><div class="content">Very happy Grit customer here. Wish I&#x27;d had this instead of jscodeshift et al back when I was doing oodles of migrations at Stripe, but glad I have it now, and very excited to see them go open-source!</div><br/><div id="39771763" class="c"><input type="checkbox" id="c-39771763" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39771635">parent</a><span>|</span><a href="#39774945">next</a><span>|</span><label class="collapse" for="c-39771763">[-]</label><label class="expand" for="c-39771763">[2 more]</label></div><br/><div class="children"><div class="content">Thanks Alex! Your feedback has been super helpful.<p>Your suggestion to add the `--interactive` flag was hugely helpful, it&#x27;s become very commonly used.</div><br/><div id="39774275" class="c"><input type="checkbox" id="c-39774275" checked=""/><div class="controls bullet"><span class="by">rattray</span><span>|</span><a href="#39771635">root</a><span>|</span><a href="#39771763">parent</a><span>|</span><a href="#39774945">next</a><span>|</span><label class="collapse" for="c-39774275">[-]</label><label class="expand" for="c-39774275">[1 more]</label></div><br/><div class="children"><div class="content">Delighted to hear that!</div><br/></div></div></div></div></div></div><div id="39774945" class="c"><input type="checkbox" id="c-39774945" checked=""/><div class="controls bullet"><span class="by">lightandlight</span><span>|</span><a href="#39771635">prev</a><span>|</span><a href="#39771043">next</a><span>|</span><label class="collapse" for="c-39774945">[-]</label><label class="expand" for="c-39774945">[1 more]</label></div><br/><div class="children"><div class="content">The first tool like this I saw was [comby](<a href="https:&#x2F;&#x2F;comby.dev&#x2F;" rel="nofollow">https:&#x2F;&#x2F;comby.dev&#x2F;</a>). I remember it being a bit annoying to use for small-to-medium refactors. Next time I&#x27;ll try `grit` and see how it does.</div><br/></div></div><div id="39771043" class="c"><input type="checkbox" id="c-39771043" checked=""/><div class="controls bullet"><span class="by">mlejva</span><span>|</span><a href="#39774945">prev</a><span>|</span><a href="#39771223">next</a><span>|</span><label class="collapse" for="c-39771043">[-]</label><label class="expand" for="c-39771043">[1 more]</label></div><br/><div class="children"><div class="content">Congrats to the launch!<p>Managing tech debt is and will be an important issue in the world of AI software. I&#x27;m glad there&#x27;s a company solving this. Additionally, this is something the current generation of LLMs are already helpful at solving. GritQL is very unique way of approaching this problem.<p>OT: We&#x27;ve been working with Grit and Morgante for the past months and I have only positive things to say about them. If GritQL looks useful to you, you should reach out.</div><br/></div></div><div id="39771223" class="c"><input type="checkbox" id="c-39771223" checked=""/><div class="controls bullet"><span class="by">psalv</span><span>|</span><a href="#39771043">prev</a><span>|</span><a href="#39772204">next</a><span>|</span><label class="collapse" for="c-39771223">[-]</label><label class="expand" for="c-39771223">[2 more]</label></div><br/><div class="children"><div class="content">++ congratulations to the team!<p>We&#x27;ve tackled some pretty gnarly migrations with GritQL and it has saved us a lot of time.<p>We have used ts-morph in the past for similar types of migrations but found the barrier to entry felt high, which prevented adoption. We were impressed by how complicated of migrations we could use GritQL for—we have been using it to migrate from mobx to react hooks.</div><br/><div id="39771262" class="c"><input type="checkbox" id="c-39771262" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39771223">parent</a><span>|</span><a href="#39772204">next</a><span>|</span><label class="collapse" for="c-39771262">[-]</label><label class="expand" for="c-39771262">[1 more]</label></div><br/><div class="children"><div class="content">Thanks Paul! It&#x27;s been great getting your feedback as we&#x27;ve evolved Grit over time.</div><br/></div></div></div></div><div id="39772204" class="c"><input type="checkbox" id="c-39772204" checked=""/><div class="controls bullet"><span class="by">practicalrs</span><span>|</span><a href="#39771223">prev</a><span>|</span><a href="#39771473">next</a><span>|</span><label class="collapse" for="c-39772204">[-]</label><label class="expand" for="c-39772204">[3 more]</label></div><br/><div class="children"><div class="content">&quot;a Rust CLI&quot; - &quot;C 96.5% Rust 1.4%&quot;<p>Not that I&#x27;m complaining ;)<p>Is it a new way to market a C tool?</div><br/><div id="39772240" class="c"><input type="checkbox" id="c-39772240" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39772204">parent</a><span>|</span><a href="#39771473">next</a><span>|</span><label class="collapse" for="c-39772240">[-]</label><label class="expand" for="c-39772240">[2 more]</label></div><br/><div class="children"><div class="content">The C is all generated parsers, all our actual coding is done in Rust.</div><br/><div id="39772581" class="c"><input type="checkbox" id="c-39772581" checked=""/><div class="controls bullet"><span class="by">mdaniel</span><span>|</span><a href="#39772204">root</a><span>|</span><a href="#39772240">parent</a><span>|</span><a href="#39771473">next</a><span>|</span><label class="collapse" for="c-39772581">[-]</label><label class="expand" for="c-39772581">[1 more]</label></div><br/><div class="children"><div class="content">this audience will also enjoy(?) the tree-sitter discussion going on here: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39762495">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39762495</a><p>there are very similar complaints about &quot;yikes that thing just vomits a massive amount of loosey goosey C&quot; so I hope you&#x27;ve not experienced the crashes they&#x27;re talking about</div><br/></div></div></div></div></div></div><div id="39771473" class="c"><input type="checkbox" id="c-39771473" checked=""/><div class="controls bullet"><span class="by">jxnlco</span><span>|</span><a href="#39772204">prev</a><span>|</span><a href="#39774499">next</a><span>|</span><label class="collapse" for="c-39771473">[-]</label><label class="expand" for="c-39771473">[1 more]</label></div><br/><div class="children"><div class="content">this definitly helped a tonne to migrate from openai &lt;1.0 to 1.0</div><br/></div></div><div id="39774499" class="c"><input type="checkbox" id="c-39774499" checked=""/><div class="controls bullet"><span class="by">jkrubin</span><span>|</span><a href="#39771473">prev</a><span>|</span><a href="#39771619">next</a><span>|</span><label class="collapse" for="c-39774499">[-]</label><label class="expand" for="c-39774499">[1 more]</label></div><br/><div class="children"><div class="content">This really and truly looks fantastic.</div><br/></div></div><div id="39771619" class="c"><input type="checkbox" id="c-39771619" checked=""/><div class="controls bullet"><span class="by">ranman</span><span>|</span><a href="#39774499">prev</a><span>|</span><a href="#39775769">next</a><span>|</span><label class="collapse" for="c-39771619">[-]</label><label class="expand" for="c-39771619">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d love to see one of these for migrating from Claude&#x27;s prompt API to their messaging API</div><br/></div></div><div id="39775769" class="c"><input type="checkbox" id="c-39775769" checked=""/><div class="controls bullet"><span class="by">Walden98</span><span>|</span><a href="#39771619">prev</a><span>|</span><a href="#39773378">next</a><span>|</span><label class="collapse" for="c-39775769">[-]</label><label class="expand" for="c-39775769">[1 more]</label></div><br/><div class="children"><div class="content">thanks for sharing...</div><br/></div></div><div id="39773378" class="c"><input type="checkbox" id="c-39773378" checked=""/><div class="controls bullet"><span class="by">MichaelMug</span><span>|</span><a href="#39775769">prev</a><span>|</span><label class="collapse" for="c-39773378">[-]</label><label class="expand" for="c-39773378">[10 more]</label></div><br/><div class="children"><div class="content">Can I use this to translate one language to another?</div><br/><div id="39773429" class="c"><input type="checkbox" id="c-39773429" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39773378">parent</a><span>|</span><label class="collapse" for="c-39773429">[-]</label><label class="expand" for="c-39773429">[9 more]</label></div><br/><div class="children"><div class="content">In theory, you could write a full transpiler in GritQL.<p>In practice, it&#x27;s not really the ideal tool for translating between languages.<p>It does work well for cases where the differences are minor (ex. converting from JavaScript to TypeScript, or between different SQL dialects).</div><br/><div id="39775299" class="c"><input type="checkbox" id="c-39775299" checked=""/><div class="controls bullet"><span class="by">snthpy</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39773429">parent</a><span>|</span><a href="#39775215">next</a><span>|</span><label class="collapse" for="c-39775299">[-]</label><label class="expand" for="c-39775299">[3 more]</label></div><br/><div class="children"><div class="content">@morgante Are you aware of any tools that do codegen from tree-sitter ASTs?<p>A simple application would be to produce a code formatter like Black or ruff for python but which could support any tree-sitter supported language.<p>More specifically to my use case though, if I produced tree-sitter grammars with identical node structure and node names, e.g. for sqlite and postgresql, then wouldn&#x27;t this make it simple to do full transpilation between the two?</div><br/><div id="39775350" class="c"><input type="checkbox" id="c-39775350" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39775299">parent</a><span>|</span><a href="#39775215">next</a><span>|</span><label class="collapse" for="c-39775350">[-]</label><label class="expand" for="c-39775350">[2 more]</label></div><br/><div class="children"><div class="content">You should check out <a href="https:&#x2F;&#x2F;github.com&#x2F;tweag&#x2F;topiary">https:&#x2F;&#x2F;github.com&#x2F;tweag&#x2F;topiary</a><p>Yes, theoretically if you had ~identical grammars you could use it to do a full transpilation. There&#x27;s a lot of challenges with that though. Writing a correct grammar for 1 language is complicated enough, but writing one for two where all your nodes and fields end up the same is likely insurmountable.<p>In practice, languages are either:<p>- Far enough apart that any pure AST transformation is insufficient and you need an AI component to produce usable output<p>- Close enough that you&#x27;re better off just targeting the specific parts that differ and rewriting those while leaving the rest alone. I think GritQL can do well here.</div><br/><div id="39775392" class="c"><input type="checkbox" id="c-39775392" checked=""/><div class="controls bullet"><span class="by">snthpy</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39775350">parent</a><span>|</span><a href="#39775215">next</a><span>|</span><label class="collapse" for="c-39775392">[-]</label><label class="expand" for="c-39775392">[1 more]</label></div><br/><div class="children"><div class="content">Awesome, thanks. Big fan of the Tweag folks and Nix and Nickel so will definitely check it out.</div><br/></div></div></div></div></div></div><div id="39775215" class="c"><input type="checkbox" id="c-39775215" checked=""/><div class="controls bullet"><span class="by">snthpy</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39773429">parent</a><span>|</span><a href="#39775299">prev</a><span>|</span><a href="#39775127">next</a><span>|</span><label class="collapse" for="c-39775215">[-]</label><label class="expand" for="c-39775215">[3 more]</label></div><br/><div class="children"><div class="content">I have the same question. I&#x27;m particularly interested in the SQL dialects case.<p>Does the rewrite code also have to be syntactically correct or is that a simple text replacement because that&#x27;s what I see as the main impediment; if I&#x27;m using the sqlite grammar to parse and produce postgresql output, the output won&#x27;t conform to the grammar.<p>Also how do I dynamically load custom tree-sitter grammars like in ast-grep?</div><br/><div id="39775248" class="c"><input type="checkbox" id="c-39775248" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39775215">parent</a><span>|</span><a href="#39775127">next</a><span>|</span><label class="collapse" for="c-39775248">[-]</label><label class="expand" for="c-39775248">[2 more]</label></div><br/><div class="children"><div class="content">&gt; Does the rewrite code also have to be syntactically correct or is that a simple text replacement because that&#x27;s what I see as the main impediment; if I&#x27;m using the sqlite grammar to parse and produce postgresql output, the output won&#x27;t conform to the grammar.<p>No, we don&#x27;t require the output code to be syntactically correct. You can use the raw`code` modified to indicate a raw text replacement: <a href="https:&#x2F;&#x2F;docs.grit.io&#x2F;language&#x2F;patterns#raw-output" rel="nofollow">https:&#x2F;&#x2F;docs.grit.io&#x2F;language&#x2F;patterns#raw-output</a><p>&gt; Also how do I dynamically load custom tree-sitter grammars like in ast-grep?<p>We don&#x27;t currently support dynamically loading grammars, mainly because our metavariable approach requires some modifications to the grammar.</div><br/><div id="39775342" class="c"><input type="checkbox" id="c-39775342" checked=""/><div class="controls bullet"><span class="by">snthpy</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39775248">parent</a><span>|</span><a href="#39775127">next</a><span>|</span><label class="collapse" for="c-39775342">[-]</label><label class="expand" for="c-39775342">[1 more]</label></div><br/><div class="children"><div class="content">Thank you. The raw&quot;...&quot; directive looks perfect for what I&#x27;m looking for.</div><br/></div></div></div></div></div></div><div id="39775127" class="c"><input type="checkbox" id="c-39775127" checked=""/><div class="controls bullet"><span class="by">ayewo</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39773429">parent</a><span>|</span><a href="#39775215">prev</a><span>|</span><label class="collapse" for="c-39775127">[-]</label><label class="expand" for="c-39775127">[2 more]</label></div><br/><div class="children"><div class="content">But Grit should be able to handle translating a PHP dialect like Hacklang to a modern version of PHP?<p>In your opinion, what tools would be ideal for general purpose transpilation between languages?</div><br/><div id="39775193" class="c"><input type="checkbox" id="c-39775193" checked=""/><div class="controls bullet"><span class="by">morgante</span><span>|</span><a href="#39773378">root</a><span>|</span><a href="#39775127">parent</a><span>|</span><label class="collapse" for="c-39775193">[-]</label><label class="expand" for="c-39775193">[1 more]</label></div><br/><div class="children"><div class="content">&gt; But Grit should be able to handle translating a PHP dialect like Hacklang to a modern version of PHP?<p>Yeah, that should be doable (though GritQL doesn&#x27;t have PHP support yet).<p>&gt; In your opinion, what tools would be ideal for general purpose transpilation between languages?<p>Writing a transpiler is quite complicated and requires a lot of development to get right. I don&#x27;t know of any high-quality generalized transpilers—you&#x27;re best looking for tools specific to the language pair you&#x27;re targeting.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>