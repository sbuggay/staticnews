<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1689066068329" as="style"/><link rel="stylesheet" href="styles.css?v=1689066068329"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.getlocalcert.net/">Easy HTTPS for your private networks</a> <span class="domain">(<a href="https://www.getlocalcert.net">www.getlocalcert.net</a>)</span></div><div class="subtext"><span>8organicbits</span> | <span>76 comments</span></div><br/><div><div id="36675837" class="c"><input type="checkbox" id="c-36675837" checked=""/><div class="controls bullet"><span class="by">seiferteric</span><span>|</span><a href="#36675306">next</a><span>|</span><label class="collapse" for="c-36675837">[-]</label><label class="expand" for="c-36675837">[5 more]</label></div><br/><div class="children"><div class="content">Cool, but as others said fairly easy to do on your own already. Sort of related but a problem I have been trying to solve is, how to create a trusted certificate for a new device on a private network automatically without any configuration? For example, imagine you are turning up a new router or switch with a Web UI for management. Traditionally this is served on http initially and you can optionally install a cert and enable https. It would be nice to have a way to have this happen automatically to obviate the need for http at all. Also consider that this private network may not be connected to the internet at all and so can&#x27;t rely on outside servers.<p>I was kicking around the idea for an rfc that would be something like this. Your DHCP server would have an option to act as a CA (or point at one), with ACME protocol enabled. Then, you add DHCP option fields telling clients to trust this new CA certificate, but only for hosts on this local network (to avoid being able to MITM outside connections). Then clients on this network would be able to request certificates from the CA using ACME automatically and others on the network would automatically trust them assuming support for this standard was added the OS or browsers etc.</div><br/><div id="36675925" class="c"><input type="checkbox" id="c-36675925" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675837">parent</a><span>|</span><a href="#36677505">next</a><span>|</span><label class="collapse" for="c-36675925">[-]</label><label class="expand" for="c-36675925">[1 more]</label></div><br/><div class="children"><div class="content">You can get somewhat close to that with getlocalcert. When the device first boots, it calls the getlocalcert API to register a free, anonymous domain name (negative: its a UUID domain, ugly). You&#x27;d need outbound connections to api.getlocalcert.net and an ACME certificate authority (Let&#x27;s Encrypt) to issue a ccertificate. When the user connects to <a href="http:&#x2F;&#x2F;&lt;ip-address&gt;" rel="nofollow noreferrer">http:&#x2F;&#x2F;&lt;ip-address&gt;</a> it redirects to <a href="https:&#x2F;&#x2F;&lt;uuid&gt;.localcert.net" rel="nofollow noreferrer">https:&#x2F;&#x2F;&lt;uuid&gt;.localcert.net</a>, which the browser trusts since the cert is from a public CA. No need to manually trust a cert. The user would bookmark it and all future use is HTTPS-only.<p>If I see usage like this, there&#x27;s ways I can make this cleaner.</div><br/></div></div><div id="36677505" class="c"><input type="checkbox" id="c-36677505" checked=""/><div class="controls bullet"><span class="by">hartmel</span><span>|</span><a href="#36675837">parent</a><span>|</span><a href="#36675925">prev</a><span>|</span><a href="#36677028">next</a><span>|</span><label class="collapse" for="c-36677505">[-]</label><label class="expand" for="c-36677505">[1 more]</label></div><br/><div class="children"><div class="content">There is SCEP (<a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Simple_Certificate_Enrollment_Protocol" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Simple_Certificate_Enrollmen...</a>) which allows that and is often found on network devices.
You need a PKI which exposes a SCEP endpoint (ejbca or dogtag supports this).
That the certificate is used as certificate for the HTTPS is up to the device implementation of the scep client or something else in the client though.<p>On servers, certmonger can do scep iirc. On private infrastructure, FreeIPA provides a packaged dogtag and you can create your own certificate profiles. Clients enrolled in freeipa have certmonger installed to refresh certificates.</div><br/></div></div><div id="36677028" class="c"><input type="checkbox" id="c-36677028" checked=""/><div class="controls bullet"><span class="by">andrecarini</span><span>|</span><a href="#36675837">parent</a><span>|</span><a href="#36677505">prev</a><span>|</span><a href="#36675963">next</a><span>|</span><label class="collapse" for="c-36677028">[-]</label><label class="expand" for="c-36677028">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like BRSKI [1].<p>[1]: <a href="https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;rfc8995&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;rfc8995&#x2F;</a></div><br/></div></div><div id="36675963" class="c"><input type="checkbox" id="c-36675963" checked=""/><div class="controls bullet"><span class="by">byteknight</span><span>|</span><a href="#36675837">parent</a><span>|</span><a href="#36677028">prev</a><span>|</span><a href="#36675306">next</a><span>|</span><label class="collapse" for="c-36675963">[-]</label><label class="expand" for="c-36675963">[1 more]</label></div><br/><div class="children"><div class="content">Sounds like you&#x27;re describing a process similar to SCP over HTTPs. That is available (albeit windows hosted) and fully functional across any client OS.</div><br/></div></div></div></div><div id="36675306" class="c"><input type="checkbox" id="c-36675306" checked=""/><div class="controls bullet"><span class="by">Humphrey</span><span>|</span><a href="#36675837">prev</a><span>|</span><a href="#36675000">next</a><span>|</span><label class="collapse" for="c-36675306">[-]</label><label class="expand" for="c-36675306">[10 more]</label></div><br/><div class="children"><div class="content">Or, it&#x27;s super easy to roll your own using letsencrypt.<p>1. Buy your own public domain (such as companyname.dev)<p>2. Setup a LetsEncrypt wildcard certificate with DNS validation<p>3. Update your &#x2F;etc&#x2F;hosts to something like `127.0.0.1 companyname.dev`<p>We have this working with multiple developers, each renewing their certificates themselves.  Works great, it&#x27;s simple, and don&#x27;t need to trust an extra third party.</div><br/><div id="36675418" class="c"><input type="checkbox" id="c-36675418" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675306">parent</a><span>|</span><a href="#36675531">next</a><span>|</span><label class="collapse" for="c-36675418">[-]</label><label class="expand" for="c-36675418">[2 more]</label></div><br/><div class="children"><div class="content">Correct, a distinction with this service is that the domain names are free. One part of my decision to build this service was the fall of freenom (free domain names).<p>Typically free domain name services are full of spam, malware, and other junk. getlocalcert seeks to avoid that as it only permits private network usage. My hope is that this model can serve that niche while avoiding abuse.</div><br/><div id="36677476" class="c"><input type="checkbox" id="c-36677476" checked=""/><div class="controls bullet"><span class="by">Humphrey</span><span>|</span><a href="#36675306">root</a><span>|</span><a href="#36675418">parent</a><span>|</span><a href="#36675531">next</a><span>|</span><label class="collapse" for="c-36677476">[-]</label><label class="expand" for="c-36677476">[1 more]</label></div><br/><div class="children"><div class="content">Yeah nice!  Good to know</div><br/></div></div></div></div><div id="36675531" class="c"><input type="checkbox" id="c-36675531" checked=""/><div class="controls bullet"><span class="by">esbeeb</span><span>|</span><a href="#36675306">parent</a><span>|</span><a href="#36675418">prev</a><span>|</span><a href="#36675363">next</a><span>|</span><label class="collapse" for="c-36675531">[-]</label><label class="expand" for="c-36675531">[5 more]</label></div><br/><div class="children"><div class="content">Last time I checked, those wildcard LetsEncrypt certs take more work to get, like passing a DNS-based TXT record challenge. Then once you have the wildcard certs, they only last 3 months.  Once obtained, they can manually be copied into the LAN using a tool like wormhole. There&#x27;s a lot of manual steps here which are far harder than how certbot will auto-renew certs when in the cloud - usually requiring no manual intervention, once you succeed that first time.</div><br/><div id="36675677" class="c"><input type="checkbox" id="c-36675677" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675306">root</a><span>|</span><a href="#36675531">parent</a><span>|</span><a href="#36677544">next</a><span>|</span><label class="collapse" for="c-36675677">[-]</label><label class="expand" for="c-36675677">[1 more]</label></div><br/><div class="children"><div class="content">One of my inspirations for getlocalcert is a tool to make DNS-01 easier.<p>acme-dns let&#x27;s you add a CNAME to another DNS zone, which let&#x27;s you issue certificates for the former domain name using a convenient API for the latter zone. Seriously read about it, it&#x27;s awesome.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;joohoi&#x2F;acme-dns&#x2F;">https:&#x2F;&#x2F;github.com&#x2F;joohoi&#x2F;acme-dns&#x2F;</a><p>That tool is open source and self-hostable. getlocalcert also provides this feature, but as a hosted service. Choose the method you prefer.<p><a href="https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;tips&#x2F;validation-domain&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;tips&#x2F;validation-domain&#x2F;</a><p>Once DNS-01 is easy, wildcard certs are easy. Here&#x27;s the docs for setting up a wildcard cert via getlocalcert:
<a href="https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;acme-clients&#x2F;lego&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;acme-clients&#x2F;lego&#x2F;</a></div><br/></div></div><div id="36677544" class="c"><input type="checkbox" id="c-36677544" checked=""/><div class="controls bullet"><span class="by">Humphrey</span><span>|</span><a href="#36675306">root</a><span>|</span><a href="#36675531">parent</a><span>|</span><a href="#36675677">prev</a><span>|</span><a href="#36676460">next</a><span>|</span><label class="collapse" for="c-36677544">[-]</label><label class="expand" for="c-36677544">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  Once obtained, they can manually be copied into the LAN using a tool like wormhole.<p>We haven&#x27;t needed to copy the certs around the LAN.  It works fine with dev&#x27;s just individually running certbot renew as needed.<p>Yes, it tooks us a fair bit of fiddling around to work out how to do it, but final result is super simple.  So I definitely would have considered a project like this in the past, but now we&#x27;ve got the scripts for it, it&#x27;s pretty simple.</div><br/></div></div><div id="36676460" class="c"><input type="checkbox" id="c-36676460" checked=""/><div class="controls bullet"><span class="by">bruce511</span><span>|</span><a href="#36675306">root</a><span>|</span><a href="#36675531">parent</a><span>|</span><a href="#36677544">prev</a><span>|</span><a href="#36675587">next</a><span>|</span><label class="collapse" for="c-36676460">[-]</label><label class="expand" for="c-36676460">[1 more]</label></div><br/><div class="children"><div class="content">All the steps are automatable though. I know cause I built it into my own server engine.<p>This service looks like the same thing. I guess if you&#x27;re limited to certain then you can only do what it does, but I&#x27;m guessing there&#x27;s lots of alternative software that&#x27;ll do the DNS challenge if you look.</div><br/></div></div></div></div><div id="36675363" class="c"><input type="checkbox" id="c-36675363" checked=""/><div class="controls bullet"><span class="by">klysm</span><span>|</span><a href="#36675306">parent</a><span>|</span><a href="#36675531">prev</a><span>|</span><a href="#36675000">next</a><span>|</span><label class="collapse" for="c-36675363">[-]</label><label class="expand" for="c-36675363">[2 more]</label></div><br/><div class="children"><div class="content">Just at the whole domain or does each dev make their own subdomain?</div><br/><div id="36677524" class="c"><input type="checkbox" id="c-36677524" checked=""/><div class="controls bullet"><span class="by">Humphrey</span><span>|</span><a href="#36675306">root</a><span>|</span><a href="#36675363">parent</a><span>|</span><a href="#36675000">next</a><span>|</span><label class="collapse" for="c-36677524">[-]</label><label class="expand" for="c-36677524">[1 more]</label></div><br/><div class="children"><div class="content">We setup each project with it&#x27;s own subdomain... so a &#x2F;etc&#x2F;hosts file would be something like<p>127.0.0.1 client7.companyname.dev our-amazing-product.companyname.dev postgres2.companyname.dev<p>So, then we can use the same settings, etc across devs.<p>Then each dev just runs the script to renew the script as they are needed (no need to share certs between devs)</div><br/></div></div></div></div></div></div><div id="36675000" class="c"><input type="checkbox" id="c-36675000" checked=""/><div class="controls bullet"><span class="by">schlarpc</span><span>|</span><a href="#36675306">prev</a><span>|</span><a href="#36676885">next</a><span>|</span><label class="collapse" for="c-36675000">[-]</label><label class="expand" for="c-36675000">[3 more]</label></div><br/><div class="children"><div class="content">Somewhat related - I made a bridge server [1] that lets ACME clients use standard RFC2136 to solve DNS-01 challenges for internal names without them needing credentials for the actual DNS backend (Route 53 in my case).<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;schlarpc&#x2F;rfc2136_bridge&#x2F;blob&#x2F;main&#x2F;src&#x2F;rfc2136_bridge&#x2F;app.py">https:&#x2F;&#x2F;github.com&#x2F;schlarpc&#x2F;rfc2136_bridge&#x2F;blob&#x2F;main&#x2F;src&#x2F;rfc...</a></div><br/><div id="36676537" class="c"><input type="checkbox" id="c-36676537" checked=""/><div class="controls bullet"><span class="by">bruce511</span><span>|</span><a href="#36675000">parent</a><span>|</span><a href="#36676019">next</a><span>|</span><label class="collapse" for="c-36676537">[-]</label><label class="expand" for="c-36676537">[1 more]</label></div><br/><div class="children"><div class="content">I did exactly the same for our local-cloud products.<p>Our local-cloud program connects to our &quot;certificate server&quot;, and asks for a name&#x2F;ip combination.<p>Our certificate server gets it using API access to our &quot;local-cloud&quot; domain. The local machine receives it.<p>So the end user does not have the Domain credentials. They have credentials to our cert server, but those have very limited value (and would need to be decrypted first.)</div><br/></div></div><div id="36676019" class="c"><input type="checkbox" id="c-36676019" checked=""/><div class="controls bullet"><span class="by">linsomniac</span><span>|</span><a href="#36675000">parent</a><span>|</span><a href="#36676537">prev</a><span>|</span><a href="#36676885">next</a><span>|</span><label class="collapse" for="c-36676019">[-]</label><label class="expand" for="c-36676019">[1 more]</label></div><br/><div class="children"><div class="content">Interesting idea.<p>I have a workflow for creating AWS credentials that are restricted to doing the LetsEncrypt DNS challenges for just a single sub-domain, and that seems to be working well.  <a href="https:&#x2F;&#x2F;linsomniac.gitlab.io&#x2F;post&#x2F;2019-09-10-letsencrypt-with-route53&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;linsomniac.gitlab.io&#x2F;post&#x2F;2019-09-10-letsencrypt-wit...</a></div><br/></div></div></div></div><div id="36676885" class="c"><input type="checkbox" id="c-36676885" checked=""/><div class="controls bullet"><span class="by">donselaar</span><span>|</span><a href="#36675000">prev</a><span>|</span><a href="#36675167">next</a><span>|</span><label class="collapse" for="c-36676885">[-]</label><label class="expand" for="c-36676885">[1 more]</label></div><br/><div class="children"><div class="content">I really hope DANE will become more popular (and widely supported) some time. Works great on air gapped networks without the need for a publicly trusted CA or Let&#x27;s Encrypt. No ACME daemon to monitor, just put your public key in a DNS record an forget about it.</div><br/></div></div><div id="36675167" class="c"><input type="checkbox" id="c-36675167" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#36676885">prev</a><span>|</span><a href="#36675067">next</a><span>|</span><label class="collapse" for="c-36675167">[-]</label><label class="expand" for="c-36675167">[23 more]</label></div><br/><div class="children"><div class="content">This is unnecessary<p>It is straightforward to create your own Root CA and use it to sign certificates for your private network, using openssl.<p>Ensure that you implement the V3 extensions with @altnames, for the certificates you issue, with a &quot;DNS =&gt; &lt;FQDN&gt;&quot; (or you can use an IP address instead of FDN.  I have not experimented with that).   .local domain names work fine<p>If you do not implement &quot;@altnames&quot; the certificate will work for tools like curl, wget &quot;openssl s_client&quot;, but not for browsers.  (In my notes some place I am too lazy to go and read there is a reference to the RFC that documents that you do not have to use the subject&#x2F;CN, mēh)<p>There are other tools (than openssl) that do this to.<p>Using this service means you really do not have a private network</div><br/><div id="36676108" class="c"><input type="checkbox" id="c-36676108" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36677547">next</a><span>|</span><label class="collapse" for="c-36676108">[-]</label><label class="expand" for="c-36676108">[9 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve been pretty frustrated with how private CAs are supported. Your private root CA can be maliciously used to MITM every domain on the Internet, even though you intend to use it for only a couple domain names. Most people forget to set Name Constraints when they create these and many helper tools lack support [1][2]. Worse, browser support for Name Constraints has been slow [3] and support isn&#x27;t well tracked [4]. Public CAs give you certificate transparency and you can subscribe to events to detect mis-issuance. Some hosted private CAs like AWS&#x27;s offer logs [5], but DIY setups don&#x27;t.<p>Even still, there are a lot of folks happily using private CAs, they aren&#x27;t the target audience for this initial release.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;FiloSottile&#x2F;mkcert&#x2F;issues&#x2F;302">https:&#x2F;&#x2F;github.com&#x2F;FiloSottile&#x2F;mkcert&#x2F;issues&#x2F;302</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;cert-manager&#x2F;cert-manager&#x2F;issues&#x2F;3655">https:&#x2F;&#x2F;github.com&#x2F;cert-manager&#x2F;cert-manager&#x2F;issues&#x2F;3655</a><p>[3] <a href="https:&#x2F;&#x2F;alexsci.com&#x2F;blog&#x2F;name-non-constraint&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;alexsci.com&#x2F;blog&#x2F;name-non-constraint&#x2F;</a><p>[4] <a href="https:&#x2F;&#x2F;github.com&#x2F;Netflix&#x2F;bettertls&#x2F;issues&#x2F;19">https:&#x2F;&#x2F;github.com&#x2F;Netflix&#x2F;bettertls&#x2F;issues&#x2F;19</a><p>[5] <a href="https:&#x2F;&#x2F;docs.aws.amazon.com&#x2F;privateca&#x2F;latest&#x2F;userguide&#x2F;security-logging-and-monitoring.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.aws.amazon.com&#x2F;privateca&#x2F;latest&#x2F;userguide&#x2F;secur...</a></div><br/><div id="36676505" class="c"><input type="checkbox" id="c-36676505" checked=""/><div class="controls bullet"><span class="by">bruce511</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676108">parent</a><span>|</span><a href="#36677765">next</a><span>|</span><label class="collapse" for="c-36676505">[-]</label><label class="expand" for="c-36676505">[3 more]</label></div><br/><div class="children"><div class="content">Let me put it this way;<p>You might get away with installing your RootCA on your in-office PCs that you own.<p>Good luck though getting me to install it on my (external contractor) laptop or my (employee) phone, or my (hosted) VMS machines. -you- may plan to only use the CA for good, but I don&#x27;t trust you (and by extension all your IT staff, present, past, and future) to be angels.</div><br/><div id="36676784" class="c"><input type="checkbox" id="c-36676784" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676505">parent</a><span>|</span><a href="#36677134">next</a><span>|</span><label class="collapse" for="c-36676784">[-]</label><label class="expand" for="c-36676784">[1 more]</label></div><br/><div class="children"><div class="content">Exactly. It&#x27;s one of the reasons I use separate VMs per client when I freelance. I want to install the cert, so I don&#x27;t see the cert warning messages or accidentally click through a real MITM attack, but never on the host OS. That could let the client MITM all sorts of stuff like my email to other clients if Thunderbird syncs at a client site.</div><br/></div></div><div id="36677134" class="c"><input type="checkbox" id="c-36677134" checked=""/><div class="controls bullet"><span class="by">skrebbel</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676505">parent</a><span>|</span><a href="#36676784">prev</a><span>|</span><a href="#36677765">next</a><span>|</span><label class="collapse" for="c-36677134">[-]</label><label class="expand" for="c-36677134">[1 more]</label></div><br/><div class="children"><div class="content">Kinda nuts actually that you can’t install a Root CA and tell the OS “but only ever use it for these and these domains”. That would solve this elegantly.</div><br/></div></div></div></div><div id="36677765" class="c"><input type="checkbox" id="c-36677765" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676108">parent</a><span>|</span><a href="#36676505">prev</a><span>|</span><a href="#36676140">next</a><span>|</span><label class="collapse" for="c-36677765">[-]</label><label class="expand" for="c-36677765">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Your private root CA can be maliciously used to MITM every domain on the Internet<p>I cannot see how.  Do you mean as a specific attack on a computer with the private Root CA installed, if the attacker gets their hands on the Root CA private key?</div><br/></div></div><div id="36676140" class="c"><input type="checkbox" id="c-36676140" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676108">parent</a><span>|</span><a href="#36677765">prev</a><span>|</span><a href="#36677547">next</a><span>|</span><label class="collapse" for="c-36676140">[-]</label><label class="expand" for="c-36676140">[4 more]</label></div><br/><div class="children"><div class="content">Your private root CA can only be used maliciously if it&#x27;s compromised. If you use certificate transparency to publicly leak all your local network administrative activities, then you won&#x27;t need to worry about someone compromising your network because you&#x27;ve already compromised yourself.</div><br/><div id="36676451" class="c"><input type="checkbox" id="c-36676451" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676140">parent</a><span>|</span><a href="#36676411">next</a><span>|</span><label class="collapse" for="c-36676451">[-]</label><label class="expand" for="c-36676451">[2 more]</label></div><br/><div class="children"><div class="content">Compromise of private CAs isn&#x27;t always difficult. People store unencrypted keys on SharePoint or send them in email along with the password. There&#x27;s also cases of rogue IT department staff using the private CA intended to be used for `*.corp` to MITM employee Internet traffic, so &quot;compromise&quot; isn&#x27;t needed for harm to occur. For companies that do it right, yeah, the concern is minimal.<p>I think the risk of leaking internal domain names is real, but overblown. If you find a vulnerable internal service via CT logs you still need to connect to the private network to exploit it. If you&#x27;re connected to the private network, you could have enumerated subdomains many other ways. Early knowledge of vulnerable subdomains can speed up an attack or target selection, but this is still a two step process. Most subdomains are pretty boring anyway; it&#x27;s not surprising to learn that $corp has subdomains like webmail, wiki, etc. These names don&#x27;t leak version or brand information.<p>I was playing with the idea of doing CT log poisoning, where you register and renew certificates for decoy subdomains along side your real subdomain names. If you add enough noise, CT logs are no longer useful for enumerating private subdomains.</div><br/><div id="36678103" class="c"><input type="checkbox" id="c-36678103" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676451">parent</a><span>|</span><a href="#36676411">next</a><span>|</span><label class="collapse" for="c-36678103">[-]</label><label class="expand" for="c-36678103">[1 more]</label></div><br/><div class="children"><div class="content">Sharepoint and email servers aren&#x27;t public. Transparency logs are. Small companies might not care if the public knows what they&#x27;re doing. In fact they&#x27;d probably benefit from the attention. However other companies are concerned, since leaks can fuel media rumors, harmful stock trades, or worse.</div><br/></div></div></div></div><div id="36676411" class="c"><input type="checkbox" id="c-36676411" checked=""/><div class="controls bullet"><span class="by">captn3m0</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676140">parent</a><span>|</span><a href="#36676451">prev</a><span>|</span><a href="#36677547">next</a><span>|</span><label class="collapse" for="c-36676411">[-]</label><label class="expand" for="c-36676411">[1 more]</label></div><br/><div class="children"><div class="content">The risk in both of theses is vastly different.<p>A root CA leak is hard to detect, has tremendous consequences, and adding limitations to the cert (TLD&#x2F;domain) don’t work across every OS.<p>OTOH, leaking the existence of your private services (which are likely inaccessible over the internet for the general attacker) is a much smaller risk, and can be contained with wildcard certs as a workaround.</div><br/></div></div></div></div></div></div><div id="36677547" class="c"><input type="checkbox" id="c-36677547" checked=""/><div class="controls bullet"><span class="by">KronisLV</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36676108">prev</a><span>|</span><a href="#36676365">next</a><span>|</span><label class="collapse" for="c-36677547">[-]</label><label class="expand" for="c-36677547">[2 more]</label></div><br/><div class="children"><div class="content">&gt; It is straightforward to create your own Root CA and use it to sign certificates for your private network, using openssl.<p>I guess I&#x27;ll be the one to say it: many people, myself included, get intimidated by using OpenSSL. The CLI has a bunch of different options and dealing with the inherent complexity of a PKI makes it all a bit of a mess: where you try to find the right invocations for whatever you need to do online and even then aren&#x27;t sure whether everything is done correctly.<p>At least that mirrors my own experience in the past and that of most folks I&#x27;ve talked to, both in private and prod projects. That&#x27;s why I personally find software like Keystore Explorer actually decent for even things like running your own CA (probably for a small homelab, where you don&#x27;t need automation): <a href="https:&#x2F;&#x2F;blog.kronis.dev&#x2F;tutorials&#x2F;lets-run-our-own-ca" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.kronis.dev&#x2F;tutorials&#x2F;lets-run-our-own-ca</a><p>And yet, even then I don&#x27;t have the confidence that I&#x27;ve done things the &quot;right&quot; way, frankly probably not. That&#x27;s even before you get into things like staying on top of CVEs and keeping everything updated - overall staying safe is very challenging. There&#x27;s probably also the need to configure a web server, like Apache with SSLCACertificateFile and just plenty of things to go wrong along the way, especially if you need mTLS as well.<p>&gt; Using this service means you really do not have a private network<p>That&#x27;s a fair point, though!</div><br/><div id="36677733" class="c"><input type="checkbox" id="c-36677733" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36677547">parent</a><span>|</span><a href="#36676365">next</a><span>|</span><label class="collapse" for="c-36677733">[-]</label><label class="expand" for="c-36677733">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  many people, myself included, get intimidated by using OpenSSL<p>Unsurprising.  It is intimidating.  I think a bit old fashioned in that sense.  Once was a time when men were men because they could configure sendmail.  All a bit silly really.<p>There are other alternatives.  Too few, tho.  It took me a week to work it all out using OpenSSL.</div><br/></div></div></div></div><div id="36676365" class="c"><input type="checkbox" id="c-36676365" checked=""/><div class="controls bullet"><span class="by">nine_k</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36677547">prev</a><span>|</span><a href="#36675913">next</a><span>|</span><label class="collapse" for="c-36676365">[-]</label><label class="expand" for="c-36676365">[2 more]</label></div><br/><div class="children"><div class="content">This sounds very much like the famous HN comment saying that Dropbox is unnecessary because you can construct an analog using rsync and half-dozen other tools.<p>It&#x27;s like saying that having a chair is unnecessary because you have a log, an axe, a saw, etc, and can build a sit to your liking when need be.<p>The thing is that when the need actually comes to be, you want a seat right now and of a known working kind, and strongly prefer a comfortable one. So thank the carpenter.</div><br/><div id="36677780" class="c"><input type="checkbox" id="c-36677780" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676365">parent</a><span>|</span><a href="#36675913">next</a><span>|</span><label class="collapse" for="c-36677780">[-]</label><label class="expand" for="c-36677780">[1 more]</label></div><br/><div class="children"><div class="content">The thing is when you build a private network you want it to be private.<p>The thing is when you are securing a network you are building things with powerful tools.<p>Thing is using powerful tools can backfire badly.</div><br/></div></div></div></div><div id="36675913" class="c"><input type="checkbox" id="c-36675913" checked=""/><div class="controls bullet"><span class="by">attentive</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36676365">prev</a><span>|</span><a href="#36676035">next</a><span>|</span><label class="collapse" for="c-36675913">[-]</label><label class="expand" for="c-36675913">[3 more]</label></div><br/><div class="children"><div class="content">What is often not straightforward is trusting this CA on every existing and future client.</div><br/><div id="36676110" class="c"><input type="checkbox" id="c-36676110" checked=""/><div class="controls bullet"><span class="by">throwanem</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36675913">parent</a><span>|</span><a href="#36676035">next</a><span>|</span><label class="collapse" for="c-36676110">[-]</label><label class="expand" for="c-36676110">[2 more]</label></div><br/><div class="children"><div class="content">Especially if it&#x27;s an iPhone.</div><br/><div id="36677790" class="c"><input type="checkbox" id="c-36677790" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676110">parent</a><span>|</span><a href="#36676035">next</a><span>|</span><label class="collapse" for="c-36677790">[-]</label><label class="expand" for="c-36677790">[1 more]</label></div><br/><div class="children"><div class="content">&gt;  Especially if it&#x27;s an iPhone.<p>That was my exact problem, an why I learnt this.<p>It is easy to install and easy to remove from an iOS device.</div><br/></div></div></div></div></div></div><div id="36676035" class="c"><input type="checkbox" id="c-36676035" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36675913">prev</a><span>|</span><a href="#36675225">next</a><span>|</span><label class="collapse" for="c-36676035">[-]</label><label class="expand" for="c-36676035">[2 more]</label></div><br/><div class="children"><div class="content">If you use the Redbean web server, I put a lot of thought into making local network SSL easy. <a href="https:&#x2F;&#x2F;redbean.dev&#x2F;#ssl" rel="nofollow noreferrer">https:&#x2F;&#x2F;redbean.dev&#x2F;#ssl</a> Basically all you have to  do is create a single key signing key which is installed on all your client devices. Then whenever you want to spin up a web server on any given host, you just give Redbean access to the key signing key, and it&#x27;ll create RSA&#x2F;ECDSA serving certificates automatically, which list all of the local system&#x27;s hostnames and network IPs in the correct manner (which is a nightmare to figure out how to get OpenSSL to do). In fact you can even embed the key-signing key inside your Redbean so that when you SCP it to another machine and run it via SSH, it&#x27;ll just do the right thing there as well, and Chrome won&#x27;t shut it down. Or you could email your redbean single-file executable to a coworker, who just has to double click on the thing, and it&#x27;ll start up a valid HTTPS server on their workstation which you can access, for easy local web dev collaborations.</div><br/><div id="36676201" class="c"><input type="checkbox" id="c-36676201" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36676035">parent</a><span>|</span><a href="#36675225">next</a><span>|</span><label class="collapse" for="c-36676201">[-]</label><label class="expand" for="c-36676201">[1 more]</label></div><br/><div class="children"><div class="content">Redbean may work well for a domain auto-registration idea I mentioned elsewhere [1]. I&#x27;ve been looking for an excuse to play with redbean.<p>[1] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36675925">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36675925</a></div><br/></div></div></div></div><div id="36675225" class="c"><input type="checkbox" id="c-36675225" checked=""/><div class="controls bullet"><span class="by">WirelessGigabit</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36676035">prev</a><span>|</span><a href="#36675348">next</a><span>|</span><label class="collapse" for="c-36675225">[-]</label><label class="expand" for="c-36675225">[3 more]</label></div><br/><div class="children"><div class="content">I love this idea. Except I have devices on my network that don&#x27;t allow me to do that. Company lock downs etc.<p>So I just pull in stuff from LetsEncrypt.</div><br/><div id="36675285" class="c"><input type="checkbox" id="c-36675285" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#36675167">root</a><span>|</span><a href="#36675225">parent</a><span>|</span><a href="#36675348">next</a><span>|</span><label class="collapse" for="c-36675285">[-]</label><label class="expand" for="c-36675285">[2 more]</label></div><br/><div class="children"><div class="content">As a rule I don&#x27;t connect to my local services from my company laptop—it sits in the guest network isolated from the rest of the network.</div><br/></div></div></div></div><div id="36675348" class="c"><input type="checkbox" id="c-36675348" checked=""/><div class="controls bullet"><span class="by">lolinder</span><span>|</span><a href="#36675167">parent</a><span>|</span><a href="#36675225">prev</a><span>|</span><a href="#36675067">next</a><span>|</span><label class="collapse" for="c-36675348">[-]</label><label class="expand" for="c-36675348">[1 more]</label></div><br/><div class="children"><div class="content">Caddy will do this for you as long as you don&#x27;t give it an ACME config. It handles the root CA creation as well as all of the certificates for any domains that you define in the Caddyfile, so all you have to do is find the root CA it generates and install it on your devices.</div><br/></div></div></div></div><div id="36675067" class="c"><input type="checkbox" id="c-36675067" checked=""/><div class="controls bullet"><span class="by">ncphil</span><span>|</span><a href="#36675167">prev</a><span>|</span><a href="#36674659">next</a><span>|</span><label class="collapse" for="c-36675067">[-]</label><label class="expand" for="c-36675067">[1 more]</label></div><br/><div class="children"><div class="content">Interesting idea, but I think I&#x27;ll stick with DNS challenge and LetsEncrypt. Lazy me really needs to finally sit down and automate the process (all the pieces are in place on my registrar&#x27;s side). Did the private CA thing for almost two decades, and yes, it was a PITA, but even that was mostly because I failed to invest the time to automate it (Linux and Windows devices aren&#x27;t _that_ hard to manage with OSS tools, printers might be a harder challenge; Android refusing to play nice with private DNS just makes it easier to disregard it altogether, as do all those IoT firmwares that don&#x27;t even pretend to give you a choice). Ultimately, the current infrastructure, like that for message encryption, is just too damn convoluted. Eventually it might get fixed, but I&#x27;ll probably be long retired to an Internet dead zone by then (raising goats can&#x27;t be harder than managing fleets of application servers, can it?).</div><br/></div></div><div id="36674659" class="c"><input type="checkbox" id="c-36674659" checked=""/><div class="controls bullet"><span class="by">frfl</span><span>|</span><a href="#36675067">prev</a><span>|</span><a href="#36675697">next</a><span>|</span><label class="collapse" for="c-36674659">[-]</label><label class="expand" for="c-36674659">[2 more]</label></div><br/><div class="children"><div class="content">Haven&#x27;t used this myself, but I did find out about Lego (<a href="https:&#x2F;&#x2F;github.com&#x2F;go-acme&#x2F;lego">https:&#x2F;&#x2F;github.com&#x2F;go-acme&#x2F;lego</a>) recently and used it to get a Let&#x27;s Encrypt cert for a local network website I have using the DNS challenge. It was fairly straight forward,<p><pre><code>  $ export NAMESILO_API_KEY=...
  $ export NAMESILO_POLLING_INTERVAL=10
  $ export NAMESILO_PROPAGATION_TIMEOUT=1800
  $ export NAMESILO_TTL=3600
  $ lego --email &lt;email&gt; --dns namesilo --domains *.&lt;domain&gt;.com run</code></pre></div><br/><div id="36674989" class="c"><input type="checkbox" id="c-36674989" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36674659">parent</a><span>|</span><a href="#36675697">next</a><span>|</span><label class="collapse" for="c-36674989">[-]</label><label class="expand" for="c-36674989">[1 more]</label></div><br/><div class="children"><div class="content">LEGO works great for this kind of thing. If you want to try with a localcert.net domain, the instructions are here:
<a href="https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;acme-clients&#x2F;lego&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;acme-clients&#x2F;lego&#x2F;</a></div><br/></div></div></div></div><div id="36675697" class="c"><input type="checkbox" id="c-36675697" checked=""/><div class="controls bullet"><span class="by">octagons</span><span>|</span><a href="#36674659">prev</a><span>|</span><a href="#36675603">next</a><span>|</span><label class="collapse" for="c-36675697">[-]</label><label class="expand" for="c-36675697">[1 more]</label></div><br/><div class="children"><div class="content">My preferred solution for this is a combination of Traefik and Smallstep StepCA. I run a collection of tools via Docker compose, and new certificates are issued automatically based on the hostname.<p>The only problem is that I have to maintain a list of DNS entries for the StepCA container as extra hosts. I haven’t found an elegant solution for this part.</div><br/></div></div><div id="36675603" class="c"><input type="checkbox" id="c-36675603" checked=""/><div class="controls bullet"><span class="by">gilad</span><span>|</span><a href="#36675697">prev</a><span>|</span><a href="#36677674">next</a><span>|</span><label class="collapse" for="c-36675603">[-]</label><label class="expand" for="c-36675603">[1 more]</label></div><br/><div class="children"><div class="content">MiniCA[0] works for this, quite trivial to setup and stamp out certs.<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;jsha&#x2F;minica">https:&#x2F;&#x2F;github.com&#x2F;jsha&#x2F;minica</a></div><br/></div></div><div id="36677674" class="c"><input type="checkbox" id="c-36677674" checked=""/><div class="controls bullet"><span class="by">mgaunard</span><span>|</span><a href="#36675603">prev</a><span>|</span><a href="#36674711">next</a><span>|</span><label class="collapse" for="c-36677674">[-]</label><label class="expand" for="c-36677674">[4 more]</label></div><br/><div class="children"><div class="content">The web&#x2F;cloud world is so much nonsense. First, why do you even need HTTPS on a trusted network. Also if you want a trusted network, why not just use IPSec? HTTPS was specifically built to work over the Internet because it was too hard to switch from IPv4.<p>Second, if it&#x27;s private, surely you can just use your own Certificate Authority, instead of paying a tax to be listed on someone else&#x27;s Certificate Authority.</div><br/><div id="36677907" class="c"><input type="checkbox" id="c-36677907" checked=""/><div class="controls bullet"><span class="by">wolletd</span><span>|</span><a href="#36677674">parent</a><span>|</span><a href="#36677760">next</a><span>|</span><label class="collapse" for="c-36677907">[-]</label><label class="expand" for="c-36677907">[1 more]</label></div><br/><div class="children"><div class="content">Well, because my local instance of &lt;WebApp&gt; says, &lt;Feature&gt; isn&#x27;t available unless I use HTTPS.<p>Also, HTTPS with a public CA just works on most systems, whereas IPsec requires Client configuration. It&#x27;s still easier to roll out than switching from IPv4.<p>For personal or experimental things, I may use a local CA, but getting certificates for the internal subdomains of my company is trivial when you already got a public domain on a Server that&#x27;s capable of using DNS-01 challenges.<p>Enabling HTTPS is just way easier than <i>actually</i> ensuring you can trust your local network. Many real-life middle-class companies start out with just having a network and not thinking about security at all. Some companies may even have untrusted internal networks by choice by allowing BYOD.</div><br/></div></div><div id="36677760" class="c"><input type="checkbox" id="c-36677760" checked=""/><div class="controls bullet"><span class="by">pravus</span><span>|</span><a href="#36677674">parent</a><span>|</span><a href="#36677907">prev</a><span>|</span><a href="#36677778">next</a><span>|</span><label class="collapse" for="c-36677760">[-]</label><label class="expand" for="c-36677760">[1 more]</label></div><br/><div class="children"><div class="content">&gt; First, why do you even need HTTPS on a trusted network.<p>PCI compliance among many other regulatory issues.  You will be required to show that data is not only encrypted at rest but is encrypted through your entire transport chain regardless of any physical security.  The threat model assumes that an attacker is able to temporarily access network resources undetected and can use simple sniffing tools to egress sensitive data.  This will not be optional.</div><br/></div></div><div id="36677778" class="c"><input type="checkbox" id="c-36677778" checked=""/><div class="controls bullet"><span class="by">dvdkon</span><span>|</span><a href="#36677674">parent</a><span>|</span><a href="#36677760">prev</a><span>|</span><a href="#36674711">next</a><span>|</span><label class="collapse" for="c-36677778">[-]</label><label class="expand" for="c-36677778">[1 more]</label></div><br/><div class="children"><div class="content">Trusted networks are a flawed concept, unless you mean a software-backed tunnel. And I&#x27;m glad the slightly-less-mad TLS won over IPSEC with some certificate extension.</div><br/></div></div></div></div><div id="36674711" class="c"><input type="checkbox" id="c-36674711" checked=""/><div class="controls bullet"><span class="by">urda</span><span>|</span><a href="#36677674">prev</a><span>|</span><a href="#36677377">next</a><span>|</span><label class="collapse" for="c-36674711">[-]</label><label class="expand" for="c-36674711">[12 more]</label></div><br/><div class="children"><div class="content">I recommend just using something like XCA [1]. Just configure your own root CA and distribute it.<p>[1] <a href="https:&#x2F;&#x2F;hohnstaedt.de&#x2F;xca&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;hohnstaedt.de&#x2F;xca&#x2F;</a></div><br/><div id="36674813" class="c"><input type="checkbox" id="c-36674813" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36674711">parent</a><span>|</span><a href="#36674938">next</a><span>|</span><label class="collapse" for="c-36674813">[-]</label><label class="expand" for="c-36674813">[1 more]</label></div><br/><div class="children"><div class="content">Part of the reason I&#x27;ve been working on this is that the &quot;distribute&quot; step is quite difficult to do at scale across an ever changing set of operating systems and devices. Using a free public CA like Let&#x27;s Encrypt let&#x27;s you avoid that challenge since it&#x27;s trusted out of the box everywhere.</div><br/></div></div><div id="36674938" class="c"><input type="checkbox" id="c-36674938" checked=""/><div class="controls bullet"><span class="by">bryancoxwell</span><span>|</span><a href="#36674711">parent</a><span>|</span><a href="#36674813">prev</a><span>|</span><a href="#36674868">next</a><span>|</span><label class="collapse" for="c-36674938">[-]</label><label class="expand" for="c-36674938">[1 more]</label></div><br/><div class="children"><div class="content">“And distribute it” feels very “draw the rest of the fucking owl”-y to me</div><br/></div></div><div id="36674868" class="c"><input type="checkbox" id="c-36674868" checked=""/><div class="controls bullet"><span class="by">abound</span><span>|</span><a href="#36674711">parent</a><span>|</span><a href="#36674938">prev</a><span>|</span><a href="#36677377">next</a><span>|</span><label class="collapse" for="c-36674868">[-]</label><label class="expand" for="c-36674868">[9 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t that require being able to add your root CA on each device you access the application from? That can be a chore in some cases, esp when you want to share the application with others.<p>For services I host on my Tailscale&#x2F;Headscale network, I just use DNS challenges. With Cloudflare and Caddy, it&#x27;s as straightforward as adding:<p>tls {
  dns cloudflare {env.CLOUDFLARE_AUTH_TOKEN}
 }<p>to the site&#x27;s configuration in the Caddyfile</div><br/><div id="36675111" class="c"><input type="checkbox" id="c-36675111" checked=""/><div class="controls bullet"><span class="by">housemusicfan</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36674868">parent</a><span>|</span><a href="#36674947">next</a><span>|</span><label class="collapse" for="c-36675111">[-]</label><label class="expand" for="c-36675111">[6 more]</label></div><br/><div class="children"><div class="content">This is a poor solution to a non-problem. 99% of &quot;private networks&quot; don&#x27;t need HTTPS for most things, full-stop. Those that do, the correct solution is to deploy a private CA and use internal DNS. The implication being you do not trust your network. So the solution is to.....use public DNS and Let&#x27;s Encrypt garbageware and leak details of your internal network so you can pretend you&#x27;re now more secure because the cafeteria menu is hosted over HTTPS? Save the black hats some time and just email them the Visio of your core network.<p>If you don&#x27;t have access to install the root certificate then by definition you don&#x27;t control the private network, simple as that.<p>&gt; when you want to share the application with others<p>This is literally the definition of no longer a &quot;private network&quot;.</div><br/><div id="36675210" class="c"><input type="checkbox" id="c-36675210" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36675111">parent</a><span>|</span><a href="#36676043">next</a><span>|</span><label class="collapse" for="c-36675210">[-]</label><label class="expand" for="c-36675210">[1 more]</label></div><br/><div class="children"><div class="content">&gt; 99% of &quot;private networks&quot; don&#x27;t need HTTPS for most things, full-stop.<p>The encryption HTTPS provides isn&#x27;t important if you trust your network. However server authentication is important if your devices move between networks (phone, laptop, etc). Applications don&#x27;t know you switched networks, they just want to connect and will happily send sensitive data to an attacker if you ever connect to a malicious network. There was an example of `git push` leaking the entire commit history mentioned on HN not too long ago.</div><br/></div></div><div id="36676043" class="c"><input type="checkbox" id="c-36676043" checked=""/><div class="controls bullet"><span class="by">soraminazuki</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36675111">parent</a><span>|</span><a href="#36675210">prev</a><span>|</span><a href="#36676853">next</a><span>|</span><label class="collapse" for="c-36676043">[-]</label><label class="expand" for="c-36676043">[1 more]</label></div><br/><div class="children"><div class="content">&gt; This is a poor solution to a non-problem. 99% of &quot;private networks&quot; don&#x27;t need HTTPS for most things, full-stop.<p>The problem with your security model is that you assume your private network is flawless. Do you really think you can trust every device that connects to your network to be secure? Including your Wi-Fi router? Because I don&#x27;t, even for devices I personally bought. Even less so in a corporate setting.</div><br/></div></div><div id="36676853" class="c"><input type="checkbox" id="c-36676853" checked=""/><div class="controls bullet"><span class="by">fulafel</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36675111">parent</a><span>|</span><a href="#36676043">prev</a><span>|</span><a href="#36675907">next</a><span>|</span><label class="collapse" for="c-36676853">[-]</label><label class="expand" for="c-36676853">[1 more]</label></div><br/><div class="children"><div class="content">This is rescurrecting the mythical &quot;secure internal network&quot;. It&#x27;s been tried, a lot, and found wanting.</div><br/></div></div><div id="36675907" class="c"><input type="checkbox" id="c-36675907" checked=""/><div class="controls bullet"><span class="by">smarkov</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36675111">parent</a><span>|</span><a href="#36676853">prev</a><span>|</span><a href="#36676228">next</a><span>|</span><label class="collapse" for="c-36675907">[-]</label><label class="expand" for="c-36675907">[1 more]</label></div><br/><div class="children"><div class="content">&gt; use public DNS and Let&#x27;s Encrypt garbageware and leak details of your internal network<p>Wildcard letsencrypt + internal DNS means you don&#x27;t leak anything and you don&#x27;t have to deal with the awkwardness of installing certificates.</div><br/></div></div><div id="36676228" class="c"><input type="checkbox" id="c-36676228" checked=""/><div class="controls bullet"><span class="by">jart</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36675111">parent</a><span>|</span><a href="#36675907">prev</a><span>|</span><a href="#36674947">next</a><span>|</span><label class="collapse" for="c-36676228">[-]</label><label class="expand" for="c-36676228">[1 more]</label></div><br/><div class="children"><div class="content">&gt; use public DNS and Let&#x27;s Encrypt garbageware and leak details of your internal network<p>I&#x27;ve seen certbot take 1+ hour to install on GCE micro VMs because it&#x27;s so bloated. I&#x27;ve tried implementing the ACME protocol to avoid needing to use it, but it&#x27;s one of the most byzantine processes I&#x27;ve seen. Let&#x27;s Encrypt takes so much leverage from the edge to give us something that costs a latte. It&#x27;s how freedom dies.</div><br/></div></div></div></div><div id="36674947" class="c"><input type="checkbox" id="c-36674947" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36674868">parent</a><span>|</span><a href="#36675111">prev</a><span>|</span><a href="#36675193">next</a><span>|</span><label class="collapse" for="c-36674947">[-]</label><label class="expand" for="c-36674947">[1 more]</label></div><br/><div class="children"><div class="content">&lt;3 Caddy. Here&#x27;s my equivalent:
<a href="https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;acme-clients&#x2F;caddy&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;docs.getlocalcert.net&#x2F;acme-clients&#x2F;caddy&#x2F;</a></div><br/></div></div><div id="36675193" class="c"><input type="checkbox" id="c-36675193" checked=""/><div class="controls bullet"><span class="by">worik</span><span>|</span><a href="#36674711">root</a><span>|</span><a href="#36674868">parent</a><span>|</span><a href="#36674947">prev</a><span>|</span><a href="#36677377">next</a><span>|</span><label class="collapse" for="c-36675193">[-]</label><label class="expand" for="c-36675193">[1 more]</label></div><br/><div class="children"><div class="content">Yes you need to install the Root CA into each device&#x27;s root of trust.<p>Inconvenient?  Maybe.  Security rubs against the grain of convenience, true</div><br/></div></div></div></div></div></div><div id="36677377" class="c"><input type="checkbox" id="c-36677377" checked=""/><div class="controls bullet"><span class="by">mvip</span><span>|</span><a href="#36674711">prev</a><span>|</span><a href="#36676421">next</a><span>|</span><label class="collapse" for="c-36677377">[-]</label><label class="expand" for="c-36677377">[1 more]</label></div><br/><div class="children"><div class="content">Another approach to solving this problem is to use Tailscale and their new SSL feature [1]. This of course is dependent on that you use Tailscale, but it is pretty handy and does give you a Let&#x27;s Encrypt cert.<p>[1] <a href="https:&#x2F;&#x2F;blog.viktorpetersson.com&#x2F;2022&#x2F;12&#x2F;23&#x2F;securing-services-with-tailscale.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.viktorpetersson.com&#x2F;2022&#x2F;12&#x2F;23&#x2F;securing-service...</a></div><br/></div></div><div id="36676421" class="c"><input type="checkbox" id="c-36676421" checked=""/><div class="controls bullet"><span class="by">denkmoon</span><span>|</span><a href="#36677377">prev</a><span>|</span><a href="#36674633">next</a><span>|</span><label class="collapse" for="c-36676421">[-]</label><label class="expand" for="c-36676421">[1 more]</label></div><br/><div class="children"><div class="content">step-ca is an excellent for running your own private CA with ACME support. Individual software support for defining your own acme directory isn&#x27;t always there, but such is the life of running your a private PKI. Worst case, you manually issue a cert like you would have done anyway.</div><br/></div></div><div id="36674653" class="c"><input type="checkbox" id="c-36674653" checked=""/><div class="controls bullet"><span class="by">jareklupinski</span><span>|</span><a href="#36674633">prev</a><span>|</span><a href="#36675554">next</a><span>|</span><label class="collapse" for="c-36674653">[-]</label><label class="expand" for="c-36674653">[1 more]</label></div><br/><div class="children"><div class="content">interesting, wonder if this will help me get access to the Geolocation API for my ESP32 captive portal devices<p>on connect, a user is presented with an option to preselect a wifi network and input their geographic location. I managed to stuff a zip code lookup table into the code, but lat&#x2F;long is really cumbersome to input, and using the phone&#x27;s location sensor requires an HTTPS server</div><br/></div></div><div id="36675554" class="c"><input type="checkbox" id="c-36675554" checked=""/><div class="controls bullet"><span class="by">tandav</span><span>|</span><a href="#36674653">prev</a><span>|</span><a href="#36674867">next</a><span>|</span><label class="collapse" for="c-36675554">[-]</label><label class="expand" for="c-36675554">[5 more]</label></div><br/><div class="children"><div class="content">Side question: Does anyone know a simple caddy-like solution, but for non-HTTP traffic? For example, I want automatic SSL certificates for redis, mongodb, postgresql.</div><br/><div id="36676960" class="c"><input type="checkbox" id="c-36676960" checked=""/><div class="controls bullet"><span class="by">avtar</span><span>|</span><a href="#36675554">parent</a><span>|</span><a href="#36675824">next</a><span>|</span><label class="collapse" for="c-36676960">[-]</label><label class="expand" for="c-36676960">[1 more]</label></div><br/><div class="children"><div class="content">stunnel should work for all of the above</div><br/></div></div><div id="36675824" class="c"><input type="checkbox" id="c-36675824" checked=""/><div class="controls bullet"><span class="by">mthoms</span><span>|</span><a href="#36675554">parent</a><span>|</span><a href="#36676960">prev</a><span>|</span><a href="#36674867">next</a><span>|</span><label class="collapse" for="c-36675824">[-]</label><label class="expand" for="c-36675824">[3 more]</label></div><br/><div class="children"><div class="content">Caddy can act as a proxy for those services. It&#x27;s ridiculously easy to set-up.<p><pre><code>  mongo.mydomain.com {
    reverse_proxy 127.0.0.1:27017
  }</code></pre></div><br/><div id="36675989" class="c"><input type="checkbox" id="c-36675989" checked=""/><div class="controls bullet"><span class="by">selcuka</span><span>|</span><a href="#36675554">root</a><span>|</span><a href="#36675824">parent</a><span>|</span><a href="#36674867">next</a><span>|</span><label class="collapse" for="c-36675989">[-]</label><label class="expand" for="c-36675989">[2 more]</label></div><br/><div class="children"><div class="content">&gt; but for non-HTTP traffic?<p>Doesn&#x27;t this only work for HTTP too? It may work with MongoDB because it talks HTTP through TCP 27017, but PostgreSQL, for example, has a proprietary protocol on TCP 5432.</div><br/><div id="36676513" class="c"><input type="checkbox" id="c-36676513" checked=""/><div class="controls bullet"><span class="by">8organicbits</span><span>|</span><a href="#36675554">root</a><span>|</span><a href="#36675989">parent</a><span>|</span><a href="#36674867">next</a><span>|</span><label class="collapse" for="c-36676513">[-]</label><label class="expand" for="c-36676513">[1 more]</label></div><br/><div class="children"><div class="content">I think you need the layer4 module to get this working.<p><a href="https:&#x2F;&#x2F;caddyserver.com&#x2F;docs&#x2F;modules&#x2F;layer4" rel="nofollow noreferrer">https:&#x2F;&#x2F;caddyserver.com&#x2F;docs&#x2F;modules&#x2F;layer4</a></div><br/></div></div></div></div></div></div></div></div><div id="36674867" class="c"><input type="checkbox" id="c-36674867" checked=""/><div class="controls bullet"><span class="by">andrewmcwatters</span><span>|</span><a href="#36675554">prev</a><span>|</span><a href="#36675571">next</a><span>|</span><label class="collapse" for="c-36674867">[-]</label><label class="expand" for="c-36674867">[1 more]</label></div><br/><div class="children"><div class="content">If you absolutely need a hostname that is not &quot;localhost&quot; you should still configure your own host record and use a utility like mkcert.[1]<p>Most of the time, you really shouldn&#x27;t need this, and your local HTTPS development should just require:<p><pre><code>    mkcert -install
    mkcert localhost
</code></pre>
In the directory of your app, etc.<p>If you&#x27;re deploying private applications, these records should exist in your intranet DNS resolver instead.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;FiloSottile&#x2F;mkcert">https:&#x2F;&#x2F;github.com&#x2F;FiloSottile&#x2F;mkcert</a></div><br/></div></div></div></div></div></div></div></body></html>