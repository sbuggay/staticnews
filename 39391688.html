<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1708160453223" as="style"/><link rel="stylesheet" href="styles.css?v=1708160453223"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://opensource.googleblog.com/2024/02/magika-ai-powered-fast-and-efficient-file-type-identification.html">Magika: AI powered fast and efficient file type identification</a> <span class="domain">(<a href="https://opensource.googleblog.com">opensource.googleblog.com</a>)</span></div><div class="subtext"><span>alphabetting</span> | <span>179 comments</span></div><br/><div><div id="39396706" class="c"><input type="checkbox" id="c-39396706" checked=""/><div class="controls bullet"><span class="by">TomNomNom</span><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39396706">[-]</label><label class="expand" for="c-39396706">[41 more]</label></div><br/><div class="children"><div class="content">This looks cool. I ran this on some web crawl data I have locally, so: all files you&#x27;d find on regular websites; HTML, CSS, JavaScript, fonts etc.<p>It identified some simple HTML files (html, head, title, body, p tags and not much else) as &quot;MS Visual Basic source (VBA)&quot;, &quot;ASP source (code)&quot;, and &quot;Generic text document&quot; where the `file` utility correctly identified all such examples as &quot;HTML document text&quot;.<p>Some woff and woff2 files it identified as &quot;TrueType Font Data&quot;, others are &quot;Unknown binary data (unknown)&quot; with low confidence guesses ranging from FLAC audio to ISO 9660. Again, the `file` utility correctly identifies these files as &quot;Web Open Font Format&quot;.<p>I like the idea, but the current implementation can&#x27;t be relied on IMO; especially not for automation.<p>A minor pet peeve also: it doesn&#x27;t seem to detect when its output is a pipe and strip the shell colour escapes resulting in `^[[1;37` and `^[[0;39m` wrapping every line if you pipe the output into a vim buffer or similar.</div><br/><div id="39397163" class="c"><input type="checkbox" id="c-39397163" checked=""/><div class="controls bullet"><span class="by">ebursztein</span><span>|</span><a href="#39396706">parent</a><span>|</span><a href="#39396943">next</a><span>|</span><label class="collapse" for="c-39397163">[-]</label><label class="expand" for="c-39397163">[23 more]</label></div><br/><div class="children"><div class="content">Thanks for the feedback -- we will look into it. If you can share with us the list of URL that would be very helpful so we can reproduce - send us an email at magika-dev@google.com if that is possible.<p>For crawling we have planned a head only model to avoid fetching the whole file but it is not ready yet -- we weren&#x27;t sure what use-cases would emerge so that is good to know that such model might be useful.<p>We mostly use Magika internally to route files for AV scanning as we wrote in the blog post, so it is possible that despite our best effort to test Magika extensively on various file types it is not as good on fonts format as it should be. We will look into.<p>Thanks again for sharing your experience with Magika this is very useful.</div><br/><div id="39397354" class="c"><input type="checkbox" id="c-39397354" checked=""/><div class="controls bullet"><span class="by">TomNomNom</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397163">parent</a><span>|</span><a href="#39400042">next</a><span>|</span><label class="collapse" for="c-39397354">[-]</label><label class="expand" for="c-39397354">[20 more]</label></div><br/><div class="children"><div class="content">Sure thing :)<p>Here&#x27;s[0] a .tgz file with 3 files in it that are misidentified by magika but correctly identified by the `file` utility: asp.html, vba.html, unknown.woff<p>These are files that were in one of my crawl datasets.<p>[0]: <a href="https:&#x2F;&#x2F;poc.lol&#x2F;files&#x2F;magika-test.tgz" rel="nofollow">https:&#x2F;&#x2F;poc.lol&#x2F;files&#x2F;magika-test.tgz</a></div><br/><div id="39397418" class="c"><input type="checkbox" id="c-39397418" checked=""/><div class="controls bullet"><span class="by">ebursztein</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397354">parent</a><span>|</span><a href="#39398428">next</a><span>|</span><label class="collapse" for="c-39397418">[-]</label><label class="expand" for="c-39397418">[2 more]</label></div><br/><div class="children"><div class="content">Thank you - we are adding them to our test suit for the next version.</div><br/><div id="39397531" class="c"><input type="checkbox" id="c-39397531" checked=""/><div class="controls bullet"><span class="by">TomNomNom</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397418">parent</a><span>|</span><a href="#39398428">next</a><span>|</span><label class="collapse" for="c-39397531">[-]</label><label class="expand" for="c-39397531">[1 more]</label></div><br/><div class="children"><div class="content">Super, thank you! I look forward to it :)<p>I&#x27;ve worked on similar problems recently so I&#x27;m well aware of how difficult this is. An example I&#x27;ve given people is in automatically detecting base64-encoded data. It <i>seems</i> easy at first, but any four, eight, or twelve (etc) letter word is technically valid base64, so you need to decide if and how those things should be excluded.</div><br/></div></div></div></div><div id="39398428" class="c"><input type="checkbox" id="c-39398428" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397354">parent</a><span>|</span><a href="#39397418">prev</a><span>|</span><a href="#39400042">next</a><span>|</span><label class="collapse" for="c-39398428">[-]</label><label class="expand" for="c-39398428">[17 more]</label></div><br/><div class="children"><div class="content">Do you have permission to redistribute these files?</div><br/><div id="39401203" class="c"><input type="checkbox" id="c-39401203" checked=""/><div class="controls bullet"><span class="by">IvyMike</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39398428">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39401203">[-]</label><label class="expand" for="c-39401203">[15 more]</label></div><br/><div class="children"><div class="content">You are asking what if this guy has &quot;web crawl data&quot; that google does not have?<p>And what if he says no, he does not have permission.</div><br/><div id="39401717" class="c"><input type="checkbox" id="c-39401717" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39401203">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39401717">[-]</label><label class="expand" for="c-39401717">[14 more]</label></div><br/><div class="children"><div class="content">&gt; You are asking what if this guy has &quot;web crawl data&quot; that google does not have?<p>No, I&#x27;m asking if he has permission to redistribute these files.</div><br/><div id="39402690" class="c"><input type="checkbox" id="c-39402690" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39401717">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39402690">[-]</label><label class="expand" for="c-39402690">[13 more]</label></div><br/><div class="children"><div class="content">Are you attempting to assert that use of these files solely for the purpose of improving a software system meant to classify file types does not fall under fair use?<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Fair_use" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Fair_use</a></div><br/><div id="39402722" class="c"><input type="checkbox" id="c-39402722" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402690">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39402722">[-]</label><label class="expand" for="c-39402722">[12 more]</label></div><br/><div class="children"><div class="content">I&#x27;m asking a question.<p>Here&#x27;s another one for you: Do you believe that all pictures you have ever taken, all emails you have ever written, all code you have ever written could be posted here on this forum to improve someone else&#x27;s software system?<p>If so, could you go ahead and post that zip? I&#x27;d like to ingest it in my model.</div><br/><div id="39402761" class="c"><input type="checkbox" id="c-39402761" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402722">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39402761">[-]</label><label class="expand" for="c-39402761">[7 more]</label></div><br/><div class="children"><div class="content">Your question seems orthogonal to the situation.  The three files posted seem to be the minimum amount of information required to reproduce the bug.  Fair use encompasses a LOT of uses of otherwise copyrighted work, and this seems clearly to be one.</div><br/><div id="39402831" class="c"><input type="checkbox" id="c-39402831" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402761">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39402831">[-]</label><label class="expand" for="c-39402831">[6 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t see how publicly posting them on a forum is<p>&gt; the minimum amount of information required to reproduce the bug<p>MAYBE if they had communicated privately that&#x27;d be an argument that made sense.</div><br/><div id="39402855" class="c"><input type="checkbox" id="c-39402855" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402831">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39402855">[-]</label><label class="expand" for="c-39402855">[5 more]</label></div><br/><div class="children"><div class="content">So you don&#x27;t think that software development which happens in public web forums deserve fair use protection?</div><br/><div id="39403088" class="c"><input type="checkbox" id="c-39403088" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402855">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39403088">[-]</label><label class="expand" for="c-39403088">[4 more]</label></div><br/><div class="children"><div class="content">That&#x27;s an interesting way to frame &quot;publicly posted someone else&#x27;s data without their consent for anyone to see and download&quot;</div><br/><div id="39403127" class="c"><input type="checkbox" id="c-39403127" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39403088">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39403127">[-]</label><label class="expand" for="c-39403127">[3 more]</label></div><br/><div class="children"><div class="content">I notice you&#x27;re so invested that you haven&#x27;t noticed that the files have been renamed and zipped such that they&#x27;re not even indexable.  How you&#x27;d expect anyone not participating in software development to find them is yet to be explained.</div><br/><div id="39403661" class="c"><input type="checkbox" id="c-39403661" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39403127">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39403661">[-]</label><label class="expand" for="c-39403661">[2 more]</label></div><br/><div class="children"><div class="content">I notice you&#x27;re so invested you keep coming up with imaginary scenarios that you pretend somehow matter, lol</div><br/><div id="39403790" class="c"><input type="checkbox" id="c-39403790" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39403661">parent</a><span>|</span><a href="#39403546">next</a><span>|</span><label class="collapse" for="c-39403790">[-]</label><label class="expand" for="c-39403790">[1 more]</label></div><br/><div class="children"><div class="content">Have fun, buddy!</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39403546" class="c"><input type="checkbox" id="c-39403546" checked=""/><div class="controls bullet"><span class="by">jdiff</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402722">parent</a><span>|</span><a href="#39402761">prev</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39403546">[-]</label><label class="expand" for="c-39403546">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s three files that were scraped from (and so publicly available on) the web. That&#x27;s not at all similar to your strawful analogy.</div><br/><div id="39403619" class="c"><input type="checkbox" id="c-39403619" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39403546">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39403619">[-]</label><label class="expand" for="c-39403619">[3 more]</label></div><br/><div class="children"><div class="content">I&#x27;m over here trying to fathom the lack of control over one&#x27;s own life it would take to cause someone to turn into an online copyright cop, when the data in question isn&#x27;t even their own, is clearly divorced from any context which would make it useful for anything other than fixing the bug, and about which the original copyright holder hasn&#x27;t complained.<p>Some people just want to argue.<p>If the copyright holder has a problem with the use, they are perfectly entitled to spend some of their dollar bills to file a law suit, as part of which the contents of the files can be entered into the public record for all to legally access, as was done with Scientology.<p>I don&#x27;t expect anyone would be so daft.</div><br/><div id="39403653" class="c"><input type="checkbox" id="c-39403653" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39403619">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39403653">[-]</label><label class="expand" for="c-39403653">[2 more]</label></div><br/><div class="children"><div class="content">Literally just asked a question and that seems to have set you off, bud. Are you alright? Do you need to feed your LLM more data to keep it happy?</div><br/><div id="39403754" class="c"><input type="checkbox" id="c-39403754" checked=""/><div class="controls bullet"><span class="by">timschmidt</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39403653">parent</a><span>|</span><a href="#39404714">next</a><span>|</span><label class="collapse" for="c-39403754">[-]</label><label class="expand" for="c-39403754">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m always happy to stand up for folks who make things over people who want to police them.  Especially when nothing wrong has happened.  Maybe take a walk and get some fresh air?</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39404714" class="c"><input type="checkbox" id="c-39404714" checked=""/><div class="controls bullet"><span class="by">renewiltord</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39398428">parent</a><span>|</span><a href="#39401203">prev</a><span>|</span><a href="#39400042">next</a><span>|</span><label class="collapse" for="c-39404714">[-]</label><label class="expand" for="c-39404714">[1 more]</label></div><br/><div class="children"><div class="content">LOL nice b8 m8. For the rest of you who are curious, the files look like this:<p><pre><code>    &lt;HTML&gt;&lt;HEAD&gt;
    &lt;TITLE&gt;Access Denied&lt;&#x2F;TITLE&gt;
    &lt;&#x2F;HEAD&gt;&lt;BODY&gt;
    &lt;H1&gt;Access Denied&lt;&#x2F;H1&gt;
     
    You don&#x27;t have permission to access &quot;http&amp;#58;&amp;#47;&amp;#47;placement&amp;#46;api&amp;#46;test4&amp;#46;example&amp;#46;com&amp;#47;&quot; on this server.&lt;P&gt;
    Reference&amp;#32;&amp;#35;18&amp;#46;9cb0f748&amp;#46;1695037739&amp;#46;283e2e00
    &lt;&#x2F;BODY&gt;
    &lt;&#x2F;HTML&gt;
</code></pre>
Legend. &quot;Do you have permission&quot; hahaha.</div><br/></div></div></div></div></div></div><div id="39400042" class="c"><input type="checkbox" id="c-39400042" checked=""/><div class="controls bullet"><span class="by">westurner</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397163">parent</a><span>|</span><a href="#39397354">prev</a><span>|</span><a href="#39398353">next</a><span>|</span><label class="collapse" for="c-39400042">[-]</label><label class="expand" for="c-39400042">[1 more]</label></div><br/><div class="children"><div class="content">What is the MIME type of a .tar file; and what are the MIME types of the constituent concatenated files within an archive format like e.g. tar?<p>hachoir&#x2F;subfile&#x2F;main.py: 
<a href="https:&#x2F;&#x2F;github.com&#x2F;vstinner&#x2F;hachoir&#x2F;blob&#x2F;main&#x2F;hachoir&#x2F;subfile&#x2F;main.py">https:&#x2F;&#x2F;github.com&#x2F;vstinner&#x2F;hachoir&#x2F;blob&#x2F;main&#x2F;hachoir&#x2F;subfil...</a><p>File signature: 
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;File_signature" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;File_signature</a><p>PhotoRec: 
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;PhotoRec" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;PhotoRec</a><p>&quot;File Format Gallery for Kaitai Struct&quot;; 185+ binary file format specifications: 
<a href="https:&#x2F;&#x2F;formats.kaitai.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;formats.kaitai.io&#x2F;</a><p>Table of &#x27;: 
<a href="https:&#x2F;&#x2F;formats.kaitai.io&#x2F;xref.html" rel="nofollow">https:&#x2F;&#x2F;formats.kaitai.io&#x2F;xref.html</a><p>AntiVirus software &gt; 
Identification methods &gt; Signature-based detection, Heuristics, and <i>ML&#x2F;AI data mining</i>: 
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Antivirus_software#Identification_methods" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Antivirus_software#Identificat...</a><p>Executable compression; packer&#x2F;loader: 
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Executable_compression" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Executable_compression</a><p>Shellcode database &gt; MSF: 
<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Shellcode_database" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Shellcode_database</a><p>sigtool.c: 
<a href="https:&#x2F;&#x2F;github.com&#x2F;Cisco-Talos&#x2F;clamav&#x2F;blob&#x2F;main&#x2F;sigtool&#x2F;sigtool.c">https:&#x2F;&#x2F;github.com&#x2F;Cisco-Talos&#x2F;clamav&#x2F;blob&#x2F;main&#x2F;sigtool&#x2F;sigt...</a><p>clamav sigtool: <a href="https:&#x2F;&#x2F;www.google.com&#x2F;search?q=clamav+sigtool" rel="nofollow">https:&#x2F;&#x2F;www.google.com&#x2F;search?q=clamav+sigtool</a><p><a href="https:&#x2F;&#x2F;blog.didierstevens.com&#x2F;2017&#x2F;07&#x2F;14&#x2F;clamav-sigtool-decode-sigs&#x2F;" rel="nofollow">https:&#x2F;&#x2F;blog.didierstevens.com&#x2F;2017&#x2F;07&#x2F;14&#x2F;clamav-sigtool-dec...</a> :<p><pre><code>  sigtool –-find-sigs &quot;$name&quot; | sigtool –-decode-sigs 
</code></pre>
List of file signatures: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;List_of_file_signatures" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;List_of_file_signatures</a><p>And then also clusterfuzz&#x2F;oss-fuzz scans .txt source files with (sandboxed) Static and Dynamic Analysis tools, and `debsums`&#x2F;`rpm -Va` verify that files on disk have the same (GPG signed) checksums as the package they are supposed to have been installed from, and a file-based HIDS builds a database of file hashes and compares what&#x27;s on disk in a later scan with what was presumed good, and ~gdesktop LLM tools scan every file, 
 and there are extended filesystem attributes for <i>label</i>-based MAC systems like SELinux, oh and NTFS ADS.<p>A sufficient cryptographic hash function yields random bits with uniform probability. 
DRBG Deterministic Random Bit Generators need high entropy random bits in order to continuously re-seed the RNG random number generator.
Is it safe to assume that hashing (1) every file on disk, or (2) any given file on disk at random, will yield random bits with uniform probability; and (3) why Argon2 instead of e.g. only two rounds of SHA256?<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;osv.dev&#x2F;blob&#x2F;master&#x2F;README.md#using-the-scanner">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;osv.dev&#x2F;blob&#x2F;master&#x2F;README.md#usin...</a> :<p>&gt; <i>We provide a Go based tool that will scan your dependencies, and check them against the OSV database for known vulnerabilities via the OSV API.</i> ... With package metadata, not (a file hash, package) database that could be generated from OSV and the actual package files instead of their manifest of already-calculated checksums.<p>Might as well be heating a pool on the roof with all of this waste heat from hashing binaries build from code of unknown static and dynamic quality.<p>Add&#x27;l useful formats:<p>&gt; <i>Currently it is able to scan various lockfiles, debian docker containers, SPDX and CycloneDB SBOMs, and git repositories</i><p>Things like bittorrent magnet URIs, Named Data Networking, and IPFS are (file-hash based) &quot;Content addressable storage&quot;: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Content-addressable_storage" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Content-addressable_storage</a></div><br/></div></div></div></div><div id="39396943" class="c"><input type="checkbox" id="c-39396943" checked=""/><div class="controls bullet"><span class="by">michaelmior</span><span>|</span><a href="#39396706">parent</a><span>|</span><a href="#39397163">prev</a><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39396943">[-]</label><label class="expand" for="c-39396943">[17 more]</label></div><br/><div class="children"><div class="content">&gt; the current implementation can&#x27;t be relied on IMO<p>What&#x27;s your reasoning for not relying on this? (It seems to me that this would be application-dependent at the very least.)</div><br/><div id="39397296" class="c"><input type="checkbox" id="c-39397296" checked=""/><div class="controls bullet"><span class="by">jdiff</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39396943">parent</a><span>|</span><a href="#39397421">next</a><span>|</span><label class="collapse" for="c-39397296">[-]</label><label class="expand" for="c-39397296">[7 more]</label></div><br/><div class="children"><div class="content">I&#x27;m not the person you asked, but I&#x27;m not sure I understand your question and I&#x27;d like to. It whiffed multiple common softballs, to the point it brings into question the claims made about its performance. What reasoning is there to trust it?</div><br/><div id="39405812" class="c"><input type="checkbox" id="c-39405812" checked=""/><div class="controls bullet"><span class="by">EnigmaFlare</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397296">parent</a><span>|</span><a href="#39402863">next</a><span>|</span><label class="collapse" for="c-39405812">[-]</label><label class="expand" for="c-39405812">[3 more]</label></div><br/><div class="children"><div class="content">It had 3 failures. How is that a sign it&#x27;s untrustworthy? I&#x27;m sure all alternatives have more than 3 failures. You might be making assumptions about the distribution of successes and failures (GP didn&#x27;t say how many files they tested to find those 3) or how &quot;soft&quot; they were. In an extreme case, they might even have been crafted adversarial examples. But even if not, they might have features that really do look more like some other file type from the point of view of the classifier even if it&#x27;s not easily apparent to a human. Being strictly superior to a competent human is a pretty high bar to set.</div><br/><div id="39405871" class="c"><input type="checkbox" id="c-39405871" checked=""/><div class="controls bullet"><span class="by">epcoa</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39405812">parent</a><span>|</span><a href="#39402863">next</a><span>|</span><label class="collapse" for="c-39405871">[-]</label><label class="expand" for="c-39405871">[2 more]</label></div><br/><div class="children"><div class="content">&gt;  or how &quot;soft&quot; they were.<p>From the comment:
It identified some <i>simple</i> <i>HTML</i> <i>files</i> (html, head, title, body, p tags <i>and</i> <i>not</i> <i>much</i> <i>else</i>) as &quot;MS Visual Basic source (VBA)&quot;, &quot;ASP source (code)&quot;, and &quot;Generic text document&quot; where the `file` utility correctly identified all such examples as &quot;HTML document text&quot;.<p>That&#x27;s pretty soft. Nothing &quot;adversarial&quot; claimed either.<p>&gt; Being strictly superior to a competent human is a pretty high bar to set.<p>The bar is the file utility.</div><br/><div id="39405917" class="c"><input type="checkbox" id="c-39405917" checked=""/><div class="controls bullet"><span class="by">EnigmaFlare</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39405871">parent</a><span>|</span><a href="#39402863">next</a><span>|</span><label class="collapse" for="c-39405917">[-]</label><label class="expand" for="c-39405917">[1 more]</label></div><br/><div class="children"><div class="content">Those are only soft to a human. I looked at a couple and I picked them correctly but I don&#x27;t know what details the classifier was seeing which I was blind to. Not to say it was correct, just that we can&#x27;t call them soft just because they&#x27;re short and easy for a human.<p>&gt; The bar is the file utility.<p>It has higher accuracy than that. You would reject it just because the failures are different even though they&#x27;re less?</div><br/></div></div></div></div></div></div><div id="39402863" class="c"><input type="checkbox" id="c-39402863" checked=""/><div class="controls bullet"><span class="by">michaelmior</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397296">parent</a><span>|</span><a href="#39405812">prev</a><span>|</span><a href="#39397421">next</a><span>|</span><label class="collapse" for="c-39402863">[-]</label><label class="expand" for="c-39402863">[3 more]</label></div><br/><div class="children"><div class="content">&gt; It whiffed multiple common softballs<p>I must have missed this in the article. Where was this?</div><br/><div id="39403610" class="c"><input type="checkbox" id="c-39403610" checked=""/><div class="controls bullet"><span class="by">jdiff</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39402863">parent</a><span>|</span><a href="#39402975">prev</a><span>|</span><a href="#39397421">next</a><span>|</span><label class="collapse" for="c-39403610">[-]</label><label class="expand" for="c-39403610">[1 more]</label></div><br/><div class="children"><div class="content">...It&#x27;s in the comment you were responding to. Directly above the section you quoted.</div><br/></div></div></div></div></div></div><div id="39397421" class="c"><input type="checkbox" id="c-39397421" checked=""/><div class="controls bullet"><span class="by">TomNomNom</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39396943">parent</a><span>|</span><a href="#39397296">prev</a><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39397421">[-]</label><label class="expand" for="c-39397421">[9 more]</label></div><br/><div class="children"><div class="content">It provided the wrong file-types for some files, so I cannot rely on its output to be correct.<p>If you wanted to, for example, use this tool to route different files to different format-specific handlers it would sometimes send files to the wrong handlers.</div><br/><div id="39397870" class="c"><input type="checkbox" id="c-39397870" checked=""/><div class="controls bullet"><span class="by">michaelmior</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397421">parent</a><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39397870">[-]</label><label class="expand" for="c-39397870">[8 more]</label></div><br/><div class="children"><div class="content">Except a 100% correct implementation doesn&#x27;t exist AFAIK. So if I want to do anything that makes a decision based on the type of a file, I have to pick <i>some</i> algorithm to do that. If I can do that correctly 99% of the time, that&#x27;s better than not being able to make that decision at all, which is where I&#x27;m left if a perfect implementation doesn&#x27;t exist.</div><br/><div id="39397943" class="c"><input type="checkbox" id="c-39397943" checked=""/><div class="controls bullet"><span class="by">jdiff</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397870">parent</a><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39397943">[-]</label><label class="expand" for="c-39397943">[7 more]</label></div><br/><div class="children"><div class="content">Nobody&#x27;s asking for perfection. But the AI is offering inexplicable and obvious nondeterministic mistakes that the traditional algorithms don&#x27;t suffer from.<p>Magika goes wrong and your fonts become audio files and nobody knows why. Magic goes wrong and your ZIP-based documents get mistaken for generic ZIP files. If you work with that edge case a lot, you can anticipate it with traditional algorithms. You can&#x27;t anticipate nondeterministic hallucination.</div><br/><div id="39405888" class="c"><input type="checkbox" id="c-39405888" checked=""/><div class="controls bullet"><span class="by">EnigmaFlare</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397943">parent</a><span>|</span><a href="#39404497">next</a><span>|</span><label class="collapse" for="c-39405888">[-]</label><label class="expand" for="c-39405888">[1 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t seem all that non-deterministic. I tested the vba.html example multiple times and it always said it was VBA. I added a space between &lt;&#x2F;HEAD&gt; and &lt;BODY&gt; and it correctly picked HTML as most likely but with a low confidence.<p>So I think we can say it&#x27;s sensitive to mysterious features, not that it&#x27;s non-deterministic. Still leads to your same conclusion that you can&#x27;t anticipate the failures. But I don&#x27;t think you can with traditional tools either. Some magic numbers are just plain text (like MZ) which could legitimately accidentally appear at the beginning of a plain text file, for example.</div><br/></div></div><div id="39404497" class="c"><input type="checkbox" id="c-39404497" checked=""/><div class="controls bullet"><span class="by">duskwuff</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397943">parent</a><span>|</span><a href="#39405888">prev</a><span>|</span><a href="#39398426">next</a><span>|</span><label class="collapse" for="c-39404497">[-]</label><label class="expand" for="c-39404497">[1 more]</label></div><br/><div class="children"><div class="content">Seconding this.<p>Something like Magika is potentially useful as a <i>second pass</i> if conventional methods of detecting a file type fail or yield a low-confidence result. But, for the majority of binary files, those conventional methods are perfectly adequate. If the first few bytes of a file are &quot;GIF89a&quot;, you don&#x27;t need an AI to tell you that it&#x27;s probably a GIF image.</div><br/></div></div><div id="39398426" class="c"><input type="checkbox" id="c-39398426" checked=""/><div class="controls bullet"><span class="by">jsnell</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39397943">parent</a><span>|</span><a href="#39404497">prev</a><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39398426">[-]</label><label class="expand" for="c-39398426">[4 more]</label></div><br/><div class="children"><div class="content">Where are you getting the non-determinism part from? It would seem surprising for there to be anything non-deterministic about an ML model like this, and nothing in the original reports seems to suggest that either.</div><br/><div id="39400114" class="c"><input type="checkbox" id="c-39400114" checked=""/><div class="controls bullet"><span class="by">TeMPOraL</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39398426">parent</a><span>|</span><a href="#39403049">next</a><span>|</span><label class="collapse" for="c-39400114">[-]</label><label class="expand" for="c-39400114">[2 more]</label></div><br/><div class="children"><div class="content">Large ML models tend to be uncorrectably non-deterministic simply from doing lots of floating point math in parallel. Addition and multiplication of floats is neither commutative nor associative - you may get different results depending on the order in which you add&#x2F;multiply numbers.</div><br/><div id="39406983" class="c"><input type="checkbox" id="c-39406983" checked=""/><div class="controls bullet"><span class="by">eapriv</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39400114">parent</a><span>|</span><a href="#39403049">next</a><span>|</span><label class="collapse" for="c-39406983">[-]</label><label class="expand" for="c-39406983">[1 more]</label></div><br/><div class="children"><div class="content">Addition and multiplication of floats are commutative.</div><br/></div></div></div></div><div id="39403049" class="c"><input type="checkbox" id="c-39403049" checked=""/><div class="controls bullet"><span class="by">Gormo</span><span>|</span><a href="#39396706">root</a><span>|</span><a href="#39398426">parent</a><span>|</span><a href="#39400114">prev</a><span>|</span><a href="#39392090">next</a><span>|</span><label class="collapse" for="c-39403049">[-]</label><label class="expand" for="c-39403049">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It would seem surprising for there to be anything non-deterministic about an ML model like this<p>I think there may be some confusion of ideas going in here.  Machine learning is fundamentally stochastic, so it is non-deterministic almost by definition.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39392090" class="c"><input type="checkbox" id="c-39392090" checked=""/><div class="controls bullet"><span class="by">stevepike</span><span>|</span><a href="#39396706">prev</a><span>|</span><a href="#39392797">next</a><span>|</span><label class="collapse" for="c-39392090">[-]</label><label class="expand" for="c-39392090">[36 more]</label></div><br/><div class="children"><div class="content">Oh man, this brings me back! Almost 10 years ago I was working on a rails app trying to detect the file type of uploaded spreadsheets (xlsx files were being detected as application&#x2F;zip, which is technically true but useless).<p>I found &quot;magic&quot; that could detect these and submitted a patch at <a href="https:&#x2F;&#x2F;bugs.freedesktop.org&#x2F;show_bug.cgi?id=78797" rel="nofollow">https:&#x2F;&#x2F;bugs.freedesktop.org&#x2F;show_bug.cgi?id=78797</a>. My patch got rejected for needing to look at the first 3KB bytes of the file to figure out the type. They had a hard limit that they wouldn&#x27;t see past the first 256 bytes. Now in 2024 we&#x27;re doing this with deep learning! It&#x27;d be cool if google released some speed performance benchmarks here against the old-fashioned implementations. Obviously it&#x27;d be slower, but is it 1000x or 10^6x?</div><br/><div id="39393682" class="c"><input type="checkbox" id="c-39393682" checked=""/><div class="controls bullet"><span class="by">ebursztein</span><span>|</span><a href="#39392090">parent</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39393682">[-]</label><label class="expand" for="c-39393682">[23 more]</label></div><br/><div class="children"><div class="content">Co-author of Magika here (Elie) so we didn&#x27;t include the measurements in the blog post to avoid making it too long but we did those measurements.<p>Overall file takes about 6ms (single file) 2.26ms per files when scanning multiples. Magika is at 65ms single file and 5.3ms when scanning multiples.<p>So Magika is for the worst case scenario about 10x slower due to the time it takes to load the model and 2x slower on repeated detection. This is why we said it is not that much slower.<p>We will have more performance measurements in the upcoming research paper. Hope that answer the question</div><br/><div id="39397928" class="c"><input type="checkbox" id="c-39397928" checked=""/><div class="controls bullet"><span class="by">chmod775</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39393682">parent</a><span>|</span><a href="#39393862">next</a><span>|</span><label class="collapse" for="c-39397928">[-]</label><label class="expand" for="c-39397928">[1 more]</label></div><br/><div class="children"><div class="content">Is that single-threaded libmagic vs Magika using every core on the system? What are the numbers like if you run multiple libmagic instances in parallel for multiple files, or limit both libmagic and magika to a single core?<p>Testing it on my own system, magika seems to use a lot more CPU-time:<p><pre><code>    file &#x2F;usr&#x2F;lib&#x2F;*  0,34s user 0,54s system 43% cpu 2,010 total
    .&#x2F;file-parallel.sh  0,85s user 1,91s system 580% cpu 0,477 total
    bin&#x2F;magika &#x2F;usr&#x2F;lib&#x2F;*  92,73s user 1,11s system 393% cpu 23,869 total
</code></pre>
Looks about 50x slower to me. There&#x27;s 5k files in my lib folder. It&#x27;s definitely still impressively fast given how the identification is done, but the difference is far from negligible.</div><br/></div></div><div id="39393862" class="c"><input type="checkbox" id="c-39393862" checked=""/><div class="controls bullet"><span class="by">jpk</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39393682">parent</a><span>|</span><a href="#39397928">prev</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39393862">[-]</label><label class="expand" for="c-39393862">[21 more]</label></div><br/><div class="children"><div class="content">Do you have a sense of performance in terms of energy use?  2x slower is fine, but is that at the same wattage, or more?</div><br/><div id="39394028" class="c"><input type="checkbox" id="c-39394028" checked=""/><div class="controls bullet"><span class="by">alephnan</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39393862">parent</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39394028">[-]</label><label class="expand" for="c-39394028">[20 more]</label></div><br/><div class="children"><div class="content">That sounds like a nit &#x2F; premature optimization.<p>Electricity is cheap. If this is sufficiently or actually important for your org, you should measure it yourself. There are too many variables and factors subject to your org’s hardware.</div><br/><div id="39396030" class="c"><input type="checkbox" id="c-39396030" checked=""/><div class="controls bullet"><span class="by">cornholio</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394028">parent</a><span>|</span><a href="#39394118">next</a><span>|</span><label class="collapse" for="c-39396030">[-]</label><label class="expand" for="c-39396030">[1 more]</label></div><br/><div class="children"><div class="content">The hardware requirements of a massively parallel algorithm can&#x27;t possibly be &quot;a nit&quot; in any universe inhabited by rational beings.</div><br/></div></div><div id="39394118" class="c"><input type="checkbox" id="c-39394118" checked=""/><div class="controls bullet"><span class="by">djxfade</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394028">parent</a><span>|</span><a href="#39396030">prev</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39394118">[-]</label><label class="expand" for="c-39394118">[18 more]</label></div><br/><div class="children"><div class="content">Totally disagree. Most end users are on laptops and mobile devices these days, not desktop towers. Thus power efficiency is important for battery life. Performance per watt would be an interesting comparison.</div><br/><div id="39394494" class="c"><input type="checkbox" id="c-39394494" checked=""/><div class="controls bullet"><span class="by">true_religion</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394118">parent</a><span>|</span><a href="#39395219">next</a><span>|</span><label class="collapse" for="c-39394494">[-]</label><label class="expand" for="c-39394494">[8 more]</label></div><br/><div class="children"><div class="content">What end users are working with arbitrary files that they don’t know the identification of?<p>This entire use case seems to be one suited for servers handling user media.</div><br/><div id="39395638" class="c"><input type="checkbox" id="c-39395638" checked=""/><div class="controls bullet"><span class="by">wongarsu</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394494">parent</a><span>|</span><a href="#39395127">next</a><span>|</span><label class="collapse" for="c-39395638">[-]</label><label class="expand" for="c-39395638">[3 more]</label></div><br/><div class="children"><div class="content">File managers that render preview images. Even detecting which software to open the file with when you click it.<p>Of course on Windows the convention is to use the file extension, but on other platforms the convention is to look at the file contents</div><br/><div id="39396981" class="c"><input type="checkbox" id="c-39396981" checked=""/><div class="controls bullet"><span class="by">michaelmior</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395638">parent</a><span>|</span><a href="#39395127">next</a><span>|</span><label class="collapse" for="c-39396981">[-]</label><label class="expand" for="c-39396981">[2 more]</label></div><br/><div class="children"><div class="content">&gt; on other platforms the convention is to look at the file contents<p>MacOS (that is, Finder) also looks at the extension. That has also been the case with any file manager I&#x27;ve used on Linux distros that I can recall.</div><br/><div id="39397335" class="c"><input type="checkbox" id="c-39397335" checked=""/><div class="controls bullet"><span class="by">jdiff</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39396981">parent</a><span>|</span><a href="#39395127">next</a><span>|</span><label class="collapse" for="c-39397335">[-]</label><label class="expand" for="c-39397335">[1 more]</label></div><br/><div class="children"><div class="content">You might be surprised. Rename your Photo.JPG as Photo.PNG and you&#x27;ll still get a perfectly fine thumbnail. The extension is a hint, but it isn&#x27;t definitive, especially when you start downloading from the web.</div><br/></div></div></div></div></div></div><div id="39395127" class="c"><input type="checkbox" id="c-39395127" checked=""/><div class="controls bullet"><span class="by">r0ze-at-hn</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394494">parent</a><span>|</span><a href="#39395638">prev</a><span>|</span><a href="#39394909">next</a><span>|</span><label class="collapse" for="c-39395127">[-]</label><label class="expand" for="c-39395127">[1 more]</label></div><br/><div class="children"><div class="content">Browsers often need to guess a file type</div><br/></div></div><div id="39394909" class="c"><input type="checkbox" id="c-39394909" checked=""/><div class="controls bullet"><span class="by">michaelt</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394494">parent</a><span>|</span><a href="#39395127">prev</a><span>|</span><a href="#39395219">next</a><span>|</span><label class="collapse" for="c-39394909">[-]</label><label class="expand" for="c-39394909">[3 more]</label></div><br/><div class="children"><div class="content">Theoretically? Anyone running a virus scanner.<p>Of course, it&#x27;s arguably unlikely a virus scanner would opt for an ML-based approach, as they specifically need to be robust against adversarial inputs.</div><br/><div id="39397006" class="c"><input type="checkbox" id="c-39397006" checked=""/><div class="controls bullet"><span class="by">michaelmior</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394909">parent</a><span>|</span><a href="#39395432">next</a><span>|</span><label class="collapse" for="c-39397006">[-]</label><label class="expand" for="c-39397006">[1 more]</label></div><br/><div class="children"><div class="content">&gt; it&#x27;s arguably unlikely a virus scanner would opt for an ML-based approach<p>Several major players such as Norton, McAfee, and Symantec all at least claim to use AI&#x2F;ML in their antivirus products.</div><br/></div></div><div id="39395432" class="c"><input type="checkbox" id="c-39395432" checked=""/><div class="controls bullet"><span class="by">scq</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394909">parent</a><span>|</span><a href="#39397006">prev</a><span>|</span><a href="#39395219">next</a><span>|</span><label class="collapse" for="c-39395432">[-]</label><label class="expand" for="c-39395432">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;d be surprised what an AV scanner would do.<p><a href="https:&#x2F;&#x2F;twitter.com&#x2F;taviso&#x2F;status&#x2F;732365178872856577" rel="nofollow">https:&#x2F;&#x2F;twitter.com&#x2F;taviso&#x2F;status&#x2F;732365178872856577</a></div><br/></div></div></div></div></div></div><div id="39395219" class="c"><input type="checkbox" id="c-39395219" checked=""/><div class="controls bullet"><span class="by">vertis</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394118">parent</a><span>|</span><a href="#39394494">prev</a><span>|</span><a href="#39394553">next</a><span>|</span><label class="collapse" for="c-39395219">[-]</label><label class="expand" for="c-39395219">[6 more]</label></div><br/><div class="children"><div class="content">I mean if you care about that you shouldn&#x27;t be running anything that isn&#x27;t highly optimized. Don&#x27;t open webpages that might be CPU or GPU intensive. Don&#x27;t run Electron apps, or really anything that isn&#x27;t built in a compiled language.<p>Certainly you should do an audit of all the Android and iOS apps as well, to make sure they&#x27;ve been made in a efficient manner.<p>Block ads as well, they waste power.<p>This file identification is SUCH a small aspect of everything that is burning power in your laptop or phone as to be laughable.</div><br/><div id="39395317" class="c"><input type="checkbox" id="c-39395317" checked=""/><div class="controls bullet"><span class="by">_puk</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395219">parent</a><span>|</span><a href="#39394553">next</a><span>|</span><label class="collapse" for="c-39395317">[-]</label><label class="expand" for="c-39395317">[5 more]</label></div><br/><div class="children"><div class="content">Whilst energy usage is indeed a small aspect this early on when using bespoke models, we do have to consider that this is a model for simply identifying a file type.<p>What happens when we introduce more bespoke models for manipulating the data in that file?<p>This feels like it could slowly boil to the point of programs using magnitudes higher power, at which point it&#x27;ll be hard to claw it back.</div><br/><div id="39395865" class="c"><input type="checkbox" id="c-39395865" checked=""/><div class="controls bullet"><span class="by">vertis</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395317">parent</a><span>|</span><a href="#39397528">next</a><span>|</span><label class="collapse" for="c-39395865">[-]</label><label class="expand" for="c-39395865">[3 more]</label></div><br/><div class="children"><div class="content">That&#x27;s a slippery slope argument, which is a common logical fallacy[0]. This model being inefficient compared to the best possible implementation does not mean that future additions will also be inefficient.<p>It&#x27;s the equivalent to saying many people programming in Ruby is causing all future programs to be less efficient. Which is not true. In fact, many people programming in Ruby has caused Ruby to become more efficient because it gets optimised as it gets used more (or Python for that matter).<p>It&#x27;s not as energy efficient as C, but it hasn&#x27;t caused it to get worse and worse, and spiral out of control.<p>Likewise smart contracts are incredibly inefficient mechanisms of computation. The result is mostly that people don&#x27;t use them for any meaningful amounts of computation, that all gets done &quot;Off Chain&quot;.<p>Generative AI is definitely less efficient, but it&#x27;s likely to improve over time, and indeed things like quantization has allowed models that would normally to require much more substantial hardware resources (and therefore, more energy intensive) to be run on smaller systems.<p>[0]: <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Slippery_slope" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Slippery_slope</a></div><br/><div id="39397598" class="c"><input type="checkbox" id="c-39397598" checked=""/><div class="controls bullet"><span class="by">diffeomorphism</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395865">parent</a><span>|</span><a href="#39397528">next</a><span>|</span><label class="collapse" for="c-39397598">[-]</label><label class="expand" for="c-39397598">[2 more]</label></div><br/><div class="children"><div class="content">That is a fallacy fallacy. Just because some slopes are not slippery that does not mean none of them are.</div><br/><div id="39405122" class="c"><input type="checkbox" id="c-39405122" checked=""/><div class="controls bullet"><span class="by">samatman</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39397598">parent</a><span>|</span><a href="#39397528">next</a><span>|</span><label class="collapse" for="c-39405122">[-]</label><label class="expand" for="c-39405122">[1 more]</label></div><br/><div class="children"><div class="content">The slippery slope fallacy is: &quot;this is a slope. you will slip down it.&quot; and is always fallacious. Always. The valid form of such an argument is: &quot;this is a slope, <i>and it is a slippery one</i>, therefore, you will slip down it.&quot;</div><br/></div></div></div></div></div></div><div id="39397528" class="c"><input type="checkbox" id="c-39397528" checked=""/><div class="controls bullet"><span class="by">thfuran</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395317">parent</a><span>|</span><a href="#39395865">prev</a><span>|</span><a href="#39394553">next</a><span>|</span><label class="collapse" for="c-39397528">[-]</label><label class="expand" for="c-39397528">[1 more]</label></div><br/><div class="children"><div class="content">&gt;This feels like it could slowly boil to the point of programs using magnitudes higher power, at which point it&#x27;ll be hard to claw it back.<p>We&#x27;re already there. Modern software is, by and large, profoundly inefficient.</div><br/></div></div></div></div></div></div><div id="39394553" class="c"><input type="checkbox" id="c-39394553" checked=""/><div class="controls bullet"><span class="by">underdeserver</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394118">parent</a><span>|</span><a href="#39395219">prev</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39394553">[-]</label><label class="expand" for="c-39394553">[3 more]</label></div><br/><div class="children"><div class="content">In general you&#x27;re right, but I can&#x27;t think of a single local use for identifying file types by a human on a laptop - at least, one with scale where this matters. It&#x27;s all going to be SaaS services where people upload stuff.</div><br/><div id="39394780" class="c"><input type="checkbox" id="c-39394780" checked=""/><div class="controls bullet"><span class="by">prmph</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394553">parent</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39394780">[-]</label><label class="expand" for="c-39394780">[2 more]</label></div><br/><div class="children"><div class="content">We are building a data analysis tool with great UX, where users select data files, which are then parsed and uploaded to S3 directly, on their client machines. The server only takes over after this step.<p>Since the data files can be large, this approach bypasses having to trnasfer the file twice, first to the server, and then to S3 after parsing.</div><br/><div id="39397389" class="c"><input type="checkbox" id="c-39397389" checked=""/><div class="controls bullet"><span class="by">DontSignAnytng</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39394780">parent</a><span>|</span><a href="#39393821">next</a><span>|</span><label class="collapse" for="c-39397389">[-]</label><label class="expand" for="c-39397389">[1 more]</label></div><br/><div class="children"><div class="content">This dont sound like very common scenario.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="39393821" class="c"><input type="checkbox" id="c-39393821" checked=""/><div class="controls bullet"><span class="by">metafunctor</span><span>|</span><a href="#39392090">parent</a><span>|</span><a href="#39393682">prev</a><span>|</span><a href="#39392340">next</a><span>|</span><label class="collapse" for="c-39393821">[-]</label><label class="expand" for="c-39393821">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve ended up implementing a layer on top of &quot;magic&quot; which, if magic detects application&#x2F;zip, reads the zip file manifest and checks for telltale file names to reliably detect Office files.<p>The &quot;magic&quot; library does not seem to be equipped with the capabilities needed to be robust against the zip manifest being ordered in a different way than expected.<p>But this deep learning approach... I don&#x27;t know.  It might be hard to shoehorn in to many applications where the traditional methods have negligible memory and compute costs and the accuracy is basically 100% for cases that matter (detecting particular file types of interest).   But when looking at a large random collection of unknown blobs, yeah, I can see how this could be great.</div><br/><div id="39396963" class="c"><input type="checkbox" id="c-39396963" checked=""/><div class="controls bullet"><span class="by">stevepike</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39393821">parent</a><span>|</span><a href="#39395526">next</a><span>|</span><label class="collapse" for="c-39396963">[-]</label><label class="expand" for="c-39396963">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re curious, here&#x27;s how I solved it for ruby back in the day. Still used magic bytes, but added an overlay on top of the freedesktop.org DB: <a href="https:&#x2F;&#x2F;github.com&#x2F;mimemagicrb&#x2F;mimemagic&#x2F;pull&#x2F;20">https:&#x2F;&#x2F;github.com&#x2F;mimemagicrb&#x2F;mimemagic&#x2F;pull&#x2F;20</a></div><br/></div></div><div id="39395526" class="c"><input type="checkbox" id="c-39395526" checked=""/><div class="controls bullet"><span class="by">comboy</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39393821">parent</a><span>|</span><a href="#39396963">prev</a><span>|</span><a href="#39392340">next</a><span>|</span><label class="collapse" for="c-39395526">[-]</label><label class="expand" for="c-39395526">[3 more]</label></div><br/><div class="children"><div class="content">Many commenters seem to be using <i>magic</i> instead of <i>file</i>, any reasons?</div><br/><div id="39395762" class="c"><input type="checkbox" id="c-39395762" checked=""/><div class="controls bullet"><span class="by">e1g</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395526">parent</a><span>|</span><a href="#39392340">next</a><span>|</span><label class="collapse" for="c-39395762">[-]</label><label class="expand" for="c-39395762">[2 more]</label></div><br/><div class="children"><div class="content"><i>magic</i> is the core detection logic of <i>file</i> that was extracted out to be available as a library. So these days <i>file</i> is just a higher level wrapper around <i>magic</i></div><br/><div id="39401069" class="c"><input type="checkbox" id="c-39401069" checked=""/><div class="controls bullet"><span class="by">comboy</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395762">parent</a><span>|</span><a href="#39392340">next</a><span>|</span><label class="collapse" for="c-39401069">[-]</label><label class="expand" for="c-39401069">[1 more]</label></div><br/><div class="children"><div class="content">thanks</div><br/></div></div></div></div></div></div></div></div><div id="39392340" class="c"><input type="checkbox" id="c-39392340" checked=""/><div class="controls bullet"><span class="by">renonce</span><span>|</span><a href="#39392090">parent</a><span>|</span><a href="#39393821">prev</a><span>|</span><a href="#39395797">next</a><span>|</span><label class="collapse" for="c-39392340">[-]</label><label class="expand" for="c-39392340">[4 more]</label></div><br/><div class="children"><div class="content">From the first paragraph:<p>&gt; enabling precise file identification within milliseconds, even when running on a CPU.<p>Maybe your old-fashioned implementations were detecting in microseconds?</div><br/><div id="39392370" class="c"><input type="checkbox" id="c-39392370" checked=""/><div class="controls bullet"><span class="by">stevepike</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39392340">parent</a><span>|</span><a href="#39393591">next</a><span>|</span><label class="collapse" for="c-39392370">[-]</label><label class="expand" for="c-39392370">[2 more]</label></div><br/><div class="children"><div class="content">Yeah I saw that, but that could cover a pretty wide range and it&#x27;s not clear to me whether that relies on preloading a model.</div><br/><div id="39393504" class="c"><input type="checkbox" id="c-39393504" checked=""/><div class="controls bullet"><span class="by">ryanjshaw</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39392370">parent</a><span>|</span><a href="#39393591">next</a><span>|</span><label class="collapse" for="c-39393504">[-]</label><label class="expand" for="c-39393504">[1 more]</label></div><br/><div class="children"><div class="content">&gt; At inference time Magika uses Onnx as an inference engine to ensure files are identified in a matter of milliseconds, almost as fast as a non-AI tool even on CPU.</div><br/></div></div></div></div></div></div><div id="39395797" class="c"><input type="checkbox" id="c-39395797" checked=""/><div class="controls bullet"><span class="by">brabel</span><span>|</span><a href="#39392090">parent</a><span>|</span><a href="#39392340">prev</a><span>|</span><a href="#39402674">next</a><span>|</span><label class="collapse" for="c-39395797">[-]</label><label class="expand" for="c-39395797">[2 more]</label></div><br/><div class="children"><div class="content">&gt; They had a hard limit that they wouldn&#x27;t see past the first 256 bytes.<p>Then they could never detect zip files with certainty, given that to do that you need to read up to 65KB (+ 22) at the END of the file. The reason is that the zip archive format allows &quot;gargabe&quot; bytes both in the beginning of the file and in between local file headers.... and it&#x27;s actually not uncommon to prepend a program that self-extracts the archive, for example. The only way to know if a file is a valid zip archive is to look for the End of Central Directory Entry, which is always at the end of the file AND allows for a comment of unknown length at the end (and as the comment length field takes 2 bytes, the comment can be up to 65K long).</div><br/><div id="39397986" class="c"><input type="checkbox" id="c-39397986" checked=""/><div class="controls bullet"><span class="by">jeffbee</span><span>|</span><a href="#39392090">root</a><span>|</span><a href="#39395797">parent</a><span>|</span><a href="#39402674">next</a><span>|</span><label class="collapse" for="c-39397986">[-]</label><label class="expand" for="c-39397986">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s why the whole question is ill formed. A file does not have exactly one type. It may be a valid input in various contexts. A zip archive may also very well be something else.</div><br/></div></div></div></div><div id="39402674" class="c"><input type="checkbox" id="c-39402674" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#39392090">parent</a><span>|</span><a href="#39395797">prev</a><span>|</span><a href="#39392797">next</a><span>|</span><label class="collapse" for="c-39402674">[-]</label><label class="expand" for="c-39402674">[1 more]</label></div><br/><div class="children"><div class="content">FWIW, file can now distinguish many types of zip containers, including Oxml files.</div><br/></div></div></div></div><div id="39392797" class="c"><input type="checkbox" id="c-39392797" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392090">prev</a><span>|</span><a href="#39398028">next</a><span>|</span><label class="collapse" for="c-39392797">[-]</label><label class="expand" for="c-39392797">[18 more]</label></div><br/><div class="children"><div class="content">As someone that has worked in a space that has to deal with uploaded files for the last few years, and someone who maintains a WASM libmagic Node package ( <a href="https:&#x2F;&#x2F;github.com&#x2F;moshen&#x2F;wasmagic">https:&#x2F;&#x2F;github.com&#x2F;moshen&#x2F;wasmagic</a> ) , I have to say I really love seeing new entries into the file type detection space.<p>Though I have to say when looking at the Node module, I don&#x27;t understand why they released it.<p>Their docs say it&#x27;s slow:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;120205323e260dad4e58778093fb220aa1991c2b&#x2F;js&#x2F;README.md#L43-L44">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;120205323e260dad4e5877...</a><p>It loads the model an runtime:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;120205323e260dad4e58778093fb220aa1991c2b&#x2F;js&#x2F;magika.js#L74-L75">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;120205323e260dad4e5877...</a><p>They mark it as Experimental in the documentation, but it seems like it was just made for the web demo.<p>Also as others have mentioned. The model appears to only detect 116 file types:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;120205323e260dad4e58778093fb220aa1991c2b&#x2F;docs&#x2F;supported-content-types-list.md">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;120205323e260dad4e5877...</a><p>Where libmagic detects... a lot. Over 1600 last time I checked:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;file&#x2F;file&#x2F;tree&#x2F;4cbd5c8f0851201d203755b76cb66ba991ffd8be&#x2F;magic&#x2F;Magdir">https:&#x2F;&#x2F;github.com&#x2F;file&#x2F;file&#x2F;tree&#x2F;4cbd5c8f0851201d203755b76c...</a><p>I guess I&#x27;m confused by this release. Sure it detected most of my list of sample files, but in a sample set of 4 zip files, it misidentified one.</div><br/><div id="39392940" class="c"><input type="checkbox" id="c-39392940" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">parent</a><span>|</span><a href="#39393637">next</a><span>|</span><label class="collapse" for="c-39392940">[-]</label><label class="expand" for="c-39392940">[6 more]</label></div><br/><div class="children"><div class="content">Made a small test to try it out: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;moshen&#x2F;784ee4a38439f00b17855233617e9e13" rel="nofollow">https:&#x2F;&#x2F;gist.github.com&#x2F;moshen&#x2F;784ee4a38439f00b17855233617e9...</a><p><pre><code>    hyperfine .&#x2F;magika.bash .&#x2F;file.bash
    Benchmark 1: .&#x2F;magika.bash
      Time (mean ± σ):     706.2 ms ±  21.1 ms    [User: 10520.3 ms, System: 1604.6 ms]
      Range (min … max):   684.0 ms … 738.9 ms    10 runs
    
    Benchmark 2: .&#x2F;file.bash
      Time (mean ± σ):      23.6 ms ±   1.1 ms    [User: 15.7 ms, System: 7.9 ms]
      Range (min … max):    22.4 ms …  29.0 ms    111 runs
    
    Summary
      &#x27;.&#x2F;file.bash&#x27; ran
       29.88 ± 1.65 times faster than &#x27;.&#x2F;magika.bash&#x27;</code></pre></div><br/><div id="39396168" class="c"><input type="checkbox" id="c-39396168" checked=""/><div class="controls bullet"><span class="by">barrkel</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39392940">parent</a><span>|</span><a href="#39399868">next</a><span>|</span><label class="collapse" for="c-39396168">[-]</label><label class="expand" for="c-39396168">[4 more]</label></div><br/><div class="children"><div class="content">Realistically, either you&#x27;re identifying one file interactively and you don&#x27;t care about latency differences in the 10s of ms, or you&#x27;re identifying in bulk (batch command line or online in response to requests), in which case you should measure the marginal cost and exclude Python startup and model loading times.</div><br/><div id="39397550" class="c"><input type="checkbox" id="c-39397550" checked=""/><div class="controls bullet"><span class="by">chmod775</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39396168">parent</a><span>|</span><a href="#39397477">next</a><span>|</span><label class="collapse" for="c-39397550">[-]</label><label class="expand" for="c-39397550">[1 more]</label></div><br/><div class="children"><div class="content">Going by those number it&#x27;s taking almost a second to run, not 10s of ms. And going by those numbers, it&#x27;s doing something massively parallel in that time. So basically all your cores will spike to 100% for almost a second during those one-shot identifications. It looks like GP has a 12-16 threads CPU, <i>and it is using those while still being 30 times slower than single-threaded libmagic</i>.<p>That tool needs 100x more CPU time just to figure out some filetypes than vim needs to open a file from a cold start (which presumably includes using libmagic to check the type).<p>If I had to wait a second just to open something during which that thing uses every resource available on my computer to the fullest, I&#x27;d probably break my keyboard. Try using that thing as a drop-in <i>file</i> replacement, open some folder in your favorite file manager, and watch your computer slow to a crawl as your file manager tries to figure out what thumbnails to render.<p>It&#x27;s utterly unsuitable for &quot;interactive&quot; identifications.</div><br/></div></div><div id="39397477" class="c"><input type="checkbox" id="c-39397477" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39396168">parent</a><span>|</span><a href="#39397550">prev</a><span>|</span><a href="#39398401">next</a><span>|</span><label class="collapse" for="c-39397477">[-]</label><label class="expand" for="c-39397477">[1 more]</label></div><br/><div class="children"><div class="content">My little script is trying to identify in bulk, at least by passing 165 file paths to `magika`, and `file`.<p>Though, I absolutely agree with you. I think realistically it&#x27;s better to do this kind of thing in a library rather than shell out to it at all. I was just trying to get an idea on how it generally compares.<p>Another note, I was trying to be generous to `magicka` here because when it&#x27;s single file identification, it&#x27;s about 160-180ms on my machine vs &lt;1ms for `file`. I realize that&#x27;s going to be quite a bit of python startup in that number, which is why I didn&#x27;t go with it when pushing that benchmark up earlier. I&#x27;ll probably push an update to that gist to include the single file benchmark as well.</div><br/></div></div></div></div><div id="39399868" class="c"><input type="checkbox" id="c-39399868" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39392940">parent</a><span>|</span><a href="#39396168">prev</a><span>|</span><a href="#39393637">next</a><span>|</span><label class="collapse" for="c-39399868">[-]</label><label class="expand" for="c-39399868">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve updated this script with some single-file cli numbers, which are (as expected) not good. Mostly just comparing python startup time for that.<p><pre><code>    make
    sqlite3 &lt; analyze.sql
    file_avg              python_avg         python_x_times_slower_single_cli
    --------------------  -----------------  --------------------------------
    0.000874874856301821  0.179884610224334  205.611818568799
    file_avg            python_avg     python_x_times_slower_bulk_cli
    ------------------  -------------  ------------------------------
    0.0231715865881818  0.69613745142  30.0427184289163</code></pre></div><br/></div></div></div></div><div id="39393637" class="c"><input type="checkbox" id="c-39393637" checked=""/><div class="controls bullet"><span class="by">ebursztein</span><span>|</span><a href="#39392797">parent</a><span>|</span><a href="#39392940">prev</a><span>|</span><a href="#39394400">next</a><span>|</span><label class="collapse" for="c-39393637">[-]</label><label class="expand" for="c-39393637">[2 more]</label></div><br/><div class="children"><div class="content">We did release the npm package because indeed we create a web demo and thought people might want to also use it. We know it is not as fast as the python version or a C++ version -- which why we did mark it as experimental.<p>The release include the python package and the cli which are quite fast and is the main way we did expect people to use -- sorry if that hasn&#x27;t be clear in the post.<p>The goal of the release is to offer a tool that is far more accurate that other tools and works on the major file types as we hope it to be useful to the community.<p>Glad to hear it worked on your files</div><br/><div id="39393786" class="c"><input type="checkbox" id="c-39393786" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39393637">parent</a><span>|</span><a href="#39394400">next</a><span>|</span><label class="collapse" for="c-39393786">[-]</label><label class="expand" for="c-39393786">[1 more]</label></div><br/><div class="children"><div class="content">Thank you for the release! I understand you&#x27;re just getting it out the door. I just hope to see it delivered as a native library or something more reusable.<p>I did try the python cli, but it seems to be about 30x slower than `file` for the random bag of files I checked.<p>I&#x27;ll probably take some time this weekend to make a couple of issues around misidentified files.<p>I&#x27;ll definitely be adding this to my toolset!</div><br/></div></div></div></div><div id="39394400" class="c"><input type="checkbox" id="c-39394400" checked=""/><div class="controls bullet"><span class="by">invernizzi</span><span>|</span><a href="#39392797">parent</a><span>|</span><a href="#39393637">prev</a><span>|</span><a href="#39397391">next</a><span>|</span><label class="collapse" for="c-39394400">[-]</label><label class="expand" for="c-39394400">[2 more]</label></div><br/><div class="children"><div class="content">Hello!
We wrote the Node library as a first functional version. 
Its API is already stable, but it&#x27;s a bit slower than the Python library for two reasons: it loads the model at runtime, and it doesn&#x27;t do batch lookups, meaning it calls the model for each file.
Other than that, it&#x27;s just as fast for single file lookups, which is the most common usecase.</div><br/><div id="39397557" class="c"><input type="checkbox" id="c-39397557" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39394400">parent</a><span>|</span><a href="#39397391">next</a><span>|</span><label class="collapse" for="c-39397557">[-]</label><label class="expand" for="c-39397557">[1 more]</label></div><br/><div class="children"><div class="content">Good to know! Thank you. I&#x27;ll definitely be trying it out. Though, I might download and hardcode the model ;)<p>I also appreciate the use of ONNX here, as I&#x27;m already thinking about using another version of the runtime.<p>Do you think you&#x27;ll open source your F1 benchmark?</div><br/></div></div></div></div><div id="39397391" class="c"><input type="checkbox" id="c-39397391" checked=""/><div class="controls bullet"><span class="by">tudorw</span><span>|</span><a href="#39392797">parent</a><span>|</span><a href="#39394400">prev</a><span>|</span><a href="#39395054">next</a><span>|</span><label class="collapse" for="c-39397391">[-]</label><label class="expand" for="c-39397391">[2 more]</label></div><br/><div class="children"><div class="content">Can we do the 1600 if known, if not, let the AI take a guess?</div><br/><div id="39398548" class="c"><input type="checkbox" id="c-39398548" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39397391">parent</a><span>|</span><a href="#39395054">next</a><span>|</span><label class="collapse" for="c-39398548">[-]</label><label class="expand" for="c-39398548">[1 more]</label></div><br/><div class="children"><div class="content">Absolutely, and honestly in a non-interactive ingestion workflow you&#x27;re probably doing multiple checks anyway. I&#x27;ve worked with systems that call multiple libraries and hand-coded validation for each incoming file.<p>Maybe it&#x27;s my general malaise, or disillusionment with the software industry, but when I wrote that I was really just expecting more.</div><br/></div></div></div></div><div id="39395054" class="c"><input type="checkbox" id="c-39395054" checked=""/><div class="controls bullet"><span class="by">michaelt</span><span>|</span><a href="#39392797">parent</a><span>|</span><a href="#39397391">prev</a><span>|</span><a href="#39392900">next</a><span>|</span><label class="collapse" for="c-39395054">[-]</label><label class="expand" for="c-39395054">[3 more]</label></div><br/><div class="children"><div class="content"><i>&gt; The model appears to only detect 116 file types [...] Where libmagic detects... a lot. Over 1600 last time I checked</i><p>As I&#x27;m sure you know, in a lot of applications, you&#x27;re preparing things for a downstream process which supports far fewer than 1600 file types.<p>For example, a printer driver might call on <i>file</i> to check if an input is postscript or PDF, to choose the appropriate converter - and for any other format, just reject the input.<p>Or someone training an ML model to generate Python code might have a load of files they&#x27;ve scraped from the web, but might want to discard anything that isn&#x27;t Python.</div><br/><div id="39407105" class="c"><input type="checkbox" id="c-39407105" checked=""/><div class="controls bullet"><span class="by">eapriv</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39395054">parent</a><span>|</span><a href="#39396576">next</a><span>|</span><label class="collapse" for="c-39407105">[-]</label><label class="expand" for="c-39407105">[1 more]</label></div><br/><div class="children"><div class="content">Surely identifying just one file type (or two, as in your example) is a much simpler task that shouldn’t rely on horribly inefficient and imprecise “AI” tools?</div><br/></div></div><div id="39396576" class="c"><input type="checkbox" id="c-39396576" checked=""/><div class="controls bullet"><span class="by">theon144</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39395054">parent</a><span>|</span><a href="#39407105">prev</a><span>|</span><a href="#39392900">next</a><span>|</span><label class="collapse" for="c-39396576">[-]</label><label class="expand" for="c-39396576">[1 more]</label></div><br/><div class="children"><div class="content">Okay, but your one file type is more likely to be included in the 1600 that libmagic supports rather than Magika&#x27;s 116?<p>For that matter, the file types I care about are unfortunately misdetected by Magika (which is also an important point - the `file` command at least gives up and says &quot;data&quot; when it doesn&#x27;t know, whereas the Magika demo gives a confidently wrong answer).<p>I don&#x27;t want to criticize the release because it&#x27;s not meant to be a production-ready piece of software, and I&#x27;m sure the current 116 types isn&#x27;t a hard limit, but I do understand the parent comment&#x27;s contention.</div><br/></div></div></div></div><div id="39392900" class="c"><input type="checkbox" id="c-39392900" checked=""/><div class="controls bullet"><span class="by">lebean</span><span>|</span><a href="#39392797">parent</a><span>|</span><a href="#39395054">prev</a><span>|</span><a href="#39398028">next</a><span>|</span><label class="collapse" for="c-39392900">[-]</label><label class="expand" for="c-39392900">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s for researchers, probably.</div><br/><div id="39392984" class="c"><input type="checkbox" id="c-39392984" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392797">root</a><span>|</span><a href="#39392900">parent</a><span>|</span><a href="#39398028">next</a><span>|</span><label class="collapse" for="c-39392984">[-]</label><label class="expand" for="c-39392984">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, there is this line:<p><pre><code>    By open-sourcing Magika, we aim to help other software improve their file identification accuracy and offer researchers a reliable method for identifying file types at scale.
</code></pre>
Which implies a production-ready release for general usage, as well as usage by security researchers.</div><br/></div></div></div></div></div></div><div id="39398028" class="c"><input type="checkbox" id="c-39398028" checked=""/><div class="controls bullet"><span class="by">Eiim</span><span>|</span><a href="#39392797">prev</a><span>|</span><a href="#39392130">next</a><span>|</span><label class="collapse" for="c-39398028">[-]</label><label class="expand" for="c-39398028">[3 more]</label></div><br/><div class="children"><div class="content">I ran a quick test on 100 semi-random files I had laying around. Of those, 81 were detected correctly, 6 were detected as the wrong file type, and 12 were detected with an unspecific file type (unknown binary&#x2F;generic text) when a more specific type existed. In 4 of the unspecific cases, a low-confidence guess was provided, which was wrong in each case. However, almost all of the files which were detected wrong&#x2F;unspecific are of types not supported by Magika, with one exception of a JSON file containing a lot of JS code as text, which was detected as JS code. For comparison, file 5.45 (the version I happened to have installed) got 83 correct, 6 wrong, and 10 not specific. It detected the weird JSON correctly, but also had its own strange issues, such as detecting a CSV as just &quot;data&quot;. The &quot;wrong&quot; here was somewhat skewed by the 4 GLSL shader code files that were in the dataset for some reason, all of which it detected as C code (Magika called them unknown). The other two &quot;wrong&quot; detections were also code formats that it seems it doesn&#x27;t support. It was also able to output a lot more information about the media files. Not sure what to make of these tests but perhaps they&#x27;re useful to somebody.</div><br/><div id="39401118" class="c"><input type="checkbox" id="c-39401118" checked=""/><div class="controls bullet"><span class="by">pizzalife</span><span>|</span><a href="#39398028">parent</a><span>|</span><a href="#39392130">next</a><span>|</span><label class="collapse" for="c-39401118">[-]</label><label class="expand" for="c-39401118">[2 more]</label></div><br/><div class="children"><div class="content">&gt; The &quot;wrong&quot; here was somewhat skewed by the 4 GLSL shader code files that were in the dataset for some reason, all of which it detected as C code<p>To be fair though, a snippet of GLSL shader code can be perfectly valid C.</div><br/><div id="39401986" class="c"><input type="checkbox" id="c-39401986" checked=""/><div class="controls bullet"><span class="by">Eiim</span><span>|</span><a href="#39398028">root</a><span>|</span><a href="#39401118">parent</a><span>|</span><a href="#39392130">next</a><span>|</span><label class="collapse" for="c-39401986">[-]</label><label class="expand" for="c-39401986">[1 more]</label></div><br/><div class="children"><div class="content">Indeed, which is why I felt the need to call it out here. I&#x27;m not certain if the files on question actually happened to be valid C but whether that&#x27;s a meaningful mistake regardless is left to the reader to decide.</div><br/></div></div></div></div></div></div><div id="39392130" class="c"><input type="checkbox" id="c-39392130" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#39398028">prev</a><span>|</span><a href="#39394737">next</a><span>|</span><label class="collapse" for="c-39392130">[-]</label><label class="expand" for="c-39392130">[9 more]</label></div><br/><div class="children"><div class="content">I&#x27;m extremely confused about the claim that other tools have a worse precision or recall for APK or JAR files which are very much regular. Like, they should be a valid ZIP file with `META-INF&#x2F;MANIFEST.MF` present (at least), and APK would need `classes.dex` as well, but at this point there is no other format that can be confused with APK or JAR I believe. I&#x27;d like to see which file was causing unexpected drop on precision or recall.</div><br/><div id="39395555" class="c"><input type="checkbox" id="c-39395555" checked=""/><div class="controls bullet"><span class="by">Someone</span><span>|</span><a href="#39392130">parent</a><span>|</span><a href="#39392701">next</a><span>|</span><label class="collapse" for="c-39395555">[-]</label><label class="expand" for="c-39395555">[1 more]</label></div><br/><div class="children"><div class="content">People do create JAR files without a META-INF&#x2F;MANIFEST.MF entry.<p>The tooling even supports it. <a href="https:&#x2F;&#x2F;docs.oracle.com&#x2F;en&#x2F;java&#x2F;javase&#x2F;21&#x2F;docs&#x2F;specs&#x2F;man&#x2F;jar.html#operation-modifiers-valid-only-in-create-and-update-modes" rel="nofollow">https:&#x2F;&#x2F;docs.oracle.com&#x2F;en&#x2F;java&#x2F;javase&#x2F;21&#x2F;docs&#x2F;specs&#x2F;man&#x2F;jar...</a>:<p><pre><code>  -M or --no-manifest
     Doesn&#x27;t create a manifest file for the entries</code></pre></div><br/></div></div><div id="39392701" class="c"><input type="checkbox" id="c-39392701" checked=""/><div class="controls bullet"><span class="by">HtmlProgrammer</span><span>|</span><a href="#39392130">parent</a><span>|</span><a href="#39395555">prev</a><span>|</span><a href="#39393149">next</a><span>|</span><label class="collapse" for="c-39392701">[-]</label><label class="expand" for="c-39392701">[1 more]</label></div><br/><div class="children"><div class="content">Minecraft mods 14 years ago used to tell you to open the JAR and delete the META-INF when installing them so can’t rely on that one…</div><br/></div></div><div id="39393149" class="c"><input type="checkbox" id="c-39393149" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#39392130">parent</a><span>|</span><a href="#39392701">prev</a><span>|</span><a href="#39392667">next</a><span>|</span><label class="collapse" for="c-39393149">[-]</label><label class="expand" for="c-39393149">[5 more]</label></div><br/><div class="children"><div class="content">The `file` command checks only the first few bytes, and doesn’t parse the structure of the file. APK files are indeed reported as Zip archives by the latest version of `file`.</div><br/><div id="39393506" class="c"><input type="checkbox" id="c-39393506" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392130">root</a><span>|</span><a href="#39393149">parent</a><span>|</span><a href="#39392667">next</a><span>|</span><label class="collapse" for="c-39393506">[-]</label><label class="expand" for="c-39393506">[4 more]</label></div><br/><div class="children"><div class="content">This is false in every sense for <a href="https:&#x2F;&#x2F;www.darwinsys.com&#x2F;file&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.darwinsys.com&#x2F;file&#x2F;</a> (probably the most used file version). It depends on the magic for a specific file, but it can check any part of your file. Many Linux distros are years out of date, you might be using a very old version.<p>FILE_45:<p><pre><code>    .&#x2F;src&#x2F;file -m magic&#x2F;magic.mgc ..&#x2F;..&#x2F;OpenCalc.v2.3.1.apk
    ..&#x2F;..&#x2F;OpenCalc.v2.3.1.apk: Android package (APK), with zipflinger virtual entry, with APK Signing Block</code></pre></div><br/><div id="39393644" class="c"><input type="checkbox" id="c-39393644" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#39392130">root</a><span>|</span><a href="#39393506">parent</a><span>|</span><a href="#39392667">next</a><span>|</span><label class="collapse" for="c-39393644">[-]</label><label class="expand" for="c-39393644">[3 more]</label></div><br/><div class="children"><div class="content">Interesting! I checked with file 5.44 from Ubuntu 23.10 and 5.45 on macOS using homebrew, and in both cases, I got “Zip archive data, at least v2.0 to extract” for the file here[1]. I don’t have an Android phone to check and I’m also not familiar with Android tooling, so is this a corrupt APK?<p>[1] <a href="https:&#x2F;&#x2F;download.apkpure.net&#x2F;custom&#x2F;com.apkpure.aegon-3197817.apk?_fn=QVBLUHVyZV92My4xOS43OF9hcGtwdXJlLmNvbS5hcGs&amp;as=952379a4c2cf139483a198906d30724d65cef794&amp;ai=-711161207&amp;at=1708062492&amp;_sa=ai%2Cat&amp;k=af2a27ab4a6fcef520110d64b356610d65d19a1c&amp;r=https%3A%2F%2Fapkpure.net%2Famp&amp;_p=Y29tLmFwa3B1cmUuYWVnb24&amp;c=1%7CTOOLS%7CZGV2PUFQS1B1cmUmdD1hcGsmcz0xMDQzMzgyNiZ2bj0zLjE5Ljc4JnZjPTMxOTc4MTc&amp;hot=1&amp;arg=apkpure%3A%2F%2Fcampaign%2F%3Futm_medium%3Dapkpure%26utm_source%3Dpre-register%26report_context%3D%7B%22channel_id%22%3A2007%2C%22source_package_name%22%3A%22com.levelinfinite.sgameGlobal%22%7D&amp;arg=apkpure%3A%2F%2Fcustom%3Ftype%3Dopen_detail%26package_name%3Dcom.levelinfinite.sgameGlobal%26auto_pre_register%3D1" rel="nofollow">https:&#x2F;&#x2F;download.apkpure.net&#x2F;custom&#x2F;com.apkpure.aegon-319781...</a></div><br/><div id="39393824" class="c"><input type="checkbox" id="c-39393824" checked=""/><div class="controls bullet"><span class="by">m0shen</span><span>|</span><a href="#39392130">root</a><span>|</span><a href="#39393644">parent</a><span>|</span><a href="#39392667">next</a><span>|</span><label class="collapse" for="c-39393824">[-]</label><label class="expand" for="c-39393824">[2 more]</label></div><br/><div class="children"><div class="content">That doesn&#x27;t appear to be a valid link. Try building `file` from source and using the provided default magic database.</div><br/><div id="39393909" class="c"><input type="checkbox" id="c-39393909" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#39392130">root</a><span>|</span><a href="#39393824">parent</a><span>|</span><a href="#39392667">next</a><span>|</span><label class="collapse" for="c-39393909">[-]</label><label class="expand" for="c-39393909">[1 more]</label></div><br/><div class="children"><div class="content">I also tried this with the sources of file from the homepage you linked above, and I still get the same results.<p>You could try this for yourself using the same APKPure file which I uploaded at the following alternative link[1]. Further, while this could be a corrupt APK, I can’t see any signs of that from a cursory inspection as both the `classes.dex` and `META-INF` directory are present, and this is APKPure’s own APK, instead of an APK contributed for an app contributed by a third-party.<p>[1] <a href="https:&#x2F;&#x2F;wormhole.app&#x2F;Mebmy#CDv86juV9H4aRCL2DSJeDw" rel="nofollow">https:&#x2F;&#x2F;wormhole.app&#x2F;Mebmy#CDv86juV9H4aRCL2DSJeDw</a></div><br/></div></div></div></div></div></div></div></div></div></div><div id="39392667" class="c"><input type="checkbox" id="c-39392667" checked=""/><div class="controls bullet"><span class="by">charcircuit</span><span>|</span><a href="#39392130">parent</a><span>|</span><a href="#39393149">prev</a><span>|</span><a href="#39394737">next</a><span>|</span><label class="collapse" for="c-39392667">[-]</label><label class="expand" for="c-39392667">[1 more]</label></div><br/><div class="children"><div class="content">apks are also zipaligned so it&#x27;s not like random users are going to be making them either</div><br/></div></div></div></div><div id="39394737" class="c"><input type="checkbox" id="c-39394737" checked=""/><div class="controls bullet"><span class="by">awaythrow999</span><span>|</span><a href="#39392130">prev</a><span>|</span><a href="#39399295">next</a><span>|</span><label class="collapse" for="c-39394737">[-]</label><label class="expand" for="c-39394737">[5 more]</label></div><br/><div class="children"><div class="content">Wonder how this would handle a polyglot[0][1], that is valid as a PDF document, a ZIP archive, and a Bash script that runs a Python webserver, which hosts
    Kaitai Struct’s WebIDE which, allowing you to view the file’s own annotated bytes.<p>[0]: <a href="https:&#x2F;&#x2F;www.alchemistowl.org&#x2F;pocorgtfo&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.alchemistowl.org&#x2F;pocorgtfo&#x2F;</a><p>[1]: <a href="https:&#x2F;&#x2F;www.alchemistowl.org&#x2F;pocorgtfo&#x2F;pocorgtfo16.pdf" rel="nofollow">https:&#x2F;&#x2F;www.alchemistowl.org&#x2F;pocorgtfo&#x2F;pocorgtfo16.pdf</a><p>Edit: just tested, and it does only identify the zip layer</div><br/><div id="39394787" class="c"><input type="checkbox" id="c-39394787" checked=""/><div class="controls bullet"><span class="by">rvnx</span><span>|</span><a href="#39394737">parent</a><span>|</span><a href="#39399295">next</a><span>|</span><label class="collapse" for="c-39394787">[-]</label><label class="expand" for="c-39394787">[4 more]</label></div><br/><div class="children"><div class="content">You can try it here:
<a href="https:&#x2F;&#x2F;google.github.io&#x2F;magika&#x2F;" rel="nofollow">https:&#x2F;&#x2F;google.github.io&#x2F;magika&#x2F;</a><p>It&#x27;s relatively limited compared to `file` (~10% coverage), it&#x27;s more like a specialized classificator for basic file formats, so such cases are really out-of-scope.<p>I guess it&#x27;s more for detecting common file formats then with high recall.<p>However, where is the actual source of the model ?
Let&#x27;s say I want to add a new file format myself.<p>Apparently only the source of the interpreter is here, not the source of the model nor the training set, which is the most important thing.</div><br/><div id="39395195" class="c"><input type="checkbox" id="c-39395195" checked=""/><div class="controls bullet"><span class="by">tempay</span><span>|</span><a href="#39394737">root</a><span>|</span><a href="#39394787">parent</a><span>|</span><a href="#39395656">next</a><span>|</span><label class="collapse" for="c-39395195">[-]</label><label class="expand" for="c-39395195">[1 more]</label></div><br/><div class="children"><div class="content">Is there anything about the performance on unknown files?<p>I&#x27;ve tried a few that aren&#x27;t &quot;basic&quot; but are widely used enough to be well supported in libmagic and it thinks they&#x27;re zip files. I know enough about the underlying formats to know they&#x27;re not using zip as a container under-the-hood.</div><br/></div></div><div id="39395656" class="c"><input type="checkbox" id="c-39395656" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#39394737">root</a><span>|</span><a href="#39394787">parent</a><span>|</span><a href="#39395195">prev</a><span>|</span><a href="#39394932">next</a><span>|</span><label class="collapse" for="c-39395656">[-]</label><label class="expand" for="c-39395656">[1 more]</label></div><br/><div class="children"><div class="content">Apparenty the Super Mario Bros. 3 ROM is 100% a SWF file.<p>Cool that you can use it online though. Might end up using it like that. Although it seems like it may focus on common formats.</div><br/></div></div><div id="39394932" class="c"><input type="checkbox" id="c-39394932" checked=""/><div class="controls bullet"><span class="by">alexandreyc</span><span>|</span><a href="#39394737">root</a><span>|</span><a href="#39394787">parent</a><span>|</span><a href="#39395656">prev</a><span>|</span><a href="#39399295">next</a><span>|</span><label class="collapse" for="c-39394932">[-]</label><label class="expand" for="c-39394932">[1 more]</label></div><br/><div class="children"><div class="content">Yes, I totally agree; it&#x27;s not what I would qualify as open source.<p>Do you plan to release the training code along the research paper? What about the dataset?<p>In any case, it&#x27;s very neat to have ML-based technique and lightweight model for such tasks!</div><br/></div></div></div></div></div></div><div id="39399295" class="c"><input type="checkbox" id="c-39399295" checked=""/><div class="controls bullet"><span class="by">YoshiRulz</span><span>|</span><a href="#39394737">prev</a><span>|</span><a href="#39393455">next</a><span>|</span><label class="collapse" for="c-39399295">[-]</label><label class="expand" for="c-39399295">[3 more]</label></div><br/><div class="children"><div class="content">So instead of spending some of their human resources to improve libmagic, they used some of their computing power to create an &quot;open source&quot; neural net, which is technically more accurate than the &quot;error-prone&quot; hand-written rules (ignoring that it supports far fewer filetypes), and which is much less effective in an adversarial context, and they want it to &quot;help other software improve their file identification accuracy,&quot; which of course it can&#x27;t since neural nets aren&#x27;t introspectable. Thanks guys.</div><br/><div id="39400868" class="c"><input type="checkbox" id="c-39400868" checked=""/><div class="controls bullet"><span class="by">og_kalu</span><span>|</span><a href="#39399295">parent</a><span>|</span><a href="#39400015">next</a><span>|</span><label class="collapse" for="c-39400868">[-]</label><label class="expand" for="c-39400868">[1 more]</label></div><br/><div class="children"><div class="content">&gt;So instead of spending some of their human resources to improve libmagic<p>A large megacorp can work on multiple things at once.<p>&gt;an &quot;open source&quot; neural net, which is technically more accurate than the &quot;error-prone&quot; hand-written rules (ignoring that it supports far fewer filetypes)<p>You say that like it&#x27;s a contradiction but it&#x27;s not.<p>&gt;and which is much less effective in an adversarial context,<p>Is it? This seems like an assumption.<p>&gt;and they want it to &quot;help other software improve their file identification accuracy,&quot; which of course it can&#x27;t since neural nets aren&#x27;t introspectable.<p>Being introspectable or not has no bearing on the accuracy of a system.</div><br/></div></div><div id="39400015" class="c"><input type="checkbox" id="c-39400015" checked=""/><div class="controls bullet"><span class="by">12_throw_away</span><span>|</span><a href="#39399295">parent</a><span>|</span><a href="#39400868">prev</a><span>|</span><a href="#39393455">next</a><span>|</span><label class="collapse" for="c-39400015">[-]</label><label class="expand" for="c-39400015">[1 more]</label></div><br/><div class="children"><div class="content">Come on, can&#x27;t you help but be impressed by this amazing AI tech? That gives us sci-fi tools like ... a less-accurate, incomplete, stochastic, un-debuggable, slower, electricity-guzzling version of `file`.</div><br/></div></div></div></div><div id="39393455" class="c"><input type="checkbox" id="c-39393455" checked=""/><div class="controls bullet"><span class="by">lopkeny12ko</span><span>|</span><a href="#39399295">prev</a><span>|</span><a href="#39391900">next</a><span>|</span><label class="collapse" for="c-39393455">[-]</label><label class="expand" for="c-39393455">[14 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t understand why this needs to exist. Isn&#x27;t file type detection inherently deterministic by nature? A valid tar archive will always have the same first few magic bytes. An ELF binary has a universal ELF magic and header. If the magic is bad, then the file is corrupted and not a valid XYZ file. What&#x27;s the value in throwing in &quot;heuristics&quot; and probabilistic inference into a process that is black and white by design.</div><br/><div id="39396025" class="c"><input type="checkbox" id="c-39396025" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#39393455">parent</a><span>|</span><a href="#39396367">next</a><span>|</span><label class="collapse" for="c-39396025">[-]</label><label class="expand" for="c-39396025">[2 more]</label></div><br/><div class="children"><div class="content">&gt; What&#x27;s the value in throwing in &quot;heuristics&quot; and probabilistic inference into a process that is black and white by design.<p>I use the <i>file</i> command all the time. The value is when you get this:<p><pre><code>    ... $  file somefile.xyz
    somefile.xyz: data
</code></pre>
AIUI from reading TFA, <i>magika</i> can determine more filetypes than what the <i>file</i> command can detect.<p>It&#x27;d actually be very easy to determine if there&#x27;s any value in <i>magika</i>: run <i>file</i> on every file on your filesystem and then for every file where the <i>file</i> command returns &quot;data&quot;, run <i>magika</i> and see if <i>magika</i> is right.<p>If it&#x27;s right, there&#x27;s your value.<p>P.S: it may also be easier to run on Windows than the file command? But then I can&#x27;t do much to help people who are on Windows.</div><br/><div id="39397390" class="c"><input type="checkbox" id="c-39397390" checked=""/><div class="controls bullet"><span class="by">Eiim</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39396025">parent</a><span>|</span><a href="#39396367">next</a><span>|</span><label class="collapse" for="c-39397390">[-]</label><label class="expand" for="c-39397390">[1 more]</label></div><br/><div class="children"><div class="content">From elsewhere in this thread, it appears that Magika detects far fewer file types than file (116 vs ~1600), which makes sense. For file, you just need to drop in a few rules to add a new, somewhat obscure type. An AI approach like Magika will need lots of training and test data for each new file type. Where Magika might have a leg up is with distinguishing different textual data files (i.e., source code), but I don&#x27;t see that as a particularly big use case honestly.</div><br/></div></div></div></div><div id="39396367" class="c"><input type="checkbox" id="c-39396367" checked=""/><div class="controls bullet"><span class="by">cle</span><span>|</span><a href="#39393455">parent</a><span>|</span><a href="#39396025">prev</a><span>|</span><a href="#39396865">next</a><span>|</span><label class="collapse" for="c-39396367">[-]</label><label class="expand" for="c-39396367">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not always deterministic, sometimes it&#x27;s fuzzy depending on the file type. Example of this is a one-line CSV file. I tested one case of that, libmagic detects it as a text file while magika correctly detects it as a CSV (and gives a confidence score, which is killer).</div><br/></div></div><div id="39396865" class="c"><input type="checkbox" id="c-39396865" checked=""/><div class="controls bullet"><span class="by">alkonaut</span><span>|</span><a href="#39393455">parent</a><span>|</span><a href="#39396367">prev</a><span>|</span><a href="#39394448">next</a><span>|</span><label class="collapse" for="c-39396865">[-]</label><label class="expand" for="c-39396865">[1 more]</label></div><br/><div class="children"><div class="content">But even with determinism, it&#x27;s not always right. It&#x27;s not too rare to find a text file with a byte order mark indicating UTF16 (0xFE 0xFF) but then actually containing utf-8. But what &quot;format&quot; does it have then? Is it UTF-8 or UTF-16? Same with e.g. a jar file missing a manifest. That&#x27;s just a zip, even though I&#x27;m sure some runtime might eat it.<p>But the question is when you have the issue of having to guess the format of a file? Is it when reverse engineering? Last time I did something like this was in the 90&#x27;s when trying to pick apart some texture from a directory of files called asset0001.k and it turns out it was a bitmap or whatever. Fun times.</div><br/></div></div><div id="39394448" class="c"><input type="checkbox" id="c-39394448" checked=""/><div class="controls bullet"><span class="by">vintermann</span><span>|</span><a href="#39393455">parent</a><span>|</span><a href="#39396865">prev</a><span>|</span><a href="#39393493">next</a><span>|</span><label class="collapse" for="c-39394448">[-]</label><label class="expand" for="c-39394448">[2 more]</label></div><br/><div class="children"><div class="content">Consider, it&#x27;s perfectly possible for a file to fit two or more file formats - polyglot files are a hobby for some people.<p>And there are also a billion formats that are <i>not</i> uniquely determined by magic bytes. You don&#x27;t have to go further than text files.</div><br/><div id="39395250" class="c"><input type="checkbox" id="c-39395250" checked=""/><div class="controls bullet"><span class="by">KOLANICH</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39394448">parent</a><span>|</span><a href="#39393493">next</a><span>|</span><label class="collapse" for="c-39395250">[-]</label><label class="expand" for="c-39395250">[1 more]</label></div><br/><div class="children"><div class="content">This tool doesn&#x27;t work this way.</div><br/></div></div></div></div><div id="39393493" class="c"><input type="checkbox" id="c-39393493" checked=""/><div class="controls bullet"><span class="by">potatoman22</span><span>|</span><a href="#39393455">parent</a><span>|</span><a href="#39394448">prev</a><span>|</span><a href="#39391900">next</a><span>|</span><label class="collapse" for="c-39393493">[-]</label><label class="expand" for="c-39393493">[7 more]</label></div><br/><div class="children"><div class="content">This also works for formats like Python, HTML, and JSON.</div><br/><div id="39397776" class="c"><input type="checkbox" id="c-39397776" checked=""/><div class="controls bullet"><span class="by">lopkeny12ko</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39393493">parent</a><span>|</span><a href="#39393642">next</a><span>|</span><label class="collapse" for="c-39397776">[-]</label><label class="expand" for="c-39397776">[1 more]</label></div><br/><div class="children"><div class="content">I still don&#x27;t see how this is useful. The only time I want to answer the question &quot;what type of file is this&quot; is if it is an opaque blob of binary data. If it&#x27;s a plain text file like Python, HTML, or JSON, I can figure that out by just catting the file.</div><br/></div></div><div id="39393642" class="c"><input type="checkbox" id="c-39393642" checked=""/><div class="controls bullet"><span class="by">LiamPowell</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39393493">parent</a><span>|</span><a href="#39397776">prev</a><span>|</span><a href="#39395529">next</a><span>|</span><label class="collapse" for="c-39393642">[-]</label><label class="expand" for="c-39393642">[4 more]</label></div><br/><div class="children"><div class="content">file (<a href="https:&#x2F;&#x2F;www.darwinsys.com&#x2F;file&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.darwinsys.com&#x2F;file&#x2F;</a>) already detects all these formats.</div><br/><div id="39393658" class="c"><input type="checkbox" id="c-39393658" checked=""/><div class="controls bullet"><span class="by">ebursztein</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39393642">parent</a><span>|</span><a href="#39395529">next</a><span>|</span><label class="collapse" for="c-39393658">[-]</label><label class="expand" for="c-39393658">[3 more]</label></div><br/><div class="children"><div class="content">Indeed but as pointed out in the blog post -- file is significantly less accurate that Magika. There are also some file type that we support and file doesn&#x27;t as reported in the table.</div><br/><div id="39393688" class="c"><input type="checkbox" id="c-39393688" checked=""/><div class="controls bullet"><span class="by">LiamPowell</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39393658">parent</a><span>|</span><a href="#39395529">next</a><span>|</span><label class="collapse" for="c-39393688">[-]</label><label class="expand" for="c-39393688">[2 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t immediately find the dataset used for benchmarking. Is file actually failing on common files or just particularly nasty examples? If it&#x27;s the latter then how does it compare to Magika on files that an average person is likely to see?</div><br/><div id="39393919" class="c"><input type="checkbox" id="c-39393919" checked=""/><div class="controls bullet"><span class="by">schleck8</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39393688">parent</a><span>|</span><a href="#39395529">next</a><span>|</span><label class="collapse" for="c-39393919">[-]</label><label class="expand" for="c-39393919">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Is file actually failing on common files or just particularly nasty examples? If it&#x27;s the latter then how does it compare to Magika on files that an average person is likely to see?<p>That&#x27;s not the point in file type guessing is it? Google employs it as an additional security measure for user submitted content which absolutely makes sense given what malware devs do with file types.</div><br/></div></div></div></div></div></div></div></div><div id="39395529" class="c"><input type="checkbox" id="c-39395529" checked=""/><div class="controls bullet"><span class="by">amelius</span><span>|</span><a href="#39393455">root</a><span>|</span><a href="#39393493">parent</a><span>|</span><a href="#39393642">prev</a><span>|</span><a href="#39391900">next</a><span>|</span><label class="collapse" for="c-39395529">[-]</label><label class="expand" for="c-39395529">[1 more]</label></div><br/><div class="children"><div class="content">Yes, but shouldn&#x27;t the file type be part of the file, or (better) of the metadata of the file?<p>Knowing is better than guessing.</div><br/></div></div></div></div></div></div><div id="39391900" class="c"><input type="checkbox" id="c-39391900" checked=""/><div class="controls bullet"><span class="by">thorum</span><span>|</span><a href="#39393455">prev</a><span>|</span><a href="#39391917">next</a><span>|</span><label class="collapse" for="c-39391900">[-]</label><label class="expand" for="c-39391900">[7 more]</label></div><br/><div class="children"><div class="content">Supported file types: <a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;main&#x2F;docs&#x2F;supported-content-types-list.md">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;main&#x2F;docs&#x2F;supported-co...</a></div><br/><div id="39392361" class="c"><input type="checkbox" id="c-39392361" checked=""/><div class="controls bullet"><span class="by">s1mon</span><span>|</span><a href="#39391900">parent</a><span>|</span><a href="#39391917">next</a><span>|</span><label class="collapse" for="c-39392361">[-]</label><label class="expand" for="c-39392361">[6 more]</label></div><br/><div class="children"><div class="content">It&#x27;s surprising that there are so many file types that seem relatively common which are missing from this list. There are no raw image file formats. There&#x27;s nothing for CAD - either source files or neutral files. There&#x27;s no MIDI files, or any other music creation types. There&#x27;s no APL, Pascal, COBOL, assembly source file formats etc.</div><br/><div id="39393849" class="c"><input type="checkbox" id="c-39393849" checked=""/><div class="controls bullet"><span class="by">photoGrant</span><span>|</span><a href="#39391900">root</a><span>|</span><a href="#39392361">parent</a><span>|</span><a href="#39395677">next</a><span>|</span><label class="collapse" for="c-39393849">[-]</label><label class="expand" for="c-39393849">[1 more]</label></div><br/><div class="children"><div class="content">Yeah this quickly went from &#x27;additional helpful tool in the kit&#x27; to &#x27;probably should use something else first&#x27;</div><br/></div></div><div id="39395677" class="c"><input type="checkbox" id="c-39395677" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#39391900">root</a><span>|</span><a href="#39392361">parent</a><span>|</span><a href="#39393849">prev</a><span>|</span><a href="#39394436">next</a><span>|</span><label class="collapse" for="c-39395677">[-]</label><label class="expand" for="c-39395677">[1 more]</label></div><br/><div class="children"><div class="content">Worse it seems that for unknown formats it confidently claims that it is one of the known formats. Rather than saying &quot;unknown&quot; or &quot;binary data&quot;.</div><br/></div></div><div id="39394436" class="c"><input type="checkbox" id="c-39394436" checked=""/><div class="controls bullet"><span class="by">vintermann</span><span>|</span><a href="#39391900">root</a><span>|</span><a href="#39392361">parent</a><span>|</span><a href="#39395677">prev</a><span>|</span><a href="#39392550">next</a><span>|</span><label class="collapse" for="c-39394436">[-]</label><label class="expand" for="c-39394436">[1 more]</label></div><br/><div class="children"><div class="content">Well, what they used this for at Google was apparently scanning their user&#x27;s files for things they shouldn&#x27;t store in the cloud. Probably they don&#x27;t care much about MIDI.</div><br/></div></div><div id="39392550" class="c"><input type="checkbox" id="c-39392550" checked=""/><div class="controls bullet"><span class="by">_3u10</span><span>|</span><a href="#39391900">root</a><span>|</span><a href="#39392361">parent</a><span>|</span><a href="#39394436">prev</a><span>|</span><a href="#39391917">next</a><span>|</span><label class="collapse" for="c-39392550">[-]</label><label class="expand" for="c-39392550">[2 more]</label></div><br/><div class="children"><div class="content">No tracker &#x2F; .mod files either, just use file.</div><br/><div id="39393664" class="c"><input type="checkbox" id="c-39393664" checked=""/><div class="controls bullet"><span class="by">ebursztein</span><span>|</span><a href="#39391900">root</a><span>|</span><a href="#39392550">parent</a><span>|</span><a href="#39391917">next</a><span>|</span><label class="collapse" for="c-39393664">[-]</label><label class="expand" for="c-39393664">[1 more]</label></div><br/><div class="children"><div class="content">Thanks for the list, we will probably try to extend the list of format supported in future revision.</div><br/></div></div></div></div></div></div></div></div><div id="39391917" class="c"><input type="checkbox" id="c-39391917" checked=""/><div class="controls bullet"><span class="by">vunderba</span><span>|</span><a href="#39391900">prev</a><span>|</span><a href="#39391843">next</a><span>|</span><label class="collapse" for="c-39391917">[-]</label><label class="expand" for="c-39391917">[1 more]</label></div><br/><div class="children"><div class="content">As somebody who&#x27;s dealt with the ambiguity of attempting to use file signatures in order to identify file type, this seems like a pretty useful library. Especially since it seems to be able to distinguish between different types of text files based on their format&#x2F;content e.g. CSV, markdown, etc.</div><br/></div></div><div id="39391843" class="c"><input type="checkbox" id="c-39391843" checked=""/><div class="controls bullet"><span class="by">NiloCK</span><span>|</span><a href="#39391917">prev</a><span>|</span><a href="#39403624">next</a><span>|</span><label class="collapse" for="c-39391843">[-]</label><label class="expand" for="c-39391843">[6 more]</label></div><br/><div class="children"><div class="content">A somewhat surprising and genuinely useful application of the family of techniques.<p>I wonder how susceptible it is to adversarial binaries or, hah, prompt-injected binaries.</div><br/><div id="39398167" class="c"><input type="checkbox" id="c-39398167" checked=""/><div class="controls bullet"><span class="by">nicklecompte</span><span>|</span><a href="#39391843">parent</a><span>|</span><a href="#39392632">next</a><span>|</span><label class="collapse" for="c-39398167">[-]</label><label class="expand" for="c-39398167">[1 more]</label></div><br/><div class="children"><div class="content">Elsewhere in the thread kevincox[1] points out that it&#x27;s extremely susceptible to adversarial binaries:<p>&gt; Worse it seems that for unknown formats it confidently claims that it is one of the known formats. Rather than saying &quot;unknown&quot; or &quot;binary data&quot;.<p>Seems like this is genuinely useless for anybody but AI researchers.<p>[1] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39395677">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39395677</a></div><br/></div></div><div id="39392632" class="c"><input type="checkbox" id="c-39392632" checked=""/><div class="controls bullet"><span class="by">jamesdwilson</span><span>|</span><a href="#39391843">parent</a><span>|</span><a href="#39398167">prev</a><span>|</span><a href="#39393317">next</a><span>|</span><label class="collapse" for="c-39392632">[-]</label><label class="expand" for="c-39392632">[1 more]</label></div><br/><div class="children"><div class="content">For the extremely limited number of file types supported, I question the utility of this compared to `magic`</div><br/></div></div><div id="39393317" class="c"><input type="checkbox" id="c-39393317" checked=""/><div class="controls bullet"><span class="by">star4040</span><span>|</span><a href="#39391843">parent</a><span>|</span><a href="#39392632">prev</a><span>|</span><a href="#39391864">next</a><span>|</span><label class="collapse" for="c-39393317">[-]</label><label class="expand" for="c-39393317">[2 more]</label></div><br/><div class="children"><div class="content">It gets a lot of binary file formats wrong for me out-of-the-box. I think it needs to be a bit more effective before we can truly determine the effectiveness of such exploits.</div><br/><div id="39404028" class="c"><input type="checkbox" id="c-39404028" checked=""/><div class="controls bullet"><span class="by">queuebert</span><span>|</span><a href="#39391843">root</a><span>|</span><a href="#39393317">parent</a><span>|</span><a href="#39391864">next</a><span>|</span><label class="collapse" for="c-39404028">[-]</label><label class="expand" for="c-39404028">[1 more]</label></div><br/><div class="children"><div class="content">But they reported &gt;99% accuracy on their cherry-picked dataset! &#x2F;s</div><br/></div></div></div></div><div id="39391864" class="c"><input type="checkbox" id="c-39391864" checked=""/><div class="controls bullet"><span class="by">dghlsakjg</span><span>|</span><a href="#39391843">parent</a><span>|</span><a href="#39393317">prev</a><span>|</span><a href="#39403624">next</a><span>|</span><label class="collapse" for="c-39391864">[-]</label><label class="expand" for="c-39391864">[1 more]</label></div><br/><div class="children"><div class="content">“These aren’t the binaries you are looking for…”</div><br/></div></div></div></div><div id="39403624" class="c"><input type="checkbox" id="c-39403624" checked=""/><div class="controls bullet"><span class="by">jjsimpso</span><span>|</span><a href="#39391843">prev</a><span>|</span><a href="#39402060">next</a><span>|</span><label class="collapse" for="c-39403624">[-]</label><label class="expand" for="c-39403624">[1 more]</label></div><br/><div class="children"><div class="content">I wrote an implementation of libmagic in Racket a few years ago(<a href="https:&#x2F;&#x2F;github.com&#x2F;jjsimpso&#x2F;magic">https:&#x2F;&#x2F;github.com&#x2F;jjsimpso&#x2F;magic</a>). File type identification is a pretty interesting topic.<p>As others have noted, libmagic detects many more file types than Magika, but I can see Magika being useful for text files in particular, because anything written by humans doesn&#x27;t have a rigid format.</div><br/></div></div><div id="39402060" class="c"><input type="checkbox" id="c-39402060" checked=""/><div class="controls bullet"><span class="by">woliveirajr</span><span>|</span><a href="#39403624">prev</a><span>|</span><a href="#39395925">next</a><span>|</span><label class="collapse" for="c-39402060">[-]</label><label class="expand" for="c-39402060">[1 more]</label></div><br/><div class="children"><div class="content">Reminds me when someone asked (at StackOverflow) on how to recognize binaries for different architetures, like x86 or ARM-something or Apple M1 and so on.<p>I gave the idea to use the technique of NCD (Normalized compression distance), based on Kolmogorov complexity. Celibrasi, R. was one great researcher in this area, and I think he worked at Google at some point.<p>Using AI seems to follow the same path: &quot;learn&quot; what represents some specific file and then compare the unknown file to those references (AI:all the parameters, NCD:compression against a known type).</div><br/></div></div><div id="39395925" class="c"><input type="checkbox" id="c-39395925" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#39402060">prev</a><span>|</span><a href="#39392004">next</a><span>|</span><label class="collapse" for="c-39395925">[-]</label><label class="expand" for="c-39395925">[2 more]</label></div><br/><div class="children"><div class="content">To me the obvious use case is to first use the <i>file</i> command but then, when <i>file</i> returns &quot;DATA&quot; (meaning it couldn&#x27;t guess the file type), call <i>magika</i>.<p>I guess I&#x27;ll be writing a wrapper (only for when using my shell in interactive mode) around <i>file</i> doing just that when I come back from vacation. I hate it when <i>file</i> cannot do its thing.<p>Put it this way: I use <i>file</i> a lot and I know at times it cannot detect a filetype. But is <i>file</i> often wrong when it does have a match? I don&#x27;t think so...<p>So in most of the cases I&#x27;d have <i>file</i> correctly give me the filetype, very quickly but then in those rare cases where <i>file</i> cannot find anything, I&#x27;d then use the slower but apparently more capable <i>magika</i>.</div><br/><div id="39401066" class="c"><input type="checkbox" id="c-39401066" checked=""/><div class="controls bullet"><span class="by">SnowflakeOnIce</span><span>|</span><a href="#39395925">parent</a><span>|</span><a href="#39392004">next</a><span>|</span><label class="collapse" for="c-39401066">[-]</label><label class="expand" for="c-39401066">[1 more]</label></div><br/><div class="children"><div class="content">I have seen &#x27;file&#x27; misclassify many things when running it at large scale (millions of files) from a hodgepodge of sources. Unrelated types getting called &#x27;GPG Private Keys&#x27;, for example.<p>For textual data types, &#x27;file&#x27; gets confused often, or doesn&#x27;t give a precise type. GitHub&#x27;s &#x27;linguist&#x27; [1] tool does much better here, but is structured in such a way that it is difficult to call it on an arbitrary file or bytestring that doesn&#x27;t reside in a git repo.<p>I&#x27;d love to have a classification tool that can more granularly classify textual files! It may not be Magika _today_ since it only supports 116-something types. For this use case, an ML-based approach will be more successful than an approach based solely on handwritten heuristic rules. I&#x27;m excited to see where this goes.</div><br/></div></div></div></div><div id="39392004" class="c"><input type="checkbox" id="c-39392004" checked=""/><div class="controls bullet"><span class="by">userbinator</span><span>|</span><a href="#39395925">prev</a><span>|</span><a href="#39402587">next</a><span>|</span><label class="collapse" for="c-39392004">[-]</label><label class="expand" for="c-39392004">[2 more]</label></div><br/><div class="children"><div class="content"><i>Today web browsers, code editors, and countless other software rely on file-type detection to decide how to properly render a file.</i><p>&quot;web browsers&quot;? Odd to see this coming from Google itself. <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Content_sniffing" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Content_sniffing</a> was widely criticised for being problematic for security.</div><br/><div id="39392559" class="c"><input type="checkbox" id="c-39392559" checked=""/><div class="controls bullet"><span class="by">rafram</span><span>|</span><a href="#39392004">parent</a><span>|</span><a href="#39402587">next</a><span>|</span><label class="collapse" for="c-39392559">[-]</label><label class="expand" for="c-39392559">[1 more]</label></div><br/><div class="children"><div class="content">Content sniffing can be disabled by the server (X-Content-Type-Options: nosniff),  but it’s still used by default. Web browsers have to assume that servers are stupid, and that for relatively harmless cases, it’s fine to e.g. render a PNG loaded by an &lt;img&gt; even if it’s served as text&#x2F;plain.</div><br/></div></div></div></div><div id="39402587" class="c"><input type="checkbox" id="c-39402587" checked=""/><div class="controls bullet"><span class="by">aidenn0</span><span>|</span><a href="#39392004">prev</a><span>|</span><a href="#39405548">next</a><span>|</span><label class="collapse" for="c-39402587">[-]</label><label class="expand" for="c-39402587">[2 more]</label></div><br/><div class="children"><div class="content">But will it let you print on Tuesday[1]?<p>1: <a href="https:&#x2F;&#x2F;bugs.launchpad.net&#x2F;ubuntu&#x2F;+source&#x2F;cupsys&#x2F;+bug&#x2F;255161&#x2F;comments&#x2F;28&#x2F;+index" rel="nofollow">https:&#x2F;&#x2F;bugs.launchpad.net&#x2F;ubuntu&#x2F;+source&#x2F;cupsys&#x2F;+bug&#x2F;255161...</a></div><br/><div id="39404036" class="c"><input type="checkbox" id="c-39404036" checked=""/><div class="controls bullet"><span class="by">queuebert</span><span>|</span><a href="#39402587">parent</a><span>|</span><a href="#39405548">next</a><span>|</span><label class="collapse" for="c-39404036">[-]</label><label class="expand" for="c-39404036">[1 more]</label></div><br/><div class="children"><div class="content">For a subscription fee.</div><br/></div></div></div></div><div id="39405548" class="c"><input type="checkbox" id="c-39405548" checked=""/><div class="controls bullet"><span class="by">runald</span><span>|</span><a href="#39402587">prev</a><span>|</span><a href="#39395513">next</a><span>|</span><label class="collapse" for="c-39405548">[-]</label><label class="expand" for="c-39405548">[1 more]</label></div><br/><div class="children"><div class="content">This is useful for detecting file types of unknown blobs with custom file extension, when the file command just returns data. Though it doesn&#x27;t correctly identify lua code for some reason, it guesses with low probability that it&#x27;s either ruby or javascript, or anything but lua.</div><br/></div></div><div id="39395513" class="c"><input type="checkbox" id="c-39395513" checked=""/><div class="controls bullet"><span class="by">20after4</span><span>|</span><a href="#39405548">prev</a><span>|</span><a href="#39393173">next</a><span>|</span><label class="collapse" for="c-39395513">[-]</label><label class="expand" for="c-39395513">[1 more]</label></div><br/><div class="children"><div class="content">I just want to say thank you for the release. There are quite a lot of complaints in the comments but I think this is a useful and worthwhile contribution and I appreciate the authors for going through the effort to get it approved for open source release.  It would be great if the model training data was included (or at lease documentation about how to reproduce it.) but that doesn’t preclude this being useful. Thanks!</div><br/></div></div><div id="39393173" class="c"><input type="checkbox" id="c-39393173" checked=""/><div class="controls bullet"><span class="by">krick</span><span>|</span><a href="#39395513">prev</a><span>|</span><a href="#39393413">next</a><span>|</span><label class="collapse" for="c-39393173">[-]</label><label class="expand" for="c-39393173">[5 more]</label></div><br/><div class="children"><div class="content">What are use-cases for this? I mean, obviously detecting the filetype is useful, but we kinda already have plenty of tools to do that, and I cannot imagine, why we need some &quot;smart&quot; way of doing this. If you are not a human, and you are not sure what is it (like, an unknown file being uploaded to a server) you would be better off just rejecting it completely, right? After all, there&#x27;s absolutely no way an &quot;AI powered&quot; tool can be more reliable than some dumb, err-on-safer-side heuristic, and you wouldn&#x27;t want to trust <i>that</i> thing to protect you from malicious payloads.</div><br/><div id="39393310" class="c"><input type="checkbox" id="c-39393310" checked=""/><div class="controls bullet"><span class="by">nindalf</span><span>|</span><a href="#39393173">parent</a><span>|</span><a href="#39393374">next</a><span>|</span><label class="collapse" for="c-39393310">[-]</label><label class="expand" for="c-39393310">[3 more]</label></div><br/><div class="children"><div class="content">&gt; no way an &quot;AI powered&quot; tool can be more reliable<p>The article provides accuracy benchmarks.<p>&gt; you would be better off just rejecting it completely<p>They mention using it in gmail and Drive, neither of which have the luxury of rejecting files willy-nilly.</div><br/><div id="39395906" class="c"><input type="checkbox" id="c-39395906" checked=""/><div class="controls bullet"><span class="by">fuzztester</span><span>|</span><a href="#39393173">root</a><span>|</span><a href="#39393310">parent</a><span>|</span><a href="#39393374">next</a><span>|</span><label class="collapse" for="c-39395906">[-]</label><label class="expand" for="c-39395906">[2 more]</label></div><br/><div class="children"><div class="content">I have not tried it recently, but IIRC, Gmail does reject attachments which are zip files, for security reasons.</div><br/><div id="39397559" class="c"><input type="checkbox" id="c-39397559" checked=""/><div class="controls bullet"><span class="by">wildrhythms</span><span>|</span><a href="#39393173">root</a><span>|</span><a href="#39395906">parent</a><span>|</span><a href="#39393374">next</a><span>|</span><label class="collapse" for="c-39397559">[-]</label><label class="expand" for="c-39397559">[1 more]</label></div><br/><div class="children"><div class="content">Gmail nukes zips if they contain an executable or some other &#x27;prohibited&#x27; file type. Most email providers block executable attachments.</div><br/></div></div></div></div></div></div><div id="39393374" class="c"><input type="checkbox" id="c-39393374" checked=""/><div class="controls bullet"><span class="by">n2d4</span><span>|</span><a href="#39393173">parent</a><span>|</span><a href="#39393310">prev</a><span>|</span><a href="#39393413">next</a><span>|</span><label class="collapse" for="c-39393374">[-]</label><label class="expand" for="c-39393374">[1 more]</label></div><br/><div class="children"><div class="content">Virus detection is mentioned in the article. Code editors need to find the programming language for syntax highlighting of code before you give it a name. Your desktop OS needs to know which program to open files with. Or, recovering files from a corrupted drive. Etc<p>It&#x27;s easy to distinguish, say, a PNG from a JPG file (or anything else that has well-defined magic bytes). But some files look virtually identical (eg. .jar files are really just .zip files). Also see polyglot files [1].<p>If you allow an `unknown` label or human intervention, then yes, magic bytes might be enough, but sometimes you&#x27;d rather have a 99% chance to be right about 95% of files vs. a 100% chance to be right about 50% of files.<p>[1] <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Polyglot_(computing)" rel="nofollow">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Polyglot_(computing)</a></div><br/></div></div></div></div><div id="39393413" class="c"><input type="checkbox" id="c-39393413" checked=""/><div class="controls bullet"><span class="by">VikingCoder</span><span>|</span><a href="#39393173">prev</a><span>|</span><a href="#39395422">next</a><span>|</span><label class="collapse" for="c-39393413">[-]</label><label class="expand" for="c-39393413">[2 more]</label></div><br/><div class="children"><div class="content">What does it do with an Actually Portable Executable compiled by Cosmopolitan libc compiler?</div><br/><div id="39393700" class="c"><input type="checkbox" id="c-39393700" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#39393413">parent</a><span>|</span><a href="#39395422">next</a><span>|</span><label class="collapse" for="c-39393700">[-]</label><label class="expand" for="c-39393700">[1 more]</label></div><br/><div class="children"><div class="content">It’s reported as a PE executable, `file` on the other hand reports it as a “DOS&#x2F;MBR boot sector.”</div><br/></div></div></div></div><div id="39395422" class="c"><input type="checkbox" id="c-39395422" checked=""/><div class="controls bullet"><span class="by">flohofwoe</span><span>|</span><a href="#39393413">prev</a><span>|</span><a href="#39392248">next</a><span>|</span><label class="collapse" for="c-39395422">[-]</label><label class="expand" for="c-39395422">[1 more]</label></div><br/><div class="children"><div class="content">I wonder how it performs with detecting C vs C++ vs ObjC vs ObjC++ and for bonus points: the common C&#x2F;C++ subset (which is an incompatible C fork), also extra bonus points for detecting language version compatibility (e.g. C89 vs C99 vs C11...).<p>Separating C from C++ and ObjC is where the file type detection on Github traditionally had problems with (but has been getting dramatically better over time), from an &quot;AI-powered&quot; solution which has been trained on the entire internet I would expect to do better right from the start.<p>The list here doesn&#x27;t even mention any of those languages except C though:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;main&#x2F;docs&#x2F;supported-content-types-list.md">https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;magika&#x2F;blob&#x2F;main&#x2F;docs&#x2F;supported-co...</a></div><br/></div></div><div id="39392248" class="c"><input type="checkbox" id="c-39392248" checked=""/><div class="controls bullet"><span class="by">vrnvu</span><span>|</span><a href="#39395422">prev</a><span>|</span><a href="#39400363">next</a><span>|</span><label class="collapse" for="c-39392248">[-]</label><label class="expand" for="c-39392248">[1 more]</label></div><br/><div class="children"><div class="content">At $job we have been using Apache Tika for years.<p>Works but occasionally having bugs and weird collisions when working with billions of files.<p>Happy to see new contributions in the space.</div><br/></div></div><div id="39400363" class="c"><input type="checkbox" id="c-39400363" checked=""/><div class="controls bullet"><span class="by">runxel</span><span>|</span><a href="#39392248">prev</a><span>|</span><a href="#39395599">next</a><span>|</span><label class="collapse" for="c-39400363">[-]</label><label class="expand" for="c-39400363">[2 more]</label></div><br/><div class="children"><div class="content">Took a .dxf file and fed it to Magika.  
It says with confidence of 97% that that must be a PowerShell file. A classic .dwg could be &quot;mscompress&quot; (whatever that is), 81%, or a GIF. Both couldn&#x27;t be further from the truth.<p>Common files are categorized successfully – but well, yeah that&#x27;s not really an achievement.  
Pretty much nothing more than a toy right now.</div><br/><div id="39404076" class="c"><input type="checkbox" id="c-39404076" checked=""/><div class="controls bullet"><span class="by">queuebert</span><span>|</span><a href="#39400363">parent</a><span>|</span><a href="#39395599">next</a><span>|</span><label class="collapse" for="c-39404076">[-]</label><label class="expand" for="c-39404076">[1 more]</label></div><br/><div class="children"><div class="content">The real problem with deep learning approaches is hallucination and edge case failures. When someone finally fixes this, I hope it makes the HN front page.</div><br/></div></div></div></div><div id="39395599" class="c"><input type="checkbox" id="c-39395599" checked=""/><div class="controls bullet"><span class="by">Andugal</span><span>|</span><a href="#39400363">prev</a><span>|</span><a href="#39394344">next</a><span>|</span><label class="collapse" for="c-39395599">[-]</label><label class="expand" for="c-39395599">[6 more]</label></div><br/><div class="children"><div class="content">I have a question: Is something like Magika enough to check if a file is malicious or not?<p>Example: users can upload PNG file (and only PNG is accepted).
If Malika detects that the file is a PNG, does this mean the file is clean?</div><br/><div id="39398298" class="c"><input type="checkbox" id="c-39398298" checked=""/><div class="controls bullet"><span class="by">nicklecompte</span><span>|</span><a href="#39395599">parent</a><span>|</span><a href="#39396064">next</a><span>|</span><label class="collapse" for="c-39398298">[-]</label><label class="expand" for="c-39398298">[1 more]</label></div><br/><div class="children"><div class="content">This comment from kevincox[1] says the answer is a hard &quot;no&quot;:<p>&gt; Worse it seems that for unknown formats it confidently claims that it is one of the known formats. Rather than saying &quot;unknown&quot; or &quot;binary data&quot;.<p>There are other comments in this thread that make me think Google contaminated their test data with training data and the 99% results should not be taken at face value. OTOH I am not particularly surprised that Magika would be better than the other tools at distinguishing <i>semi-unstructured plain text</i>  e.g. Java source vs. C++ source or YAMLs versus INIs. But that&#x27;s a very different use case than many security applications. The comments here suggest Magika is especially susceptible to binary obfuscation.<p>[1] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39395677">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=39395677</a></div><br/></div></div><div id="39396064" class="c"><input type="checkbox" id="c-39396064" checked=""/><div class="controls bullet"><span class="by">TacticalCoder</span><span>|</span><a href="#39395599">parent</a><span>|</span><a href="#39398298">prev</a><span>|</span><a href="#39400137">next</a><span>|</span><label class="collapse" for="c-39396064">[-]</label><label class="expand" for="c-39396064">[1 more]</label></div><br/><div class="children"><div class="content">If that PNG of yours is not just an example note that you can detect easily if the PNG as any extra data (which may or may not indicate an attempt as mischief) and reject the (rare) PNGs with extra data. I ran a script checking the thousands of PNGs on my system and found three with extra data, all three probably due to the &quot;PNG acropalypse&quot; bug (but mischief cannot be ruled out).<p>P.S: btw I&#x27;m not implying using extra data that shouldn&#x27;t be there in a PNG is the only way to have a malicious PNG.</div><br/></div></div><div id="39398441" class="c"><input type="checkbox" id="c-39398441" checked=""/><div class="controls bullet"><span class="by">kevincox</span><span>|</span><a href="#39395599">parent</a><span>|</span><a href="#39400137">prev</a><span>|</span><a href="#39395946">next</a><span>|</span><label class="collapse" for="c-39398441">[-]</label><label class="expand" for="c-39398441">[1 more]</label></div><br/><div class="children"><div class="content">The only way to do this reliably is to render the PNG to pixels then render it back to an PNG with a trusted encoder. Of course now you are taking the risk of vulnerabilities in the &quot;render to pixels&quot; step. But the result will be clean.<p>AKA parse, don&#x27;t validate.</div><br/></div></div><div id="39395946" class="c"><input type="checkbox" id="c-39395946" checked=""/><div class="controls bullet"><span class="by">cjg</span><span>|</span><a href="#39395599">parent</a><span>|</span><a href="#39398441">prev</a><span>|</span><a href="#39394344">next</a><span>|</span><label class="collapse" for="c-39395946">[-]</label><label class="expand" for="c-39395946">[1 more]</label></div><br/><div class="children"><div class="content">&gt; does this mean the file is clean?<p>No.</div><br/></div></div></div></div><div id="39394344" class="c"><input type="checkbox" id="c-39394344" checked=""/><div class="controls bullet"><span class="by">thangalin</span><span>|</span><a href="#39395599">prev</a><span>|</span><a href="#39401865">next</a><span>|</span><label class="collapse" for="c-39394344">[-]</label><label class="expand" for="c-39394344">[1 more]</label></div><br/><div class="children"><div class="content">My FOSS desktop text editor performs a subset of file type identification using the first 12 bytes, detecting the type quite quickly:<p>* <a href="https:&#x2F;&#x2F;gitlab.com&#x2F;DaveJarvis&#x2F;KeenWrite&#x2F;-&#x2F;blob&#x2F;main&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;keenwrite&#x2F;io&#x2F;MediaTypeSniffer.java" rel="nofollow">https:&#x2F;&#x2F;gitlab.com&#x2F;DaveJarvis&#x2F;KeenWrite&#x2F;-&#x2F;blob&#x2F;main&#x2F;src&#x2F;main...</a><p>There&#x27;s a much larger list of file signatures at:<p>* <a href="https:&#x2F;&#x2F;github.com&#x2F;veniware&#x2F;Space-Maker&#x2F;blob&#x2F;master&#x2F;FileSignatures.cs">https:&#x2F;&#x2F;github.com&#x2F;veniware&#x2F;Space-Maker&#x2F;blob&#x2F;master&#x2F;FileSign...</a></div><br/></div></div><div id="39401865" class="c"><input type="checkbox" id="c-39401865" checked=""/><div class="controls bullet"><span class="by">jwithington</span><span>|</span><a href="#39394344">prev</a><span>|</span><a href="#39393297">next</a><span>|</span><label class="collapse" for="c-39401865">[-]</label><label class="expand" for="c-39401865">[2 more]</label></div><br/><div class="children"><div class="content">I guess I&#x27;m kind of a dummy on this, but why is it impressive to identify that a .js file is Javascript, a .md file is Markdown, etc?</div><br/><div id="39402623" class="c"><input type="checkbox" id="c-39402623" checked=""/><div class="controls bullet"><span class="by">playingalong</span><span>|</span><a href="#39401865">parent</a><span>|</span><a href="#39393297">next</a><span>|</span><label class="collapse" for="c-39402623">[-]</label><label class="expand" for="c-39402623">[1 more]</label></div><br/><div class="children"><div class="content">Because it&#x27;s done by inspecting the content, not the name of the file.</div><br/></div></div></div></div><div id="39393297" class="c"><input type="checkbox" id="c-39393297" checked=""/><div class="controls bullet"><span class="by">star4040</span><span>|</span><a href="#39401865">prev</a><span>|</span><a href="#39395523">next</a><span>|</span><label class="collapse" for="c-39393297">[-]</label><label class="expand" for="c-39393297">[1 more]</label></div><br/><div class="children"><div class="content">It seems like it defeats the purpose of such a tool that this initial version doesn’t have polyglot files. I hope they’re quick to work on that.</div><br/></div></div><div id="39395523" class="c"><input type="checkbox" id="c-39395523" checked=""/><div class="controls bullet"><span class="by">Someone</span><span>|</span><a href="#39393297">prev</a><span>|</span><a href="#39393165">next</a><span>|</span><label class="collapse" for="c-39395523">[-]</label><label class="expand" for="c-39395523">[1 more]</label></div><br/><div class="children"><div class="content">If their “Exif Tool” is <a href="https:&#x2F;&#x2F;exiftool.org&#x2F;" rel="nofollow">https:&#x2F;&#x2F;exiftool.org&#x2F;</a> (what else could it be?), I don’t understand why they included it in their tests. Also, how does ExifTool recognize Python and html files?</div><br/></div></div><div id="39393165" class="c"><input type="checkbox" id="c-39393165" checked=""/><div class="controls bullet"><span class="by">Nullabillity</span><span>|</span><a href="#39395523">prev</a><span>|</span><a href="#39395148">next</a><span>|</span><label class="collapse" for="c-39393165">[-]</label><label class="expand" for="c-39393165">[1 more]</label></div><br/><div class="children"><div class="content">It seems to detect my Android build.gradle.kts as Scala, which I suppose is a kind of hilarious confusion but not exactly useful.</div><br/></div></div><div id="39395148" class="c"><input type="checkbox" id="c-39395148" checked=""/><div class="controls bullet"><span class="by">secondary_op</span><span>|</span><a href="#39393165">prev</a><span>|</span><label class="collapse" for="c-39395148">[-]</label><label class="expand" for="c-39395148">[2 more]</label></div><br/><div class="children"><div class="content">Why is this piece of code being sold as open source, when in reality it just calls into proprietary ML blob that is tiny and useless, and actual source code of model is closed while properly useful large model is non existing ?</div><br/><div id="39395239" class="c"><input type="checkbox" id="c-39395239" checked=""/><div class="controls bullet"><span class="by">KOLANICH</span><span>|</span><a href="#39395148">parent</a><span>|</span><label class="collapse" for="c-39395239">[-]</label><label class="expand" for="c-39395239">[1 more]</label></div><br/><div class="children"><div class="content">Not into proprietary, the blob is within an Apache-licensed repo. Though there was no code to train it, but the repo contains some info allowing to recreate the code training it. Basically a JSON-based configs containing graph architecture. Even if you didn&#x27;t have them, the repo contains an ONNX model, from which one can devise the architecture.</div><br/></div></div></div></div></div></div></div></div></div></body></html>