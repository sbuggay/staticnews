<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1699434060476" as="style"/><link rel="stylesheet" href="styles.css?v=1699434060476"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://ishan.page/blog/2023-11-06-jq-by-example/">Interactive examples for learning jq</a> <span class="domain">(<a href="https://ishan.page">ishan.page</a>)</span></div><div class="subtext"><span>ishandotpage</span> | <span>24 comments</span></div><br/><div><div id="38188120" class="c"><input type="checkbox" id="c-38188120" checked=""/><div class="controls bullet"><span class="by">jimmySixDOF</span><span>|</span><a href="#38187693">next</a><span>|</span><label class="collapse" for="c-38188120">[-]</label><label class="expand" for="c-38188120">[2 more]</label></div><br/><div class="children"><div class="content">It seems like jq is getting a nice boost due to how useful it is getting JSON into and out of OpenAI and LLM environments that understand jq.  The big new release&#x2F;relaunch shows the project is up and running again so maybe we see even more integration with Agent&#x2F;Function type use cases or some pydantic-ish guardrails.  Thanks for the Bookmark !<p><a href="https:&#x2F;&#x2F;github.com&#x2F;jqlang&#x2F;jq&#x2F;releases&#x2F;tag&#x2F;jq-1.7">https:&#x2F;&#x2F;github.com&#x2F;jqlang&#x2F;jq&#x2F;releases&#x2F;tag&#x2F;jq-1.7</a></div><br/><div id="38188136" class="c"><input type="checkbox" id="c-38188136" checked=""/><div class="controls bullet"><span class="by">ishandotpage</span><span>|</span><a href="#38188120">parent</a><span>|</span><a href="#38187693">next</a><span>|</span><label class="collapse" for="c-38188136">[-]</label><label class="expand" for="c-38188136">[1 more]</label></div><br/><div class="children"><div class="content">For getting JSON out of LLMs, I have found the Python library [dirtyjson](<a href="https:&#x2F;&#x2F;pypi.org&#x2F;project&#x2F;dirtyjson&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;pypi.org&#x2F;project&#x2F;dirtyjson&#x2F;</a>) to be quite useful.</div><br/></div></div></div></div><div id="38187693" class="c"><input type="checkbox" id="c-38187693" checked=""/><div class="controls bullet"><span class="by">zwischenzug</span><span>|</span><a href="#38188120">prev</a><span>|</span><a href="#38187792">next</a><span>|</span><label class="collapse" for="c-38187693">[-]</label><label class="expand" for="c-38187693">[7 more]</label></div><br/><div class="children"><div class="content">I started writing a book on jq, but realised it wasn&#x27;t really enough for a full book, so put it out as a series of blog posts:<p><a href="https:&#x2F;&#x2F;zwischenzugs.com&#x2F;2023&#x2F;06&#x2F;27&#x2F;learn-jq-the-hard-way-part-i-json&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;zwischenzugs.com&#x2F;2023&#x2F;06&#x2F;27&#x2F;learn-jq-the-hard-way-pa...</a><p>JQ really is the best kept secret in data.</div><br/><div id="38187706" class="c"><input type="checkbox" id="c-38187706" checked=""/><div class="controls bullet"><span class="by">ishandotpage</span><span>|</span><a href="#38187693">parent</a><span>|</span><a href="#38187784">prev</a><span>|</span><a href="#38187792">next</a><span>|</span><label class="collapse" for="c-38187706">[-]</label><label class="expand" for="c-38187706">[5 more]</label></div><br/><div class="children"><div class="content">Oh my - your series of blog posts come up regularly for me when googling jq things.</div><br/><div id="38187794" class="c"><input type="checkbox" id="c-38187794" checked=""/><div class="controls bullet"><span class="by">tarruda</span><span>|</span><a href="#38187693">root</a><span>|</span><a href="#38187706">parent</a><span>|</span><a href="#38187712">next</a><span>|</span><label class="collapse" for="c-38187794">[-]</label><label class="expand" for="c-38187794">[2 more]</label></div><br/><div class="children"><div class="content">I&#x27;m curious about this web page: Did you compile jq targeting WASI&#x2F;WASM to run an in-browser version?</div><br/><div id="38187817" class="c"><input type="checkbox" id="c-38187817" checked=""/><div class="controls bullet"><span class="by">ishandotpage</span><span>|</span><a href="#38187693">root</a><span>|</span><a href="#38187794">parent</a><span>|</span><a href="#38187712">next</a><span>|</span><label class="collapse" for="c-38187817">[-]</label><label class="expand" for="c-38187817">[1 more]</label></div><br/><div class="children"><div class="content">I am using <a href="https:&#x2F;&#x2F;github.com&#x2F;biowasm&#x2F;aioli">https:&#x2F;&#x2F;github.com&#x2F;biowasm&#x2F;aioli</a> which provides a already compiled wasm jq along with all the related support code for calling it</div><br/></div></div></div></div><div id="38187712" class="c"><input type="checkbox" id="c-38187712" checked=""/><div class="controls bullet"><span class="by">zwischenzug</span><span>|</span><a href="#38187693">root</a><span>|</span><a href="#38187706">parent</a><span>|</span><a href="#38187794">prev</a><span>|</span><a href="#38187792">next</a><span>|</span><label class="collapse" for="c-38187712">[-]</label><label class="expand" for="c-38187712">[2 more]</label></div><br/><div class="children"><div class="content">Haha, well, we should probably talk!</div><br/><div id="38187728" class="c"><input type="checkbox" id="c-38187728" checked=""/><div class="controls bullet"><span class="by">ishandotpage</span><span>|</span><a href="#38187693">root</a><span>|</span><a href="#38187712">parent</a><span>|</span><a href="#38187792">next</a><span>|</span><label class="collapse" for="c-38187728">[-]</label><label class="expand" for="c-38187728">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll shoot you an email after work</div><br/></div></div></div></div></div></div></div></div><div id="38187792" class="c"><input type="checkbox" id="c-38187792" checked=""/><div class="controls bullet"><span class="by">zmmmmm</span><span>|</span><a href="#38187693">prev</a><span>|</span><a href="#38187018">next</a><span>|</span><label class="collapse" for="c-38187792">[-]</label><label class="expand" for="c-38187792">[4 more]</label></div><br/><div class="children"><div class="content">For whatever reason jq is one tool that I simply can never remember the syntax for. It&#x27;s ChatGPT every time for me. I just can&#x27;t remember the specifics of how it differs from jsonpath vs jmespath (used by AWS) .... I wish there was a way for every tool to just use jsonpath instead.</div><br/><div id="38188082" class="c"><input type="checkbox" id="c-38188082" checked=""/><div class="controls bullet"><span class="by">pacha--</span><span>|</span><a href="#38187792">parent</a><span>|</span><a href="#38187940">next</a><span>|</span><label class="collapse" for="c-38188082">[-]</label><label class="expand" for="c-38188082">[1 more]</label></div><br/><div class="children"><div class="content">Not a 1:1 replacement, but I created <a href="https:&#x2F;&#x2F;github.com&#x2F;pacha&#x2F;cels">https:&#x2F;&#x2F;github.com&#x2F;pacha&#x2F;cels</a> because I wanted to have a more intuitive way of working with JSON and YAML files</div><br/></div></div><div id="38187940" class="c"><input type="checkbox" id="c-38187940" checked=""/><div class="controls bullet"><span class="by">reegnz</span><span>|</span><a href="#38187792">parent</a><span>|</span><a href="#38188082">prev</a><span>|</span><a href="#38187923">next</a><span>|</span><label class="collapse" for="c-38187940">[-]</label><label class="expand" for="c-38187940">[1 more]</label></div><br/><div class="children"><div class="content">JSONpath and jmespath are objectively worse than the jq language though, as you can only query, but jq also allows for very powerful transformations.<p>As for learning it, it&#x27;s the same with any tool, key is repetition and regular use.</div><br/></div></div><div id="38187923" class="c"><input type="checkbox" id="c-38187923" checked=""/><div class="controls bullet"><span class="by">navels</span><span>|</span><a href="#38187792">parent</a><span>|</span><a href="#38187940">prev</a><span>|</span><a href="#38187018">next</a><span>|</span><label class="collapse" for="c-38187923">[-]</label><label class="expand" for="c-38187923">[1 more]</label></div><br/><div class="children"><div class="content">This is my main usage of ChatGPT :-)</div><br/></div></div></div></div><div id="38187018" class="c"><input type="checkbox" id="c-38187018" checked=""/><div class="controls bullet"><span class="by">evgpbfhnr</span><span>|</span><a href="#38187792">prev</a><span>|</span><a href="#38187828">next</a><span>|</span><label class="collapse" for="c-38187018">[-]</label><label class="expand" for="c-38187018">[2 more]</label></div><br/><div class="children"><div class="content">I was curious so looked up how it works before reading the summary at the end, and that led me to find another user of aioli.js jq implementation: <a href="https:&#x2F;&#x2F;jiehong.gitlab.io&#x2F;jq_offline&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;jiehong.gitlab.io&#x2F;jq_offline&#x2F;</a> (featured <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=28627172">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=28627172</a> two years ago); jqplay.org still sends all the data on every modification so they should learn from it...<p>Anyway, this article is neat! Good work!<p>If I were to nitpick one of the last examples with path has no explanation and flew over my head (would have to open the documentation), and a reset button for each example might be nice after messing with it a bit, but it was a nice play.</div><br/><div id="38187063" class="c"><input type="checkbox" id="c-38187063" checked=""/><div class="controls bullet"><span class="by">ishandotpage</span><span>|</span><a href="#38187018">parent</a><span>|</span><a href="#38187828">next</a><span>|</span><label class="collapse" for="c-38187063">[-]</label><label class="expand" for="c-38187063">[1 more]</label></div><br/><div class="children"><div class="content">Hey, thanks for your kind words!<p>Regarding the reset button: I think that&#x27;s a great suggestion and now it bugs me so much that I can&#x27;t reset it. I&#x27;ll add a reset button later tonight when I&#x27;m off work.<p>Regarding the confusing example: Yes, some of the examples are missing explanations (mainly because I spent more than a month on this post and I just did not want to put off putting it out any longer). Sorry haha. I&#x27;ll try to improve the explanations and add more.</div><br/></div></div></div></div><div id="38187828" class="c"><input type="checkbox" id="c-38187828" checked=""/><div class="controls bullet"><span class="by">Calzifer</span><span>|</span><a href="#38187018">prev</a><span>|</span><a href="#38187926">next</a><span>|</span><label class="collapse" for="c-38187828">[-]</label><label class="expand" for="c-38187828">[1 more]</label></div><br/><div class="children"><div class="content">One feature I found very useful when using jq in Bash is the &quot;alternative operator&quot; &#x27;&#x2F;&#x2F;&#x27;.<p><pre><code>  result=$(echo &quot;$data&quot; | jq -r &#x27;.optional &#x2F;&#x2F; &quot;&quot;&#x27;)
  if [[ -n &quot;$result&quot; ]] ...
</code></pre>
feels more natural in Bash than<p><pre><code>  result=$(echo &quot;$data&quot; | jq -r &#x27;.optional&#x27;)
  if [[ &quot;$result&quot; != null ]] ...
</code></pre>
Especially if an empty field should be handled the same way.<p>And when using the raw-output option it helps with the ambiguity between &quot;null&quot; and null.</div><br/></div></div><div id="38187926" class="c"><input type="checkbox" id="c-38187926" checked=""/><div class="controls bullet"><span class="by">reegnz</span><span>|</span><a href="#38187828">prev</a><span>|</span><a href="#38187495">next</a><span>|</span><label class="collapse" for="c-38187926">[-]</label><label class="expand" for="c-38187926">[1 more]</label></div><br/><div class="children"><div class="content">Let me drop a link to my jq zsh plug-in:
<a href="https:&#x2F;&#x2F;github.com&#x2F;reegnz&#x2F;jq-zsh-plugin">https:&#x2F;&#x2F;github.com&#x2F;reegnz&#x2F;jq-zsh-plugin</a><p>I find the biggest problem with jq is that the feedback loop is not tight enough. With this jq-repl the expression is evaluated at every keystroke.</div><br/></div></div><div id="38187495" class="c"><input type="checkbox" id="c-38187495" checked=""/><div class="controls bullet"><span class="by">highmastdon</span><span>|</span><a href="#38187926">prev</a><span>|</span><a href="#38187546">next</a><span>|</span><label class="collapse" for="c-38187495">[-]</label><label class="expand" for="c-38187495">[2 more]</label></div><br/><div class="children"><div class="content">Great article. Nice to have it interactive. How does it work? Do you have a terminal running somewhere or does it run in the browser?<p>One thing I noticed, and where I stopped continuing, is that the jump from Filtering Nested Arrays to Flattening Nested JSON Objects, is WAAAY too big. From a simple filter to triple nested filters with keywords that had no introduction in a simpler example, isn’t working for me</div><br/><div id="38187517" class="c"><input type="checkbox" id="c-38187517" checked=""/><div class="controls bullet"><span class="by">jve</span><span>|</span><a href="#38187495">parent</a><span>|</span><a href="#38187546">next</a><span>|</span><label class="collapse" for="c-38187517">[-]</label><label class="expand" for="c-38187517">[1 more]</label></div><br/><div class="children"><div class="content">Seems he is using something called biowasm aioli: <a href="https:&#x2F;&#x2F;github.com&#x2F;biowasm&#x2F;aioli">https:&#x2F;&#x2F;github.com&#x2F;biowasm&#x2F;aioli</a><p>&gt; Aioli is a library for running genomics command-line tools in the browser using WebAssembly. See Who uses biowasm for example use cases.<p><a href="https:&#x2F;&#x2F;biowasm.com&#x2F;cdn&#x2F;v3&#x2F;jq&#x2F;1.6" rel="nofollow noreferrer">https:&#x2F;&#x2F;biowasm.com&#x2F;cdn&#x2F;v3&#x2F;jq&#x2F;1.6</a></div><br/></div></div></div></div><div id="38187546" class="c"><input type="checkbox" id="c-38187546" checked=""/><div class="controls bullet"><span class="by">dboreham</span><span>|</span><a href="#38187495">prev</a><span>|</span><a href="#38187295">next</a><span>|</span><label class="collapse" for="c-38187546">[-]</label><label class="expand" for="c-38187546">[1 more]</label></div><br/><div class="children"><div class="content">The one thing I would like to have the ChatGPT thing do for me.<p>(and regexes)</div><br/></div></div><div id="38187295" class="c"><input type="checkbox" id="c-38187295" checked=""/><div class="controls bullet"><span class="by">benatkin</span><span>|</span><a href="#38187546">prev</a><span>|</span><a href="#38187350">next</a><span>|</span><label class="collapse" for="c-38187295">[-]</label><label class="expand" for="c-38187295">[1 more]</label></div><br/><div class="children"><div class="content">I thought it must be gojq at first, it&#x27;s easy to forget about Emscripten when golang- and Rust-based WASM are gaining popularity<p>I looked at aoili briefly. I didn&#x27;t see how to reproduce the build.</div><br/></div></div><div id="38187350" class="c"><input type="checkbox" id="c-38187350" checked=""/><div class="controls bullet"><span class="by">ingoaf</span><span>|</span><a href="#38187295">prev</a><span>|</span><label class="collapse" for="c-38187350">[-]</label><label class="expand" for="c-38187350">[2 more]</label></div><br/><div class="children"><div class="content">Looks nice! Is there something similar for yq?</div><br/><div id="38187540" class="c"><input type="checkbox" id="c-38187540" checked=""/><div class="controls bullet"><span class="by">jrockway</span><span>|</span><a href="#38187350">parent</a><span>|</span><label class="collapse" for="c-38187540">[-]</label><label class="expand" for="c-38187540">[1 more]</label></div><br/><div class="children"><div class="content"><p><pre><code>    yaml2json | jq ...</code></pre></div><br/></div></div></div></div></div></div></div></div></div></body></html>