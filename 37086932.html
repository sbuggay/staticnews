<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1692003665494" as="style"/><link rel="stylesheet" href="styles.css?v=1692003665494"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://www.youtube.com/watch?v=HE71NqRpvTQ">Functional Programming in Modern C++: The Imperatives Must Go [video]</a> <span class="domain">(<a href="https://www.youtube.com">www.youtube.com</a>)</span></div><div class="subtext"><span>olvy0</span> | <span>24 comments</span></div><br/><div><div id="37116136" class="c"><input type="checkbox" id="c-37116136" checked=""/><div class="controls bullet"><span class="by">sakex</span><span>|</span><a href="#37117474">next</a><span>|</span><label class="collapse" for="c-37116136">[-]</label><label class="expand" for="c-37116136">[14 more]</label></div><br/><div class="children"><div class="content">I keep seeing claims that modern C++ is functional but that is simply untrue.<p>Most so called functional methods in the standard library require mutating the target (ie std::sort, std::transform, etc.) They are not ergonomic because we have to pass begin and end as arguments, which also means they cannot be chained.<p>Lambdas are hard to work with because it is difficult to track the lifetime of the values they borrow.<p>std::variant, std::visit, std::optional have a clunky interface. And because they are not part of the language, they often make it difficult to represent structures that would be trivial in languages with tagged enums (for instance a tree or a Linked List are difficult to model with std::variant or std::optional.) The compiler is also not able to assert that data is present in an option or that the correct variant is accessed.</div><br/><div id="37118870" class="c"><input type="checkbox" id="c-37118870" checked=""/><div class="controls bullet"><span class="by">krona</span><span>|</span><a href="#37116136">parent</a><span>|</span><a href="#37117376">next</a><span>|</span><label class="collapse" for="c-37118870">[-]</label><label class="expand" for="c-37118870">[1 more]</label></div><br/><div class="children"><div class="content">&gt; they are not ergonomic because we have to pass begin and end as arguments, which also means they cannot be chained.<p>C++20:<p><pre><code>  for (int i : ints | std::views::filter(even) | std::views::transform(square))
    std::cout &lt;&lt; i &lt;&lt; &#x27; &#x27;;</code></pre></div><br/></div></div><div id="37117376" class="c"><input type="checkbox" id="c-37117376" checked=""/><div class="controls bullet"><span class="by">zer8k</span><span>|</span><a href="#37116136">parent</a><span>|</span><a href="#37118870">prev</a><span>|</span><a href="#37116757">next</a><span>|</span><label class="collapse" for="c-37117376">[-]</label><label class="expand" for="c-37117376">[2 more]</label></div><br/><div class="children"><div class="content">People conflate &quot;functional programming&quot; with things like pure functions (for some definition of pure), lambdas, immutability, ADTs, etc.<p>Like many languages called &quot;functional&quot; (rust being one of them) they are not functional at all. However, they have enough uh...functional-ity that can be leveraged to create code that is sometimes easier to reason about. I don&#x27;t really understand the aversion to imperative programming. There&#x27;s certainly a level of cargo cult. Add to that the general difficulty of pure functional programming and now you&#x27;ve got a cult complete with it&#x27;s own ivory tower.<p>It&#x27;s once again a question to find the ultimate kitchen sink. C++, being one of the first kitchen sinks, doesn&#x27;t surprise me as the subject of this article.</div><br/><div id="37118821" class="c"><input type="checkbox" id="c-37118821" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37117376">parent</a><span>|</span><a href="#37116757">next</a><span>|</span><label class="collapse" for="c-37118821">[-]</label><label class="expand" for="c-37118821">[1 more]</label></div><br/><div class="children"><div class="content">That prize belongs to PL&#x2F;I and Algol 68, predating C++ for almost two decades, followed by Ada which in 1983 was definitly more complex than C++ Cfront, and had an additional revision (Ada95), before C++98 came to be.<p>Ironically Ada 202X might be easier to implement than C++23.</div><br/></div></div></div></div><div id="37116757" class="c"><input type="checkbox" id="c-37116757" checked=""/><div class="controls bullet"><span class="by">juunpp</span><span>|</span><a href="#37116136">parent</a><span>|</span><a href="#37117376">prev</a><span>|</span><a href="#37116771">next</a><span>|</span><label class="collapse" for="c-37116757">[-]</label><label class="expand" for="c-37116757">[5 more]</label></div><br/><div class="children"><div class="content">The style of code in this presentation will also result in insane build times. I can&#x27;t see FP taking off in C++ until it gets proper modules support; until then, it&#x27;s cursed by the O(N*M) nature of header compilation. And most of the projects I have worked on discourage or prohibit Boost, the STL, and heavy use of template code, for this and other reasons. I think there&#x27;s a large disconnect by the kind of code in these presentations and what people in the industry actually use.<p>I think wrapping stuff in std::function may also prevent inlining? I&#x27;m not sure how much link-time optimizations can help with that, but I&#x27;d guess languages like Haskell do better in this area.<p>Also, C++ doesn&#x27;t even have a function composition operator :&#x2F; The presentation starts off with &quot;function application is the essence of FP&quot;, but it&#x27;s really function composition. By his definition, C is a hell of an FP language.</div><br/><div id="37116926" class="c"><input type="checkbox" id="c-37116926" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37116757">parent</a><span>|</span><a href="#37116771">next</a><span>|</span><label class="collapse" for="c-37116926">[-]</label><label class="expand" for="c-37116926">[4 more]</label></div><br/><div class="children"><div class="content">&gt; I can&#x27;t see FP taking off in C++ until it gets proper modules support<p>Modules aren&#x27;t going to help with template instantiations.</div><br/><div id="37117750" class="c"><input type="checkbox" id="c-37117750" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37116926">parent</a><span>|</span><a href="#37117709">next</a><span>|</span><label class="collapse" for="c-37117750">[-]</label><label class="expand" for="c-37117750">[1 more]</label></div><br/><div class="children"><div class="content">They do in regards to parsing, semantic analysis, and keeping external templates around for common instations.</div><br/></div></div><div id="37117709" class="c"><input type="checkbox" id="c-37117709" checked=""/><div class="controls bullet"><span class="by">ender341341</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37116926">parent</a><span>|</span><a href="#37117750">prev</a><span>|</span><a href="#37116771">next</a><span>|</span><label class="collapse" for="c-37117709">[-]</label><label class="expand" for="c-37117709">[2 more]</label></div><br/><div class="children"><div class="content">they can, because now instead of having to re-instantiate std::vector&lt;int&gt; in every compilation unit it can just add it to the module&#x27;s compiled unit and pull it in from there. Basically finally delivering on the promise of `export template foo&lt;bar&gt;` that never materialized after c++98</div><br/><div id="37117749" class="c"><input type="checkbox" id="c-37117749" checked=""/><div class="controls bullet"><span class="by">dataflow</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37117709">parent</a><span>|</span><a href="#37116771">next</a><span>|</span><label class="collapse" for="c-37117749">[-]</label><label class="expand" for="c-37117749">[1 more]</label></div><br/><div class="children"><div class="content">Not sure I understand you correctly, but if I do, that has nothing to do with modules. If you already know what your template will be instantiated with (which is rare and hardly going to make a dent here), you can already just do extern template ... in a .h file you #include, and then explicitly instantiate it in some .cpp file. The problem (particularly for &quot;functional programming&quot; purposes) is that you don&#x27;t generally have the template arguments available in advance; they&#x27;re different for each client. See for example all the lambdas passed to algorithms like std::find_if(). So this isn&#x27;t going to get you anywhere, practically speaking.</div><br/></div></div></div></div></div></div></div></div><div id="37116771" class="c"><input type="checkbox" id="c-37116771" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#37116136">parent</a><span>|</span><a href="#37116757">prev</a><span>|</span><a href="#37118668">next</a><span>|</span><label class="collapse" for="c-37116771">[-]</label><label class="expand" for="c-37116771">[3 more]</label></div><br/><div class="children"><div class="content">It seems like the most strident FP enthusiasts don&#x27;t use (or use and don&#x27;t like) actual functional languages so are always looking for somewhere else to go.<p>Meanwhile while actual F programmers, and the developers of non-FP languages that receive these claims (like Lisp or C++) aren&#x27;t interested in making these kinds claims.<p>It&#x27;s fandom.</div><br/><div id="37117776" class="c"><input type="checkbox" id="c-37117776" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37116771">parent</a><span>|</span><a href="#37116890">next</a><span>|</span><label class="collapse" for="c-37117776">[-]</label><label class="expand" for="c-37117776">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, it is like there was no FP until Miranda and Haskell came to be.</div><br/></div></div><div id="37116890" class="c"><input type="checkbox" id="c-37116890" checked=""/><div class="controls bullet"><span class="by">dboreham</span><span>|</span><a href="#37116136">root</a><span>|</span><a href="#37116771">parent</a><span>|</span><a href="#37117776">prev</a><span>|</span><a href="#37118668">next</a><span>|</span><label class="collapse" for="c-37116890">[-]</label><label class="expand" for="c-37116890">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a cult.</div><br/></div></div></div></div><div id="37118668" class="c"><input type="checkbox" id="c-37118668" checked=""/><div class="controls bullet"><span class="by">Rexxar</span><span>|</span><a href="#37116136">parent</a><span>|</span><a href="#37116771">prev</a><span>|</span><a href="#37117758">next</a><span>|</span><label class="collapse" for="c-37118668">[-]</label><label class="expand" for="c-37118668">[1 more]</label></div><br/><div class="children"><div class="content">The meaning of &quot;functional programming&quot; has changed with time. &quot;functional programming&quot; is now often used for what was called &quot;pure functional programming&quot; before. They just use the older and less restrictive definition.</div><br/></div></div><div id="37117758" class="c"><input type="checkbox" id="c-37117758" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37116136">parent</a><span>|</span><a href="#37118668">prev</a><span>|</span><a href="#37117474">next</a><span>|</span><label class="collapse" for="c-37117758">[-]</label><label class="expand" for="c-37117758">[1 more]</label></div><br/><div class="children"><div class="content">Haskell is not the definition of FP, rather one possible approach.</div><br/></div></div></div></div><div id="37117474" class="c"><input type="checkbox" id="c-37117474" checked=""/><div class="controls bullet"><span class="by">naruhodo</span><span>|</span><a href="#37116136">prev</a><span>|</span><a href="#37116847">next</a><span>|</span><label class="collapse" for="c-37117474">[-]</label><label class="expand" for="c-37117474">[3 more]</label></div><br/><div class="children"><div class="content">I quite like the <i>option</i> of being able to program in a more functional style in C++. If you have the cycles to spare, or a <i>sufficiently smart compiler</i> and it allows you to say more with fewer keystrokes and better readability then why not?<p>I haven&#x27;t used it yet, but C++ Streams[1] is a header-only library that appears to have great ergonomics and an API that will feel familiar for those who know Java Streams. Since I haven&#x27;t had the luxury of being able to use C++20 yet, I was unfamiliar with the ranges library. Starting at 1:06:00 you can see some motivating examples for those and they look great to me. Much easier to read than the equivalent STL.<p>The libraries mentioned in the video TartanLlama&#x2F;optional[2] and TartanLlama&#x2F;expected[3] clearly demonstrate the value proposition (brevity and clarity) on their github pages.<p>[1] <a href="http:&#x2F;&#x2F;jscheiny.github.io&#x2F;Streams&#x2F;" rel="nofollow noreferrer">http:&#x2F;&#x2F;jscheiny.github.io&#x2F;Streams&#x2F;</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;TartanLlama&#x2F;optional">https:&#x2F;&#x2F;github.com&#x2F;TartanLlama&#x2F;optional</a><p>[3] <a href="https:&#x2F;&#x2F;github.com&#x2F;TartanLlama&#x2F;expected">https:&#x2F;&#x2F;github.com&#x2F;TartanLlama&#x2F;expected</a></div><br/><div id="37118027" class="c"><input type="checkbox" id="c-37118027" checked=""/><div class="controls bullet"><span class="by">59nadir</span><span>|</span><a href="#37117474">parent</a><span>|</span><a href="#37116847">next</a><span>|</span><label class="collapse" for="c-37118027">[-]</label><label class="expand" for="c-37118027">[2 more]</label></div><br/><div class="children"><div class="content">In practice a lot of the supposed &quot;more readable&quot; code in FP style isn&#x27;t actually more readable, it&#x27;s mostly leaky abstractions you&#x27;ll most likely want to get rid of if you want to know what code is actually doing or you need to change it.</div><br/><div id="37118318" class="c"><input type="checkbox" id="c-37118318" checked=""/><div class="controls bullet"><span class="by">qayxc</span><span>|</span><a href="#37117474">root</a><span>|</span><a href="#37118027">parent</a><span>|</span><a href="#37116847">next</a><span>|</span><label class="collapse" for="c-37118318">[-]</label><label class="expand" for="c-37118318">[1 more]</label></div><br/><div class="children"><div class="content">I concur. The most funny part to me is always when an elegant and succinct one or two-liner in Haskell turns into a mess once proper error-handling is added.<p>Complexity doesn&#x27;t magically go away by choosing a different programming paradigm - problems are just shifted into another direction.</div><br/></div></div></div></div></div></div><div id="37116847" class="c"><input type="checkbox" id="c-37116847" checked=""/><div class="controls bullet"><span class="by">up2isomorphism</span><span>|</span><a href="#37117474">prev</a><span>|</span><a href="#37116350">next</a><span>|</span><label class="collapse" for="c-37116847">[-]</label><label class="expand" for="c-37116847">[2 more]</label></div><br/><div class="children"><div class="content">Essentially all these “modern” things steal the idea from 2 old things: Unix and APL&#x2F;K. Except the taste is not nearly as good.</div><br/><div id="37117779" class="c"><input type="checkbox" id="c-37117779" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37116847">parent</a><span>|</span><a href="#37116350">next</a><span>|</span><label class="collapse" for="c-37117779">[-]</label><label class="expand" for="c-37117779">[1 more]</label></div><br/><div class="children"><div class="content">Given the UNIX haters handbook, taste is debatable.</div><br/></div></div></div></div><div id="37116350" class="c"><input type="checkbox" id="c-37116350" checked=""/><div class="controls bullet"><span class="by">FpUser</span><span>|</span><a href="#37116847">prev</a><span>|</span><label class="collapse" for="c-37116350">[-]</label><label class="expand" for="c-37116350">[4 more]</label></div><br/><div class="children"><div class="content">&gt;&quot;The Imperatives Must Go&quot;<p>What must go are the holy warriors who are stuck on their dogma and do not realize that the world does not fit into their heads.</div><br/><div id="37118632" class="c"><input type="checkbox" id="c-37118632" checked=""/><div class="controls bullet"><span class="by">JohnKemeny</span><span>|</span><a href="#37116350">parent</a><span>|</span><a href="#37116749">next</a><span>|</span><label class="collapse" for="c-37118632">[-]</label><label class="expand" for="c-37118632">[1 more]</label></div><br/><div class="children"><div class="content">I think it&#x27;s a nod to the gem Execution in the Kingdom of Nouns.<p><a href="https:&#x2F;&#x2F;steve-yegge.blogspot.com&#x2F;2006&#x2F;03&#x2F;execution-in-kingdom-of-nouns.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;steve-yegge.blogspot.com&#x2F;2006&#x2F;03&#x2F;execution-in-kingdo...</a></div><br/></div></div><div id="37116749" class="c"><input type="checkbox" id="c-37116749" checked=""/><div class="controls bullet"><span class="by">gumby</span><span>|</span><a href="#37116350">parent</a><span>|</span><a href="#37118632">prev</a><span>|</span><a href="#37116805">next</a><span>|</span><label class="collapse" for="c-37116749">[-]</label><label class="expand" for="c-37116749">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a funny title for a talk about FP, that&#x27;s all.<p>Unless you&#x27;re arguing that converts to the FP religion feel an...<i>imperative</i> to convert others...</div><br/></div></div></div></div></div></div></div></div></div></body></html>