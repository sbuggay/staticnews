<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1704099666227" as="style"/><link rel="stylesheet" href="styles.css?v=1704099666227"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://proxy.incolumitas.com/proxy_detect.html">Live proxy and VPN detection</a> <span class="domain">(<a href="https://proxy.incolumitas.com">proxy.incolumitas.com</a>)</span></div><div class="subtext"><span>cacher</span> | <span>38 comments</span></div><br/><div><div id="38829654" class="c"><input type="checkbox" id="c-38829654" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38830189">next</a><span>|</span><label class="collapse" for="c-38829654">[-]</label><label class="expand" for="c-38829654">[7 more]</label></div><br/><div class="children"><div class="content">&gt; This website can detect if your connection is using a Proxy or VPN.<p>Empirically not.<p>&gt; You can add Proxy and VPN detection to your own Website or App.<p>Please don&#x27;t. Not just because of the false positives and false negatives, but because user privacy is actually a good thing.</div><br/><div id="38829724" class="c"><input type="checkbox" id="c-38829724" checked=""/><div class="controls bullet"><span class="by">gruez</span><span>|</span><a href="#38829654">parent</a><span>|</span><a href="#38830189">next</a><span>|</span><label class="collapse" for="c-38829724">[-]</label><label class="expand" for="c-38829724">[6 more]</label></div><br/><div class="children"><div class="content">&gt;Please don&#x27;t. Not just because of the false positives and false negatives, but because user privacy is actually a good thing.<p>Like it or not, bad actors use VPNs as well, and for some businesses the adverse selection caused by VPNs basically makes banning VPNs a no-brainer (eg. due to fraud).</div><br/><div id="38830438" class="c"><input type="checkbox" id="c-38830438" checked=""/><div class="controls bullet"><span class="by">dragoncrab</span><span>|</span><a href="#38829654">root</a><span>|</span><a href="#38829724">parent</a><span>|</span><a href="#38829864">next</a><span>|</span><label class="collapse" for="c-38830438">[-]</label><label class="expand" for="c-38830438">[1 more]</label></div><br/><div class="children"><div class="content">All the big corps I ever worked for had their devices configured to go through the central VPN and proxy even for browsing.<p>But I guess blocking $$$ corporate visitors should be fine by you as well.</div><br/></div></div><div id="38829864" class="c"><input type="checkbox" id="c-38829864" checked=""/><div class="controls bullet"><span class="by">tomxor</span><span>|</span><a href="#38829654">root</a><span>|</span><a href="#38829724">parent</a><span>|</span><a href="#38830438">prev</a><span>|</span><a href="#38829745">next</a><span>|</span><label class="collapse" for="c-38829864">[-]</label><label class="expand" for="c-38829864">[1 more]</label></div><br/><div class="children"><div class="content">Like it or not bad actors also do not use VPNs, so best to block the internet entirely from your site - There are so many bad actors it will probably be worth blocking the handful of legitimate users don&#x27;t worry ;)<p>The optimal amount of fraud is non-zero.<p>Also in an age of CGNAT, state enforced ISP level tracking and blocking. Blocking at the IP level is just lazy. It&#x27;s like blocking a person because they come from the same town as someone else.</div><br/></div></div><div id="38829745" class="c"><input type="checkbox" id="c-38829745" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38829654">root</a><span>|</span><a href="#38829724">parent</a><span>|</span><a href="#38829864">prev</a><span>|</span><a href="#38830189">next</a><span>|</span><label class="collapse" for="c-38829745">[-]</label><label class="expand" for="c-38829745">[3 more]</label></div><br/><div class="children"><div class="content">Ethically: Bad actors use a lot of things; that&#x27;s a poor excuse for harming the innocent.<p>Practically: The economics probably check out, but bear in mind that it&#x27;s not one-sided; this will cost you legitimate users.</div><br/><div id="38829846" class="c"><input type="checkbox" id="c-38829846" checked=""/><div class="controls bullet"><span class="by">grepfru_it</span><span>|</span><a href="#38829654">root</a><span>|</span><a href="#38829745">parent</a><span>|</span><a href="#38830189">next</a><span>|</span><label class="collapse" for="c-38829846">[-]</label><label class="expand" for="c-38829846">[2 more]</label></div><br/><div class="children"><div class="content">If the cost of fraud this stops is more than the lost cost of legitimate users..</div><br/><div id="38829932" class="c"><input type="checkbox" id="c-38829932" checked=""/><div class="controls bullet"><span class="by">WarOnPrivacy</span><span>|</span><a href="#38829654">root</a><span>|</span><a href="#38829846">parent</a><span>|</span><a href="#38830189">next</a><span>|</span><label class="collapse" for="c-38829932">[-]</label><label class="expand" for="c-38829932">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t seem this impacting fraud in any meaningful way. The cost advantage would be in reducing bandwidth consumed by bots.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="38830189" class="c"><input type="checkbox" id="c-38830189" checked=""/><div class="controls bullet"><span class="by">anjel</span><span>|</span><a href="#38829654">prev</a><span>|</span><a href="#38829790">next</a><span>|</span><label class="collapse" for="c-38830189">[-]</label><label class="expand" for="c-38830189">[1 more]</label></div><br/><div class="children"><div class="content">On a commercial VPN, and this site completely failed to detect it. I&#x27;d tell you which VPN company I&#x27;m using but yours is not the type of cause I can support.<p>My connection is my concern and not yours. If bad actors use VPNs while exploiting your site&#x27;s vulnerable processes, its your concern and not mine.</div><br/></div></div><div id="38829790" class="c"><input type="checkbox" id="c-38829790" checked=""/><div class="controls bullet"><span class="by">elwebmaster</span><span>|</span><a href="#38830189">prev</a><span>|</span><a href="#38829536">next</a><span>|</span><label class="collapse" for="c-38829790">[-]</label><label class="expand" for="c-38829790">[1 more]</label></div><br/><div class="children"><div class="content">OP, I am sure you have the best intentions in mind but I hope you can see for the comments that what you are trying to do is a bad idea. You will never get it perfect, you will lose a ton of business for no reason (for example: because the customer was an Apple user, guess what: most paying customers are) and you will gain a false sense of security that you are preventing malicious traffic. Just focus on bot detection and tried methods such as credit card or cellphone verification.</div><br/></div></div><div id="38829536" class="c"><input type="checkbox" id="c-38829536" checked=""/><div class="controls bullet"><span class="by">SushiHippie</span><span>|</span><a href="#38829790">prev</a><span>|</span><a href="#38830221">next</a><span>|</span><label class="collapse" for="c-38829536">[-]</label><label class="expand" for="c-38829536">[2 more]</label></div><br/><div class="children"><div class="content">Mullvad VPN location set to Frankfurt germany<p>Using the us east test server:<p>Proxy Score: 10&#x2F;100 - Very likely not a Proxy<p>VPN Score: 0&#x2F;55 - Very likely not a VPN<p>Using german test server:<p>Proxy Score: 10&#x2F;100 - Very likely not a Proxy<p>VPN Score: 30&#x2F;55 - Very likely a VPN<p>The thing that changed between both tests was the  flow latencies vs ping latencies check. Clicking on more info it said: &quot;flow variance too large in relation to avg flow: 0.6937484181219945&quot;<p>I guess it works kinda, but not very consistent.<p>But e.g. <a href="https:&#x2F;&#x2F;ipinfo.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;ipinfo.io&#x2F;</a> reveals immediately that this IP is a VPN IP address.</div><br/><div id="38830502" class="c"><input type="checkbox" id="c-38830502" checked=""/><div class="controls bullet"><span class="by">WelcomeShorty</span><span>|</span><a href="#38829536">parent</a><span>|</span><a href="#38830221">next</a><span>|</span><label class="collapse" for="c-38830502">[-]</label><label class="expand" for="c-38830502">[1 more]</label></div><br/><div class="children"><div class="content">Cloudflare&#x27;s Warp:<p>Proxy Score: 55&#x2F;100 - Very likely a Proxy
VPN Score: 15&#x2F;55 - Could be a VPN (But Unlikely)
Client Score: no client threat<p>And ipinfo gives me:<p>privacy: Object,
vpn: false,
proxy: false,
tor: false,
relay: false,
hosting: true,
service: &quot;&quot;,</div><br/></div></div></div></div><div id="38830221" class="c"><input type="checkbox" id="c-38830221" checked=""/><div class="controls bullet"><span class="by">hysan</span><span>|</span><a href="#38829536">prev</a><span>|</span><a href="#38830386">next</a><span>|</span><label class="collapse" for="c-38830221">[-]</label><label class="expand" for="c-38830221">[1 more]</label></div><br/><div class="children"><div class="content">Didn’t detect that I was on a VPN. From the sounds of the other comments, this is quite unreliable? Without any sort of write-up, the submission seems pretty uninteresting and the discussion will probably be not worth reading.</div><br/></div></div><div id="38830386" class="c"><input type="checkbox" id="c-38830386" checked=""/><div class="controls bullet"><span class="by">buro9</span><span>|</span><a href="#38830221">prev</a><span>|</span><a href="#38830430">next</a><span>|</span><label class="collapse" for="c-38830386">[-]</label><label class="expand" for="c-38830386">[1 more]</label></div><br/><div class="children"><div class="content">Accessed via the Google One VPN and achieved 100% clean slate of &quot;not a VPN&quot;.<p>So tried several other VPNs that should be detected, none were<p>Perhaps using Firefox breaks this site?</div><br/></div></div><div id="38830430" class="c"><input type="checkbox" id="c-38830430" checked=""/><div class="controls bullet"><span class="by">dragoncrab</span><span>|</span><a href="#38830386">prev</a><span>|</span><a href="#38829986">next</a><span>|</span><label class="collapse" for="c-38830430">[-]</label><label class="expand" for="c-38830430">[1 more]</label></div><br/><div class="children"><div class="content">Have visited the site through my self hosted OpenVPN tunnel and got 0 for both the VPN and proxy score.</div><br/></div></div><div id="38829986" class="c"><input type="checkbox" id="c-38829986" checked=""/><div class="controls bullet"><span class="by">geuis</span><span>|</span><a href="#38830430">prev</a><span>|</span><a href="#38829916">next</a><span>|</span><label class="collapse" for="c-38829986">[-]</label><label class="expand" for="c-38829986">[1 more]</label></div><br/><div class="children"><div class="content">This isn&#x27;t accurate at all. From my iPhone with no vpn it says I&#x27;m on a vpn and a proxy. This changes each time I refresh the page.</div><br/></div></div><div id="38829916" class="c"><input type="checkbox" id="c-38829916" checked=""/><div class="controls bullet"><span class="by">1vuio0pswjnm7</span><span>|</span><a href="#38829986">prev</a><span>|</span><a href="#38829771">next</a><span>|</span><label class="collapse" for="c-38829916">[-]</label><label class="expand" for="c-38829916">[1 more]</label></div><br/><div class="children"><div class="content">&quot;This website can detect if your connection is using a Proxy or VPN.&quot;<p>If you run someone else&#x27;s Javascript.<p>Yeah, there is lots someone can detect if you run their Javascript.</div><br/></div></div><div id="38829771" class="c"><input type="checkbox" id="c-38829771" checked=""/><div class="controls bullet"><span class="by">largbae</span><span>|</span><a href="#38829916">prev</a><span>|</span><a href="#38829929">next</a><span>|</span><label class="collapse" for="c-38829771">[-]</label><label class="expand" for="c-38829771">[1 more]</label></div><br/><div class="children"><div class="content">I use Tailscale with an exit node to proxy my traffic through my home connection. This is undetected even though I am about 500 miles from home.</div><br/></div></div><div id="38829929" class="c"><input type="checkbox" id="c-38829929" checked=""/><div class="controls bullet"><span class="by">sqidyyy</span><span>|</span><a href="#38829771">prev</a><span>|</span><a href="#38829487">next</a><span>|</span><label class="collapse" for="c-38829929">[-]</label><label class="expand" for="c-38829929">[1 more]</label></div><br/><div class="children"><div class="content">arkenfox, No VPN:<p>Proxy Score: 45&#x2F;100 - Likely a Proxy
VPN Score: 15&#x2F;55 - Could be a VPN (But Unlikely)<p>Service sure does assume a lot of things.</div><br/></div></div><div id="38829487" class="c"><input type="checkbox" id="c-38829487" checked=""/><div class="controls bullet"><span class="by">xnx</span><span>|</span><a href="#38829929">prev</a><span>|</span><a href="#38829606">next</a><span>|</span><label class="collapse" for="c-38829487">[-]</label><label class="expand" for="c-38829487">[1 more]</label></div><br/><div class="children"><div class="content">Doesn&#x27;t detect Google One VPN</div><br/></div></div><div id="38829606" class="c"><input type="checkbox" id="c-38829606" checked=""/><div class="controls bullet"><span class="by">zdc1</span><span>|</span><a href="#38829487">prev</a><span>|</span><a href="#38829820">next</a><span>|</span><label class="collapse" for="c-38829606">[-]</label><label class="expand" for="c-38829606">[1 more]</label></div><br/><div class="children"><div class="content">No VPN:<p><pre><code>  Proxy Score: 0&#x2F;100 - Very likely not a Proxy
  VPN Score: 0&#x2F;55 - Very likely not a VPN
</code></pre>
Proton VPN (paid tier):<p><pre><code>  Proxy Score: 35&#x2F;100 - Might be a Proxy
  VPN Score: 10&#x2F;55 - Could be a VPN (But Unlikely)
</code></pre>
And then these jump to 95 and 25 when I switch my VPN to a far away continent.</div><br/></div></div><div id="38830326" class="c"><input type="checkbox" id="c-38830326" checked=""/><div class="controls bullet"><span class="by">nilespotter</span><span>|</span><a href="#38829820">prev</a><span>|</span><a href="#38829453">next</a><span>|</span><label class="collapse" for="c-38830326">[-]</label><label class="expand" for="c-38830326">[1 more]</label></div><br/><div class="children"><div class="content">Didn’t detect my VPN. Hopefully this technology sees wide adoption!</div><br/></div></div><div id="38829430" class="c"><input type="checkbox" id="c-38829430" checked=""/><div class="controls bullet"><span class="by">vivzkestrel</span><span>|</span><a href="#38829453">prev</a><span>|</span><a href="#38829459">next</a><span>|</span><label class="collapse" for="c-38829430">[-]</label><label class="expand" for="c-38829430">[5 more]</label></div><br/><div class="children"><div class="content">ok but how does this work? i was expecting atleast a paragraph on HN to be honest</div><br/><div id="38829502" class="c"><input type="checkbox" id="c-38829502" checked=""/><div class="controls bullet"><span class="by">cebert</span><span>|</span><a href="#38829430">parent</a><span>|</span><a href="#38829459">next</a><span>|</span><label class="collapse" for="c-38829502">[-]</label><label class="expand" for="c-38829502">[4 more]</label></div><br/><div class="children"><div class="content">The documentation page linked to the demo page gives a good explanation on how this works (<a href="https:&#x2F;&#x2F;proxy.incolumitas.com&#x2F;integration_instructions.html" rel="nofollow">https:&#x2F;&#x2F;proxy.incolumitas.com&#x2F;integration_instructions.html</a>)<p>&gt; The most important proxy detection tests with the highest accuracy are:<p>&gt; 1. Latency Test - latency - This test is extremely effective at detecting proxy connections. It works both for residential and datacenter proxies. The reason why this test is effective: It is very hard to spoof and fake the latency test effectively. Furthermore, this test captures the very essence of proxy connections.<p>&gt; 2. TCP&#x2F;IP Fingerprint Test - tcpip_fp - This test is also capable to detect both residential and datacenter proxy connections. Although it is possible to spoof the TCP&#x2F;IP fingerprint of a proxy server, most commercial proxy providers don&#x27;t do it.<p>&gt; 3. Timezone Test - timezone - The timezone test detects both VPN and Proxy connections. Clients can prevent the leaking of their locale and timezone, so this test can be bypassed rather easily.</div><br/><div id="38829645" class="c"><input type="checkbox" id="c-38829645" checked=""/><div class="controls bullet"><span class="by">yjftsjthsd-h</span><span>|</span><a href="#38829430">root</a><span>|</span><a href="#38829502">parent</a><span>|</span><a href="#38829763">next</a><span>|</span><label class="collapse" for="c-38829645">[-]</label><label class="expand" for="c-38829645">[1 more]</label></div><br/><div class="children"><div class="content">&gt; 1. Latency Test - latency - This test is extremely effective at detecting proxy connections. It works both for residential and datacenter proxies. The reason why this test is effective: It is very hard to spoof and fake the latency test effectively. Furthermore, this test captures the very essence of proxy connections.<p>LOL - so the author has never been stuck on DSL or a WISP?<p>Edit: For that matter, I wonder how many cell connections fail the latency test</div><br/></div></div><div id="38829763" class="c"><input type="checkbox" id="c-38829763" checked=""/><div class="controls bullet"><span class="by">vivzkestrel</span><span>|</span><a href="#38829430">root</a><span>|</span><a href="#38829502">parent</a><span>|</span><a href="#38829645">prev</a><span>|</span><a href="#38829459">next</a><span>|</span><label class="collapse" for="c-38829763">[-]</label><label class="expand" for="c-38829763">[2 more]</label></div><br/><div class="children"><div class="content">ok but how is all this implemented? is it a machine learning algorithm that classifies latencies with some pre-trained model? or did the library creator set some manual threshold like latency &lt; 200ms = no VPN else VPN?</div><br/><div id="38830173" class="c"><input type="checkbox" id="c-38830173" checked=""/><div class="controls bullet"><span class="by">patrakov</span><span>|</span><a href="#38829430">root</a><span>|</span><a href="#38829763">parent</a><span>|</span><a href="#38829459">next</a><span>|</span><label class="collapse" for="c-38830173">[-]</label><label class="expand" for="c-38830173">[1 more]</label></div><br/><div class="children"><div class="content">No. It works in a very simple way. The visitor&#x27;s IP address is pinged by the server running the test. At the same time, the client establishes a websocket connection to the server, exchanges a few messages, and latency is measured this way, too. The detector exploits the fact that most for-privacy VPNs have a NAT, and therefore the TCP&#x2F;IP ping test would measure the latency to the VPN server, while the websocket test would measure the latency to the actual client device. A difference would thus indicate a VPN. In practice, this also triggers by a mobile connection while roaming.<p>Of course this does not work for VPN services like PureVPN, OVPN, and SwissVPN that provide a real public IP address to the client (so both pings measure the latency to the client), or for VPNs that properly firewalled the external NAT IP so that it is not pingable and does not send TCP RST or ICMP Port Unreachable messages when probed. But PureVPN IP ranges are known, so it is detected that way.</div><br/></div></div></div></div></div></div></div></div><div id="38829459" class="c"><input type="checkbox" id="c-38829459" checked=""/><div class="controls bullet"><span class="by">toomuchtodo</span><span>|</span><a href="#38829430">prev</a><span>|</span><a href="#38829411">next</a><span>|</span><label class="collapse" for="c-38829459">[-]</label><label class="expand" for="c-38829459">[3 more]</label></div><br/><div class="children"><div class="content">Detects iCloud private relay via Cloudflare, did not detect Mullvad.</div><br/><div id="38829473" class="c"><input type="checkbox" id="c-38829473" checked=""/><div class="controls bullet"><span class="by">droopyEyelids</span><span>|</span><a href="#38829459">parent</a><span>|</span><a href="#38829411">next</a><span>|</span><label class="collapse" for="c-38829473">[-]</label><label class="expand" for="c-38829473">[2 more]</label></div><br/><div class="children"><div class="content">Aside from simple detection, being able to _identify_ private relay is kind of a fundamental required feature for a tool like this, because the utility of identifying proxy&#x2F;vpn traffic is destroyed if you’re going to lump “everyone with an apple device” into the pool</div><br/></div></div></div></div><div id="38829411" class="c"><input type="checkbox" id="c-38829411" checked=""/><div class="controls bullet"><span class="by">mathfailure</span><span>|</span><a href="#38829459">prev</a><span>|</span><a href="#38829913">next</a><span>|</span><label class="collapse" for="c-38829411">[-]</label><label class="expand" for="c-38829411">[2 more]</label></div><br/><div class="children"><div class="content">This makes me sad :(</div><br/><div id="38829931" class="c"><input type="checkbox" id="c-38829931" checked=""/><div class="controls bullet"><span class="by">Tostino</span><span>|</span><a href="#38829411">parent</a><span>|</span><a href="#38829913">next</a><span>|</span><label class="collapse" for="c-38829931">[-]</label><label class="expand" for="c-38829931">[1 more]</label></div><br/><div class="children"><div class="content">I hope OP fails fantastically. I don&#x27;t want more companies putting up bullshit filters that have a ton of false positives.</div><br/></div></div></div></div><div id="38829913" class="c"><input type="checkbox" id="c-38829913" checked=""/><div class="controls bullet"><span class="by">WarOnPrivacy</span><span>|</span><a href="#38829411">prev</a><span>|</span><a href="#38830409">next</a><span>|</span><label class="collapse" for="c-38829913">[-]</label><label class="expand" for="c-38829913">[1 more]</label></div><br/><div class="children"><div class="content">OVPN came up as a data center so that was accurate.<p>Shifting to overseas it detected a clock difference between my browser and the exit point. I was testing with chrome though so insecurities like that are to be expected.</div><br/></div></div><div id="38829432" class="c"><input type="checkbox" id="c-38829432" checked=""/><div class="controls bullet"><span class="by">LeoPanthera</span><span>|</span><a href="#38830409">prev</a><span>|</span><a href="#38829479">next</a><span>|</span><label class="collapse" for="c-38829432">[-]</label><label class="expand" for="c-38829432">[1 more]</label></div><br/><div class="children"><div class="content">It failed to detect Mullvad&#x27;s VPN, and also my homebrew VPN to my house in a different country, both using Wireguard.<p>...which I&#x27;m actually fairly pleased about.</div><br/></div></div><div id="38829479" class="c"><input type="checkbox" id="c-38829479" checked=""/><div class="controls bullet"><span class="by">gigel82</span><span>|</span><a href="#38829432">prev</a><span>|</span><label class="collapse" for="c-38829479">[-]</label><label class="expand" for="c-38829479">[1 more]</label></div><br/><div class="children"><div class="content">On Private Internet Access VPN:<p>* Proxy Score: 45&#x2F;100 - Likely a Proxy<p>* VPN Score: 10&#x2F;55 - Could be a VPN (But Unlikely)</div><br/></div></div></div></div></div></div></div></body></html>