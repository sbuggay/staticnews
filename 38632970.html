<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1702544459156" as="style"/><link rel="stylesheet" href="styles.css?v=1702544459156"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/rochus-keller/CspChan">Show HN: A pure C89 implementation of Go channels, with blocking selects</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>Rochus</span> | <span>117 comments</span></div><br/><div><div id="38633746" class="c"><input type="checkbox" id="c-38633746" checked=""/><div class="controls bullet"><span class="by">samsquire</span><span>|</span><a href="#38635289">next</a><span>|</span><label class="collapse" for="c-38633746">[-]</label><label class="expand" for="c-38633746">[2 more]</label></div><br/><div class="children"><div class="content">Wow, thank you for this. Good work!<p>Some thoughts:<p>I&#x27;ve often thought that unbuffered channels would cause scheduling thrashing - higher latency and lower throughput because you&#x27;re swapping between stopping and starting processes blocked on a channel frequently. If you&#x27;re sending just a small piece of data like 64 bit integer at a time, or any kind of pattern where you&#x27;re using threads to  break up work into tasks, this is too small breakdown of task to really scale multithreading. Want to communicate something that causes a LARGE AMOUNT of work on the other thread, to keep the processor busy. But there&#x27;s balance between latency and throughput, if you send a big task you get higher latency to react to the next task but better throughput.<p>Walking through my thinking and help me understand: If you have multiple channels that you could read from in a select call but none are ready, could you block that select instance and process a different process where other selects are potentially waiting? This is similar to blocking a goroutine or a Rust async Future task in Tokio that needs to be waked. I think this would need a scheduler. EDIT: Your scheduler to switch between  &quot;select instances&quot; or what is running in a thread is the OS.</div><br/><div id="38638758" class="c"><input type="checkbox" id="c-38638758" checked=""/><div class="controls bullet"><span class="by">Galanwe</span><span>|</span><a href="#38633746">parent</a><span>|</span><a href="#38635289">next</a><span>|</span><label class="collapse" for="c-38638758">[-]</label><label class="expand" for="c-38638758">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If you have multiple channels that you could read from in a select call but none are ready, could you block that select instance and process a different process where other selects are potentially waiting?<p>From my experience, the most versatile approach for the wait on channels is best implemented as a spin lock with exponential backoff, up to a threshold that yields - effectively letting other threads perform their own select. Note that most of the time, if you are targeting latency, you would try not to get more workers than cores, meaning you would pin each worker to a core, thus not really benefiting from yielding on select.<p>&gt; But there&#x27;s balance between latency and throughput, if you send a big task you get higher latency to react to the next task but better throughput.<p>Agree, but that&#x27;s mainly a client concern, the queue can propose multiple APIs. Most queues handle that with a &quot;burst&quot; mode, where you pop or push multiple messages at once instead of 1 by 1, to balance throughput vs latency.</div><br/></div></div></div></div><div id="38635289" class="c"><input type="checkbox" id="c-38635289" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38633746">prev</a><span>|</span><a href="#38634802">next</a><span>|</span><label class="collapse" for="c-38635289">[-]</label><label class="expand" for="c-38635289">[1 more]</label></div><br/><div class="children"><div class="content">1. There is no &lt;memory.h&gt; in any version of ISO C, nor in POSIX.<p>2. This is not C89; at best GNU C 89, because a variable is declared after a statement:<p><pre><code>   {
     if( msgLen == 0 )
        msgLen = 1;
     &#x2F;* queueLen == 0 is an unbuffered channel, but we still need one slot to transport the message *&#x2F;
     CspChan_t* c = (CspChan_t*)malloc(sizeof(CspChan_t) + queueLen*msgLen);
</code></pre>
To help enforce that you&#x27;re actually writing C89, you should set your compiler to C89 and turn on whatever additional diagnostics may be required like -pedantic.</div><br/></div></div><div id="38634802" class="c"><input type="checkbox" id="c-38634802" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#38635289">prev</a><span>|</span><a href="#38634275">next</a><span>|</span><label class="collapse" for="c-38634802">[-]</label><label class="expand" for="c-38634802">[2 more]</label></div><br/><div class="children"><div class="content">Very interesting! I program a lot in Go, and while I have my complaints about the language, I find the CSP model to be very easy to work with.<p>I&#x27;d recommend adding some additional documentation about the API. You mention trying to keep dynamic allocations to a minimum (which I like to hear) but it would be handy to have documentation stating which functions allocate and how much they allocate. Actually, more documentation in general would be nice, particular relating to edge cases. In Go I know that sending to a closed channel will panic, for example. But what will your library do? Return some sort of error message? Silently drop the message? Segfault? Definitely something you want prominently documented. Especially anything that could potentially segfault should be highlighted.<p>Oh, and some benchmarks would be very interesting!</div><br/><div id="38638763" class="c"><input type="checkbox" id="c-38638763" checked=""/><div class="controls bullet"><span class="by">xyproto</span><span>|</span><a href="#38634802">parent</a><span>|</span><a href="#38634275">next</a><span>|</span><label class="collapse" for="c-38638763">[-]</label><label class="expand" for="c-38638763">[1 more]</label></div><br/><div class="children"><div class="content">What are your complaints about the Go language that is better in C89?</div><br/></div></div></div></div><div id="38634275" class="c"><input type="checkbox" id="c-38634275" checked=""/><div class="controls bullet"><span class="by">Matthias247</span><span>|</span><a href="#38634802">prev</a><span>|</span><a href="#38634169">next</a><span>|</span><label class="collapse" for="c-38634275">[-]</label><label class="expand" for="c-38634275">[2 more]</label></div><br/><div class="children"><div class="content">libmill (<a href="https:&#x2F;&#x2F;github.com&#x2F;sustrik&#x2F;libmill">https:&#x2F;&#x2F;github.com&#x2F;sustrik&#x2F;libmill</a>) and libdill (<a href="https:&#x2F;&#x2F;github.com&#x2F;sustrik&#x2F;libdill">https:&#x2F;&#x2F;github.com&#x2F;sustrik&#x2F;libdill</a>) should be similar and probably mentioned.<p>As far as I understand the differences between CspChan and libmill might be that libmill also implements lightweight tasks (coroutines) and everything that goes with it (IO multiplexing, async timers, etc), while CspChan uses OS threads?</div><br/><div id="38638675" class="c"><input type="checkbox" id="c-38638675" checked=""/><div class="controls bullet"><span class="by">samuell</span><span>|</span><a href="#38634275">parent</a><span>|</span><a href="#38634169">next</a><span>|</span><label class="collapse" for="c-38638675">[-]</label><label class="expand" for="c-38638675">[1 more]</label></div><br/><div class="children"><div class="content">Was going to ask if the current implementation could be used together with libmill, but maybe they overlap a lot in functionality?</div><br/></div></div></div></div><div id="38634169" class="c"><input type="checkbox" id="c-38634169" checked=""/><div class="controls bullet"><span class="by">Zambyte</span><span>|</span><a href="#38634275">prev</a><span>|</span><a href="#38633521">next</a><span>|</span><label class="collapse" for="c-38634169">[-]</label><label class="expand" for="c-38634169">[2 more]</label></div><br/><div class="children"><div class="content">This is really cool!<p>I do want to say though, if you&#x27;re considering using this for a production system: it&#x27;s worth also considering ZeroMQ inproc sockets[0]. They allow for very similar semantics to this, with the added benefit of trivially being able to migrate to an inter-process &#x2F; network channel, by just changing the URL to bind &#x2F; connect to.<p>[0] <a href="http:&#x2F;&#x2F;czmq.zeromq.org&#x2F;" rel="nofollow noreferrer">http:&#x2F;&#x2F;czmq.zeromq.org&#x2F;</a></div><br/><div id="38637269" class="c"><input type="checkbox" id="c-38637269" checked=""/><div class="controls bullet"><span class="by">smabie</span><span>|</span><a href="#38634169">parent</a><span>|</span><a href="#38633521">next</a><span>|</span><label class="collapse" for="c-38637269">[-]</label><label class="expand" for="c-38637269">[1 more]</label></div><br/><div class="children"><div class="content">Depending on your use case, zmq inproc I&#x27;ve found has a lot more latency than you would expect. like p50 of &gt;100us and p99 can be over 1ms.<p>Kind of unfortunate as other more handrolled solutions (depending on use case) can easily be &lt;10us.<p>Feels like you really need to be using a lock free ring buffer that only supports 1&lt;&gt;1 communication if you really want to go fast. (p50 of &lt;1us with very compressed tail latencies)</div><br/></div></div></div></div><div id="38633521" class="c"><input type="checkbox" id="c-38633521" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#38634169">prev</a><span>|</span><a href="#38633438">next</a><span>|</span><label class="collapse" for="c-38633521">[-]</label><label class="expand" for="c-38633521">[1 more]</label></div><br/><div class="children"><div class="content">Basically what ended up replacing Alef in Plan 9.<p><a href="https:&#x2F;&#x2F;9p.io&#x2F;magic&#x2F;man2html&#x2F;2&#x2F;thread" rel="nofollow noreferrer">https:&#x2F;&#x2F;9p.io&#x2F;magic&#x2F;man2html&#x2F;2&#x2F;thread</a></div><br/></div></div><div id="38633438" class="c"><input type="checkbox" id="c-38633438" checked=""/><div class="controls bullet"><span class="by">eqvinox</span><span>|</span><a href="#38633521">prev</a><span>|</span><a href="#38633477">next</a><span>|</span><label class="collapse" for="c-38633438">[-]</label><label class="expand" for="c-38633438">[73 more]</label></div><br/><div class="children"><div class="content">It&#x27;s 2023 - even MSVC has supported C11 and C17 for a while now.  C89 is no longer a feature to advertise, it&#x27;s an unhelpful constraint forcing poorer quality code.  A good example is that CspChan_closed should use the bool type added in C99.<p>There&#x27;s nonstandard nomenclature in &quot;_dispose&quot;; if the constructing function is called _create, the common pattern is to pair it with _destroy.<p>typedefs ending with _t are reserved for standards extensions, though these days people ignore this a lot because it feels like general practice to add _t.<p>There&#x27;s no way to pass in a custom allocator, or logging callback, or set some debug logging flags.  Maybe something to tackle later.<p>Both _select functions fall short in that they do not allow select&#x27;ing on channels + other file descriptors simultaneously.  General library design practice is to have the library return a file descriptor that can be used in whatever event loop the application already uses.  (The fd can be a dummy pipe or eventfd.)<p>All of these things are in the header, so they matter the most as they set ABI and API for any user.  Unfortunately getting them right as early as possible is important to avoid breaks; yet very hard to do since often API aspects only become clear after a library has non-trivial users.<p>[edited to tone down a bit]</div><br/><div id="38633504" class="c"><input type="checkbox" id="c-38633504" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38638103">next</a><span>|</span><label class="collapse" for="c-38633504">[-]</label><label class="expand" for="c-38633504">[13 more]</label></div><br/><div class="children"><div class="content">I realize your intention is to provide good feedback and you obviously know a lot, but if you could shift the pH slightly away from acidic, that would be better. Keep in mind that criticisms like this have a tendency to land 10x harder than you intended.<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;showhn.html">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;showhn.html</a></div><br/><div id="38634065" class="c"><input type="checkbox" id="c-38634065" checked=""/><div class="controls bullet"><span class="by">drewg123</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633504">parent</a><span>|</span><a href="#38633601">next</a><span>|</span><label class="collapse" for="c-38634065">[-]</label><label class="expand" for="c-38634065">[2 more]</label></div><br/><div class="children"><div class="content">This has to be the best comment from a moderator that I&#x27;ve ever seen.  This is why I love HN.</div><br/><div id="38634291" class="c"><input type="checkbox" id="c-38634291" checked=""/><div class="controls bullet"><span class="by">lnxg33k1</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634065">parent</a><span>|</span><a href="#38633601">next</a><span>|</span><label class="collapse" for="c-38634291">[-]</label><label class="expand" for="c-38634291">[1 more]</label></div><br/><div class="children"><div class="content">I almost never agree with mods here, but despite that I’ve got to admit that the way the expose their opinions is one of the best Ive experienced</div><br/></div></div></div></div><div id="38633601" class="c"><input type="checkbox" id="c-38633601" checked=""/><div class="controls bullet"><span class="by">eqvinox</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633504">parent</a><span>|</span><a href="#38634065">prev</a><span>|</span><a href="#38637292">next</a><span>|</span><label class="collapse" for="c-38633601">[-]</label><label class="expand" for="c-38633601">[7 more]</label></div><br/><div class="children"><div class="content">Sigh. Yes. Valid. I&#x27;ll go edit it a bit.</div><br/><div id="38633734" class="c"><input type="checkbox" id="c-38633734" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633601">parent</a><span>|</span><a href="#38637887">next</a><span>|</span><label class="collapse" for="c-38633734">[-]</label><label class="expand" for="c-38633734">[1 more]</label></div><br/><div class="children"><div class="content">Appreciated!</div><br/></div></div><div id="38637887" class="c"><input type="checkbox" id="c-38637887" checked=""/><div class="controls bullet"><span class="by">da39a3ee</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633601">parent</a><span>|</span><a href="#38633734">prev</a><span>|</span><a href="#38635809">next</a><span>|</span><label class="collapse" for="c-38637887">[-]</label><label class="expand" for="c-38637887">[2 more]</label></div><br/><div class="children"><div class="content">And what we&#x27;re looking at now is the non-acid version? You seem to have completely missed that the person was implementing something interesting. Here&#x27;s something for you to do: think about whether, at work, you&#x27;re good at giving credit to other people publicly. How do you think people feel on reading your code review comments? More junior employees? Are you happy with this?</div><br/><div id="38638165" class="c"><input type="checkbox" id="c-38638165" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38637887">parent</a><span>|</span><a href="#38635809">next</a><span>|</span><label class="collapse" for="c-38638165">[-]</label><label class="expand" for="c-38638165">[1 more]</label></div><br/><div class="children"><div class="content">The edit moved in a good direction and that&#x27;s worth reinforcing. It&#x27;s not worth it to pile on further—it risks shaming, which would produce a backlash, which wouldn&#x27;t benefit anyone.</div><br/></div></div></div></div></div></div><div id="38637292" class="c"><input type="checkbox" id="c-38637292" checked=""/><div class="controls bullet"><span class="by">helsinki</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633504">parent</a><span>|</span><a href="#38633601">prev</a><span>|</span><a href="#38638103">next</a><span>|</span><label class="collapse" for="c-38637292">[-]</label><label class="expand" for="c-38637292">[3 more]</label></div><br/><div class="children"><div class="content">How much do you get paid to be mod?</div><br/><div id="38637336" class="c"><input type="checkbox" id="c-38637336" checked=""/><div class="controls bullet"><span class="by">defrost</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38637292">parent</a><span>|</span><a href="#38638172">next</a><span>|</span><label class="collapse" for="c-38637336">[-]</label><label class="expand" for="c-38637336">[1 more]</label></div><br/><div class="children"><div class="content">Undisclosed: <a href="https:&#x2F;&#x2F;www.newyorker.com&#x2F;news&#x2F;letter-from-silicon-valley&#x2F;the-lonely-work-of-moderating-hacker-news" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.newyorker.com&#x2F;news&#x2F;letter-from-silicon-valley&#x2F;th...</a><p>.. but likely more than either of us get paid to comment.</div><br/></div></div><div id="38638172" class="c"><input type="checkbox" id="c-38638172" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38637292">parent</a><span>|</span><a href="#38637336">prev</a><span>|</span><a href="#38638103">next</a><span>|</span><label class="collapse" for="c-38638172">[-]</label><label class="expand" for="c-38638172">[1 more]</label></div><br/><div class="children"><div class="content">Enough to keep doing it.</div><br/></div></div></div></div></div></div><div id="38638103" class="c"><input type="checkbox" id="c-38638103" checked=""/><div class="controls bullet"><span class="by">__d</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38633504">prev</a><span>|</span><a href="#38633552">next</a><span>|</span><label class="collapse" for="c-38638103">[-]</label><label class="expand" for="c-38638103">[1 more]</label></div><br/><div class="children"><div class="content">Ok, I agree that these points might have been made more constructively, but ...<p>They&#x27;re mostly legitimate, good-quality feedback for a new C library.<p>_create&#x2F;_destroy -- yes;  custom allocator, logger, debug level setting -- yes; returning a file descriptor -- yes;  the implied suggestion to move stuff out of the header -- yes.<p>This is important feedback.  These things will require a breaking change down the line unless you tackle them before 1.0.<p>I encourage the author to take this onboard: it&#x27;ll make your own life easier and your library a better C citizen.</div><br/></div></div><div id="38633552" class="c"><input type="checkbox" id="c-38633552" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38638103">prev</a><span>|</span><a href="#38636433">next</a><span>|</span><label class="collapse" for="c-38633552">[-]</label><label class="expand" for="c-38633552">[10 more]</label></div><br/><div class="children"><div class="content">&gt; should really be a bool<p>bool is actually #define bool _Bool. You have to include &lt;stdbool.h&gt; to get it. That&#x27;s ugly enough not to want to use it.<p>I&#x27;m looking at the April 2023 draft of ISO C. Under &quot;Relational Expressions&quot; I see that the result of an expression like x &lt; y isn&#x27;t bool, but ... int.<p>Here is the exact wording, minus a footnote reference:<p><i>Each of the operators &lt; (less than), &gt; (greater than), &lt;= (less than or equal to), and &gt;= (greater than or equal to) shall yield 1 if the specified relation is true and 0 if it is false. The result has type int.</i><p>int is still the Boolean type in C, and null pointers and zeros are still falsy, relational expressions yield 0 or 1 of type int, and #define bool is just a sham for anal retentives.<p>&gt; <i>typedefs ending with _t are reserved for standards extensions</i><p>That is inaccurate. It&#x27;s POSIX that reserves this namespace.  Even if you&#x27;re targeting POSIX, the reservation has next to no practical meaning, and can safely be ignored.<p>Here is why. What POSIX says is that when new type names will be introduced in the future in POSIX, they will have _t as a suffix.  Well, so what? New type names in ISO C will also have _t suffixes, yet ISO C doesn&#x27;t say anything about that being &quot;reserved&quot;.<p>When a new identifier is introduced, it has to start and end in <i>something</i>.<p>Whenever POSIX introduces a new public identifier in the future, that identifier will either start with &quot;a&quot;, or else with &quot;b&quot;, or with &quot;c&quot; ...  does that mean that we should stop using all identifiers in order not to tread on a reserved space?<p>When you have a language without namespaces&#x2F;packages, you just live with the threat of a clash and deal with it when it happens.<p>Name clashes are not just with standards like ISO C and POSIX but vendor extensions and third-party code.<p>The mole is only a problem when it rears its head, and that&#x27;s when you whack it.</div><br/><div id="38633893" class="c"><input type="checkbox" id="c-38633893" checked=""/><div class="controls bullet"><span class="by">eqvinox</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633552">parent</a><span>|</span><a href="#38638069">next</a><span>|</span><label class="collapse" for="c-38633893">[-]</label><label class="expand" for="c-38633893">[6 more]</label></div><br/><div class="children"><div class="content">&gt; bool is actually #define bool _Bool. You have to include &lt;stdbool.h&gt; to get it. That&#x27;s ugly enough not to want to use it.<p>Sure, which is why it got changed to a keyword in C23.  I&#x27;ll agree this should have happened earlier.<p>The return type of comparison operators is entirely irrelevant; you don&#x27;t build APIs by reference to the return type of a comparison operator.  It makes a difference to the reader whether your source code says &quot;int&quot; or &quot;bool&quot;, that alone is all the reason anyone should need.<p>&gt; That is inaccurate. It&#x27;s POSIX that reserves this namespace.<p>You got me there.  However, the question is, why would you add the _t?  It serves no purpose.  Typedefs have their own namespace anyway, you&#x27;re not working around some possible collision by adding the _t.<p>That said I&#x27;ve already noted this is a commonly ignored aspect.  I suppose it &quot;feels&quot; better&#x2F;correct to some readers.  I will happily agree this is the weakest point of my feedback either way, yet I still rather point it out and have people learn more details about this.</div><br/><div id="38634413" class="c"><input type="checkbox" id="c-38634413" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633893">parent</a><span>|</span><a href="#38638069">next</a><span>|</span><label class="collapse" for="c-38634413">[-]</label><label class="expand" for="c-38634413">[5 more]</label></div><br/><div class="children"><div class="content">&gt; <i>The return type of comparison operators is entirely irrelevant</i><p>It is entirely relevant. The boolean type of the language is whatever is the type of (0 &lt; 1).<p>&gt; <i>Typedefs have their own namespace anyway</i><p>Typedefs positively do not have their own namespace.<p>If you write<p><pre><code>  #undef getc
  {
     typedef char getc;

  }
</code></pre>
you cannot call the getc function in that scope; it is now the typedef.</div><br/><div id="38636578" class="c"><input type="checkbox" id="c-38636578" checked=""/><div class="controls bullet"><span class="by">codys</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634413">parent</a><span>|</span><a href="#38638069">next</a><span>|</span><label class="collapse" for="c-38636578">[-]</label><label class="expand" for="c-38636578">[4 more]</label></div><br/><div class="children"><div class="content">When folks talk about namespaces, structs, &amp; typedefs in C, it&#x27;s to call out that `struct X` and `typedef int X;` can both exist at the same time. In other words, nothing prevents one from doing a `typedef struct X { int f; } X;` or similar, using `X` as the name in both places.<p>It is true that it&#x27;s more correct to say &quot;struct names have their own namespace&quot;, though I think we can infer what&#x27;s actually meant here fairly easily.</div><br/><div id="38636775" class="c"><input type="checkbox" id="c-38636775" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636578">parent</a><span>|</span><a href="#38638069">next</a><span>|</span><label class="collapse" for="c-38636775">[-]</label><label class="expand" for="c-38636775">[3 more]</label></div><br/><div class="children"><div class="content">&gt; <i>more correct to say &quot;struct names have their own namespace&quot;</i><p>That is false. If we declare an &quot;enum foo&quot;, which is not a struct, then we cannot have a &quot;struct foo&quot; in that scope.</div><br/><div id="38636913" class="c"><input type="checkbox" id="c-38636913" checked=""/><div class="controls bullet"><span class="by">codys</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636775">parent</a><span>|</span><a href="#38638069">next</a><span>|</span><label class="collapse" for="c-38636913">[-]</label><label class="expand" for="c-38636913">[2 more]</label></div><br/><div class="children"><div class="content">Sure, you&#x27;re right, it&#x27;s just not really relevant here.</div><br/><div id="38636984" class="c"><input type="checkbox" id="c-38636984" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636913">parent</a><span>|</span><a href="#38638069">next</a><span>|</span><label class="collapse" for="c-38636984">[-]</label><label class="expand" for="c-38636984">[1 more]</label></div><br/><div class="children"><div class="content">Well, your two comments set a standard for relevance that is not easily attained by others.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="38638069" class="c"><input type="checkbox" id="c-38638069" checked=""/><div class="controls bullet"><span class="by">__d</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633552">parent</a><span>|</span><a href="#38633893">prev</a><span>|</span><a href="#38635598">next</a><span>|</span><label class="collapse" for="c-38638069">[-]</label><label class="expand" for="c-38638069">[1 more]</label></div><br/><div class="children"><div class="content">&gt; int is still the Boolean type in C, and null pointers and zeros are still
&gt; falsy, relational expressions yield 0 or 1 of type int, and #define bool
&gt; is just a sham for anal retentives.<p>Alternatively, and especially in a library API, using bool is a clear specification of semantics.<p>An int parameter could have many meanings.  An int return value similarly.  In both cases, using &quot;bool&quot; makes the usage instantly more clear, without the need for comments, or man pages, or Doxygen, or super_long_parameter_names, or whatever.<p>I think it&#x27;s useful.</div><br/></div></div><div id="38635598" class="c"><input type="checkbox" id="c-38635598" checked=""/><div class="controls bullet"><span class="by">Xeamek</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633552">parent</a><span>|</span><a href="#38638069">prev</a><span>|</span><a href="#38636433">next</a><span>|</span><label class="collapse" for="c-38635598">[-]</label><label class="expand" for="c-38635598">[2 more]</label></div><br/><div class="children"><div class="content">What about size of stored bool variable? Just using int will take 4 bytes (Or something else, but still bigger then 1), while stdbool will only use 1 byte, no?</div><br/><div id="38635785" class="c"><input type="checkbox" id="c-38635785" checked=""/><div class="controls bullet"><span class="by">kazinator</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635598">parent</a><span>|</span><a href="#38636433">next</a><span>|</span><label class="collapse" for="c-38635785">[-]</label><label class="expand" for="c-38635785">[1 more]</label></div><br/><div class="children"><div class="content">In arrays, you can use char. In structs, there are also bitfields like unsigned flag : 1.</div><br/></div></div></div></div></div></div><div id="38636433" class="c"><input type="checkbox" id="c-38636433" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38633552">prev</a><span>|</span><a href="#38639003">next</a><span>|</span><label class="collapse" for="c-38636433">[-]</label><label class="expand" for="c-38636433">[4 more]</label></div><br/><div class="children"><div class="content">It&#x27;s 2023, and I love this. There is no reason to criticize the mere fact that someone took the effort to make something that portable.<p>Even if you think they wasted their time, they didn&#x27;t waste <i>your</i> time, and I value the existence of things like this, which means even if you don&#x27;t, at least some others do.</div><br/><div id="38636773" class="c"><input type="checkbox" id="c-38636773" checked=""/><div class="controls bullet"><span class="by">kevin_thibedeau</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636433">parent</a><span>|</span><a href="#38639003">next</a><span>|</span><label class="collapse" for="c-38636773">[-]</label><label class="expand" for="c-38636773">[3 more]</label></div><br/><div class="children"><div class="content">C89 sometimes actually means gnu89 which is decidedly non-portable to modern standards in subtle ways. It&#x27;s time to put that horse to pasture and consider at least using a 24 year old standard instead.</div><br/><div id="38637212" class="c"><input type="checkbox" id="c-38637212" checked=""/><div class="controls bullet"><span class="by">Brian_K_White</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636773">parent</a><span>|</span><a href="#38638385">next</a><span>|</span><label class="collapse" for="c-38637212">[-]</label><label class="expand" for="c-38637212">[1 more]</label></div><br/><div class="children"><div class="content">If gnu89 is not a perfect c89, so what? c11 is also not a perfect c89. ruby is also not a perfect c89. Swift is more convenient than c89 for ios. c89 doesn&#x27;t have tons of features that c# has. We could say true yet irrelevant things all day long. You don&#x27;t like c89 flavor ice cream, got it. So what?</div><br/></div></div></div></div></div></div><div id="38639003" class="c"><input type="checkbox" id="c-38639003" checked=""/><div class="controls bullet"><span class="by">1vuio0pswjnm7</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38636433">prev</a><span>|</span><a href="#38634141">next</a><span>|</span><label class="collapse" for="c-38639003">[-]</label><label class="expand" for="c-38639003">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps I&#x27;m readint it wrong bu this comment is crticising someone for not using added language features.  Maybe the author does not need them.  &quot;YAGNI&quot;.  IMO, it should be the author&#x27;s choice whether or not to utilise certain features.  As someone else noted in another comment, C89 is more portable than C11 or C17.  To me, C89 is like Bourne shell.  An author can choose to write scripts in Bash but they will not be as portable as ones written in Dash, nor as fast.  The only constraint I have run into with C89, when compiling lex.yy.c, is that it has a limit of 32767 lines.</div><br/></div></div><div id="38634141" class="c"><input type="checkbox" id="c-38634141" checked=""/><div class="controls bullet"><span class="by">MrRadar</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38639003">prev</a><span>|</span><a href="#38634230">next</a><span>|</span><label class="collapse" for="c-38634141">[-]</label><label class="expand" for="c-38634141">[1 more]</label></div><br/><div class="children"><div class="content">Also, as someone who wrote code that had to support C89-only compilers as recently as 5 years ago, I noticed immediately that this code mixes code and variable declarations which strictly C89 compatible compilers will barf on. That said, this code also uses pthreads which is not exactly as portable as &quot;pure C89&quot; implies either.</div><br/></div></div><div id="38634230" class="c"><input type="checkbox" id="c-38634230" checked=""/><div class="controls bullet"><span class="by">tomcam</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38634141">prev</a><span>|</span><a href="#38633528">next</a><span>|</span><label class="collapse" for="c-38634230">[-]</label><label class="expand" for="c-38634230">[3 more]</label></div><br/><div class="children"><div class="content">&gt; It&#x27;s 2023 - even MSVC has supported C11 and C17 for a while now. C89 is no longer a feature to advertise<p>There are plenty of constrained environments where this is indeed a feature to advertise, namely older machines and embedded systems.</div><br/><div id="38635329" class="c"><input type="checkbox" id="c-38635329" checked=""/><div class="controls bullet"><span class="by">fweimer</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634230">parent</a><span>|</span><a href="#38635065">next</a><span>|</span><label class="collapse" for="c-38635329">[-]</label><label class="expand" for="c-38635329">[1 more]</label></div><br/><div class="children"><div class="content">But it&#x27;s not actually written in C89. It uses POSIX threads, flexible array members, anonymous unions, bitfield members that are not int, declarations intermixed with statements. And that&#x27;s just what “gcc -std=c89 -pedantic-errors” reports.</div><br/></div></div><div id="38635065" class="c"><input type="checkbox" id="c-38635065" checked=""/><div class="controls bullet"><span class="by">38</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634230">parent</a><span>|</span><a href="#38635329">prev</a><span>|</span><a href="#38633528">next</a><span>|</span><label class="collapse" for="c-38635065">[-]</label><label class="expand" for="c-38635065">[1 more]</label></div><br/><div class="children"><div class="content">&gt; older machines<p>Anything from the 80s&#x2F;90s isn&#x27;t really worth supporting. We gotta draw the line somewhere.</div><br/></div></div></div></div><div id="38633528" class="c"><input type="checkbox" id="c-38633528" checked=""/><div class="controls bullet"><span class="by">oconnor663</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38634230">prev</a><span>|</span><a href="#38635600">next</a><span>|</span><label class="collapse" for="c-38633528">[-]</label><label class="expand" for="c-38633528">[3 more]</label></div><br/><div class="children"><div class="content">&gt; that&#x27;s just the header<p>You&#x27;re providing a ton of code style feedback. That&#x27;s fair, code style is important, I&#x27;m not saying you shouldn&#x27;t. But surely when providing style feedback <i>in public</i> you could take a friendlier tone :(</div><br/><div id="38635077" class="c"><input type="checkbox" id="c-38635077" checked=""/><div class="controls bullet"><span class="by">wiseowise</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633528">parent</a><span>|</span><a href="#38635600">next</a><span>|</span><label class="collapse" for="c-38635077">[-]</label><label class="expand" for="c-38635077">[2 more]</label></div><br/><div class="children"><div class="content">What&#x27;s unfriendly in their tone?</div><br/><div id="38636140" class="c"><input type="checkbox" id="c-38636140" checked=""/><div class="controls bullet"><span class="by">IAmLiterallyAB</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635077">parent</a><span>|</span><a href="#38635600">next</a><span>|</span><label class="collapse" for="c-38636140">[-]</label><label class="expand" for="c-38636140">[1 more]</label></div><br/><div class="children"><div class="content">They edited their original comment before you saw it, apparently the original tone was a bit harsh</div><br/></div></div></div></div></div></div><div id="38635600" class="c"><input type="checkbox" id="c-38635600" checked=""/><div class="controls bullet"><span class="by">Conscat</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38633528">prev</a><span>|</span><a href="#38635339">next</a><span>|</span><label class="collapse" for="c-38635600">[-]</label><label class="expand" for="c-38635600">[6 more]</label></div><br/><div class="children"><div class="content">I would note that Tiny C Compiler is used a fair amount in the wild today, even beyond its stated use cases on the landing page, and C89 is the only standard that it fully supports.</div><br/><div id="38637237" class="c"><input type="checkbox" id="c-38637237" checked=""/><div class="controls bullet"><span class="by">arp242</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635600">parent</a><span>|</span><a href="#38636243">next</a><span>|</span><label class="collapse" for="c-38637237">[-]</label><label class="expand" for="c-38637237">[1 more]</label></div><br/><div class="children"><div class="content">According to the README it supports most of C99, and even some things beyond that. It&#x27;s not clearly defined what&#x27;s meant with &quot;most&quot; or what&#x27;s not supported, but since I&#x27;ve never had any problems with any C99 code I&#x27;ve written I suspect it&#x27;s mostly fairly little used stuff (complex numbers?), and it seems that for all practical purposes tcc supports C99 for almost all codebases.</div><br/></div></div><div id="38636243" class="c"><input type="checkbox" id="c-38636243" checked=""/><div class="controls bullet"><span class="by">jamal-kumar</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635600">parent</a><span>|</span><a href="#38637237">prev</a><span>|</span><a href="#38635339">next</a><span>|</span><label class="collapse" for="c-38636243">[-]</label><label class="expand" for="c-38636243">[4 more]</label></div><br/><div class="children"><div class="content">Out of curiosity where is tinycc still being used?</div><br/><div id="38636291" class="c"><input type="checkbox" id="c-38636291" checked=""/><div class="controls bullet"><span class="by">defrost</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636243">parent</a><span>|</span><a href="#38638723">next</a><span>|</span><label class="collapse" for="c-38636291">[-]</label><label class="expand" for="c-38636291">[1 more]</label></div><br/><div class="children"><div class="content">Fun stuff like running OS&#x27;s in your browser:<p><a href="https:&#x2F;&#x2F;bellard.org&#x2F;jslinux&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;bellard.org&#x2F;jslinux&#x2F;</a><p>and by a dedicated few to this day: <a href="https:&#x2F;&#x2F;lists.gnu.org&#x2F;archive&#x2F;html&#x2F;tinycc-devel&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;lists.gnu.org&#x2F;archive&#x2F;html&#x2F;tinycc-devel&#x2F;</a><p>It&#x27;s not much but it&#x27;s not dead.</div><br/></div></div><div id="38638723" class="c"><input type="checkbox" id="c-38638723" checked=""/><div class="controls bullet"><span class="by">rurban</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636243">parent</a><span>|</span><a href="#38636291">prev</a><span>|</span><a href="#38637285">next</a><span>|</span><label class="collapse" for="c-38638723">[-]</label><label class="expand" for="c-38638723">[1 more]</label></div><br/><div class="children"><div class="content">With big code bases, to get fast feedback. For me it&#x27;s 200ms vs 3min</div><br/></div></div><div id="38637285" class="c"><input type="checkbox" id="c-38637285" checked=""/><div class="controls bullet"><span class="by">Conscat</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636243">parent</a><span>|</span><a href="#38638723">prev</a><span>|</span><a href="#38635339">next</a><span>|</span><label class="collapse" for="c-38637285">[-]</label><label class="expand" for="c-38637285">[1 more]</label></div><br/><div class="children"><div class="content">Languages that transpile to C code like it because, if the C is generated by another compiler, then the C language&#x27;s expressiveness doesn&#x27;t really matter, and TCC builds machine code pretty fast.</div><br/></div></div></div></div></div></div><div id="38635339" class="c"><input type="checkbox" id="c-38635339" checked=""/><div class="controls bullet"><span class="by">jansommer</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38635600">prev</a><span>|</span><a href="#38634353">next</a><span>|</span><label class="collapse" for="c-38635339">[-]</label><label class="expand" for="c-38635339">[2 more]</label></div><br/><div class="children"><div class="content">MSVC lacks some C99 features like variable length arrays and complex numbers. There&#x27;s always a work around, but wouldn&#x27;t want to use that compiler for C unless I had to.<p>Going for C89 for a truly portable project is probably fine.</div><br/><div id="38637242" class="c"><input type="checkbox" id="c-38637242" checked=""/><div class="controls bullet"><span class="by">arp242</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635339">parent</a><span>|</span><a href="#38634353">next</a><span>|</span><label class="collapse" for="c-38637242">[-]</label><label class="expand" for="c-38637242">[1 more]</label></div><br/><div class="children"><div class="content">MSVC added that a few years ago. It took them a (very) long time, but it should now be fully C99-compliant, even C17 I think (either fully or mostly).</div><br/></div></div></div></div><div id="38634353" class="c"><input type="checkbox" id="c-38634353" checked=""/><div class="controls bullet"><span class="by">neverartful</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38635339">prev</a><span>|</span><a href="#38636408">next</a><span>|</span><label class="collapse" for="c-38634353">[-]</label><label class="expand" for="c-38634353">[1 more]</label></div><br/><div class="children"><div class="content">No good deed goes unpunished.</div><br/></div></div><div id="38636408" class="c"><input type="checkbox" id="c-38636408" checked=""/><div class="controls bullet"><span class="by">accelbred</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38634353">prev</a><span>|</span><a href="#38635851">next</a><span>|</span><label class="collapse" for="c-38636408">[-]</label><label class="expand" for="c-38636408">[1 more]</label></div><br/><div class="children"><div class="content">C89 is a requirement where I work still, so C89 libraries are useful here. We support vendor C toolchains that don&#x27;t always have C99 features.</div><br/></div></div><div id="38635851" class="c"><input type="checkbox" id="c-38635851" checked=""/><div class="controls bullet"><span class="by">Rochus</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38636408">prev</a><span>|</span><a href="#38634882">next</a><span>|</span><label class="collapse" for="c-38635851">[-]</label><label class="expand" for="c-38635851">[9 more]</label></div><br/><div class="children"><div class="content">&gt; <i>edited to tone down a bit</i><p>How generous. The comment reminds me of this passage in C. Northcote Parkinson&#x27;s famous 1957 book:<p>&quot;<i>The man who is denied the opportunity of taking decisions of importance begins to regard as important the decisions he is allowed to take. He becomes fussy about filing, keen on seeing that pencils are sharpened, eager to ensure that the windows are open (or shut), and apt to use two or three different-colored inks.</i>&quot;<p>How can it be that in HN a comment like this, which is all about trivialities and the personal sensitivities of the commentator, and which contributes nothing relevant to the matter at hand, receives the most upvotes? Is this comment somehow pinned to the top instead?<p>Many here seem just disparaging about Reddit, but if you want to see an actually useful and intelligent comment from someone who actually knows something about the subject, take a look here: <a href="https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;C_Programming&#x2F;comments&#x2F;18fzr1a&#x2F;a_pure_c89_implementation_of_go_channels&#x2F;kcxi4p5&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;C_Programming&#x2F;comments&#x2F;18fzr1a&#x2F;a_pu...</a>.
I&#x27;d expect at least that level from comments on HN.</div><br/><div id="38636511" class="c"><input type="checkbox" id="c-38636511" checked=""/><div class="controls bullet"><span class="by">sevagh</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635851">parent</a><span>|</span><a href="#38636580">next</a><span>|</span><label class="collapse" for="c-38636511">[-]</label><label class="expand" for="c-38636511">[5 more]</label></div><br/><div class="children"><div class="content">&gt;How can it be that in HN a comment like this, which is all about trivialities and the personal sensitivities of the commentator, and which contributes nothing relevant to the matter at hand, receives the most upvotes? Is this comment somehow pinned to the top instead?<p>I feel like purposely emphasizing C89 in your project name is meant to highlight some sort of greybeard or serious hacker aspect to it. Presumably the poster was thinking along the lines of &quot;if you&#x27;re trying to show how proficient you are with a sharp knife, here&#x27;s a list of all the ways you cut yourself with it.&quot;</div><br/><div id="38637277" class="c"><input type="checkbox" id="c-38637277" checked=""/><div class="controls bullet"><span class="by">Rochus</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636511">parent</a><span>|</span><a href="#38637264">next</a><span>|</span><label class="collapse" for="c-38637277">[-]</label><label class="expand" for="c-38637277">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a library, one of the goals of which is compatibility with the many C89 compilers still in use today, so how else should I name it? And why is it bad or provoking to have a gray beard (which sounds a lot like age discrimination to me) or to highlight a &quot;serious hacker aspect&quot;?</div><br/></div></div><div id="38637264" class="c"><input type="checkbox" id="c-38637264" checked=""/><div class="controls bullet"><span class="by">anitil</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636511">parent</a><span>|</span><a href="#38637277">prev</a><span>|</span><a href="#38638053">next</a><span>|</span><label class="collapse" for="c-38637264">[-]</label><label class="expand" for="c-38637264">[2 more]</label></div><br/><div class="children"><div class="content">For me C89 means &#x27;will build anywhere&#x27; whereas C99+ means &#x27;may or may not build anywhere&#x27;, rather than a value judgement about the author. But my background was in firmware where sometimes you were using custom compilers or very old compilers.</div><br/><div id="38638096" class="c"><input type="checkbox" id="c-38638096" checked=""/><div class="controls bullet"><span class="by">cellularmitosis</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38637264">parent</a><span>|</span><a href="#38638053">next</a><span>|</span><label class="collapse" for="c-38638096">[-]</label><label class="expand" for="c-38638096">[1 more]</label></div><br/><div class="children"><div class="content">As someone whose idea of fun is trying to compile open source software on OS X &#x2F; PowerPC, portability has a special place in my heart.  While I view open source software as a &quot;gift to the world&quot;, C89 + MIT is at the far end of the spectrum of how generous that gift is.<p><a href="https:&#x2F;&#x2F;imgflip.com&#x2F;i&#x2F;89b05r" rel="nofollow noreferrer">https:&#x2F;&#x2F;imgflip.com&#x2F;i&#x2F;89b05r</a></div><br/></div></div></div></div><div id="38638053" class="c"><input type="checkbox" id="c-38638053" checked=""/><div class="controls bullet"><span class="by">justin66</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636511">parent</a><span>|</span><a href="#38637264">prev</a><span>|</span><a href="#38636580">next</a><span>|</span><label class="collapse" for="c-38638053">[-]</label><label class="expand" for="c-38638053">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I feel like purposely emphasizing C89 in your project name is meant to highlight some sort of greybeard or serious hacker aspect to it.<p>Or indicating that it will work if you want to fold the code into a C89 project, which is not exactly a rare concern.</div><br/></div></div></div></div><div id="38636580" class="c"><input type="checkbox" id="c-38636580" checked=""/><div class="controls bullet"><span class="by">kovac</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635851">parent</a><span>|</span><a href="#38636511">prev</a><span>|</span><a href="#38637095">next</a><span>|</span><label class="collapse" for="c-38636580">[-]</label><label class="expand" for="c-38636580">[2 more]</label></div><br/><div class="children"><div class="content">What&#x27;s the name of the book?</div><br/><div id="38636632" class="c"><input type="checkbox" id="c-38636632" checked=""/><div class="controls bullet"><span class="by">Rochus</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636580">parent</a><span>|</span><a href="#38637095">next</a><span>|</span><label class="collapse" for="c-38636632">[-]</label><label class="expand" for="c-38636632">[1 more]</label></div><br/><div class="children"><div class="content">&quot;<i>Parkinson&#x27;s Law And Other Studies in Administration</i>&quot; - a very enlightening book that has lost none of its relevance.</div><br/></div></div></div></div><div id="38637095" class="c"><input type="checkbox" id="c-38637095" checked=""/><div class="controls bullet"><span class="by">RangerScience</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38635851">parent</a><span>|</span><a href="#38636580">prev</a><span>|</span><a href="#38634882">next</a><span>|</span><label class="collapse" for="c-38637095">[-]</label><label class="expand" for="c-38637095">[1 more]</label></div><br/><div class="children"><div class="content">Oh shit it me. Thank you! Time for me to reflect on this for a bit…</div><br/></div></div></div></div><div id="38634882" class="c"><input type="checkbox" id="c-38634882" checked=""/><div class="controls bullet"><span class="by">Galanwe</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38635851">prev</a><span>|</span><a href="#38633481">next</a><span>|</span><label class="collapse" for="c-38634882">[-]</label><label class="expand" for="c-38634882">[1 more]</label></div><br/><div class="children"><div class="content">&gt; It&#x27;s 2023 - even MSVC has supported C11 and C17 for a while now. C89 is no longer a feature to advertise, it&#x27;s an unhelpful constraint forcing poorer quality code.<p>Oh come on, let&#x27;s not play the language police... You are entitled to your language likings, others are not. C89 is simple, straightforward, no bells and whistles, and some people like that (I do).<p>&gt; There&#x27;s nonstandard nomenclature in &quot;_dispose&quot;; if the constructing function is called _create, the common pattern is to pair it with _destroy.<p>&quot;Nonstandard&quot; says who?<p>In my 20 years of C I&#x27;ve seen all possible combinations of _init&#x2F;_create&#x2F;_new&#x2F;_alloc _free&#x2F;_deinit&#x2F;_release&#x2F;_delete&#x2F;_destroy&#x2F;_dispose. As long as it&#x27;s consistent across the codebase, it&#x27;s fine.<p>&gt; typedefs ending with _t are reserved for standards extensions, though these days people ignore this a lot because it feels like general practice to add _t.<p>Not really. The usual convention for _t is to differentiate between raw struct names and typedef structs, such that you know whether you have to prefix &quot;struct&quot; during declaration. i.e. `struct foo {}`&#x2F;`typedef struct {} foo_t`<p>&gt; Both _select functions fall short in that they do not allow select&#x27;ing on channels + other file descriptors simultaneously.<p>Good point</div><br/></div></div><div id="38633481" class="c"><input type="checkbox" id="c-38633481" checked=""/><div class="controls bullet"><span class="by">coumbaya</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38634882">prev</a><span>|</span><a href="#38636241">next</a><span>|</span><label class="collapse" for="c-38633481">[-]</label><label class="expand" for="c-38633481">[3 more]</label></div><br/><div class="children"><div class="content">Not dismissing anything you said but bool isn&#x27;t C89 right ?
Back ~6 years ago when I worked in embedded C89, bool was just a #define true (1==1), #define false (0==1) so I guess it makes sense it isn&#x27;t in the lib ?</div><br/><div id="38633553" class="c"><input type="checkbox" id="c-38633553" checked=""/><div class="controls bullet"><span class="by">eqvinox</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633481">parent</a><span>|</span><a href="#38636241">next</a><span>|</span><label class="collapse" for="c-38633553">[-]</label><label class="expand" for="c-38633553">[2 more]</label></div><br/><div class="children"><div class="content">Indeed, bool (or _Bool) was added in C99, hence my pointing out it not being used… it&#x27;s not in C89.<p>It matters because the return value sense is different;  an &quot;int&quot; return for a status-ish thing in a modern library generally means 0 for success, nonzero for error codes.  &quot;bool&quot; is the other way around, 0 for failure-y.  In this case it&#x27;s a status retrieval function so it&#x27;s pretty clear that it&#x27;s intended as a boolean but it&#x27;d still be better to actually make it bool.</div><br/><div id="38633954" class="c"><input type="checkbox" id="c-38633954" checked=""/><div class="controls bullet"><span class="by">coumbaya</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38633553">parent</a><span>|</span><a href="#38636241">next</a><span>|</span><label class="collapse" for="c-38633954">[-]</label><label class="expand" for="c-38633954">[1 more]</label></div><br/><div class="children"><div class="content">Ah, I get it now, thx.</div><br/></div></div></div></div></div></div><div id="38636241" class="c"><input type="checkbox" id="c-38636241" checked=""/><div class="controls bullet"><span class="by">jjgreen</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38633481">prev</a><span>|</span><a href="#38638139">next</a><span>|</span><label class="collapse" for="c-38636241">[-]</label><label class="expand" for="c-38636241">[1 more]</label></div><br/><div class="children"><div class="content">IIRC, reservation of _t in typedefs is for the POSIX rather than C standards.</div><br/></div></div><div id="38638139" class="c"><input type="checkbox" id="c-38638139" checked=""/><div class="controls bullet"><span class="by">buildartefact</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38636241">prev</a><span>|</span><a href="#38634351">next</a><span>|</span><label class="collapse" for="c-38638139">[-]</label><label class="expand" for="c-38638139">[1 more]</label></div><br/><div class="children"><div class="content">Do you know of a good style guide that encapsulates common conventions like create&#x2F;destroy?</div><br/></div></div><div id="38634351" class="c"><input type="checkbox" id="c-38634351" checked=""/><div class="controls bullet"><span class="by">pengaru</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38638139">prev</a><span>|</span><a href="#38634083">next</a><span>|</span><label class="collapse" for="c-38634351">[-]</label><label class="expand" for="c-38634351">[1 more]</label></div><br/><div class="children"><div class="content">The standards extensions reservation of _t is such a non-issue I don&#x27;t understand why people even bother mentioning it anymore.<p>It&#x27;s become such a common practice to suffix your typedefs with _t it&#x27;s practically a de facto standard at this point.<p>Since everyone&#x27;s already namespacing types with some kind of prefix, I don&#x27;t see the problem nor have I ever experienced a negative consequence after decades of writing C this way.</div><br/></div></div><div id="38634083" class="c"><input type="checkbox" id="c-38634083" checked=""/><div class="controls bullet"><span class="by">sylware</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38634351">prev</a><span>|</span><a href="#38634923">next</a><span>|</span><label class="collapse" for="c-38634083">[-]</label><label class="expand" for="c-38634083">[9 more]</label></div><br/><div class="children"><div class="content">Even C has already a syntax way too rich and complex (and C11 and C17 tantrums are making things worse).<p>Integer promotion should go, like implicit cast for anything except void* and literals, but we are missing a dynamic&#x2F;static casts syntax explicit split.
Only one loop keyword, loop {}, no switch, no anonymous block, no &quot;a?b:c&quot; operator. typedef has to go, (and typeof,generic,etc), the variable arguments of preprocessor function should be defined once and for all. __thread must go as tls should be managed dynamically and explicitely with the system interface, never statically and hidden by the runtime.
Only sized primitive types (u8&#x2F;s8...). That said, anonymous union&#x2F;struct are very nice for complex memory layout.<p>And all the things I am forgetting right now.<p>With the pre-processor and coding discipline you can get close to that already, but I was told that what I am describing is basically the simplicity of rust syntax, true? Namely it is easier to write a naive rust compiler than a C compiler?</div><br/><div id="38634354" class="c"><input type="checkbox" id="c-38634354" checked=""/><div class="controls bullet"><span class="by">IlliOnato</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634083">parent</a><span>|</span><a href="#38638388">next</a><span>|</span><label class="collapse" for="c-38634354">[-]</label><label class="expand" for="c-38634354">[6 more]</label></div><br/><div class="children"><div class="content">What&#x27;s wrong with ternary operator (&quot;a?b:c&quot;) ? It seems many people hate it but I&#x27;ve never seen a reason for it.<p>This operator is very useful and uncontroversial in Perl, it&#x27;s normal (and quite readable) in selecting a value for assignment. One is expected to use good practices with it, but it is nice.<p>Is the problem the fact that in C you can use it instead of if, selecting not values but actions, like (a &gt; b) ? printf(&quot;A&quot;) : printf(&quot;B&quot;);</div><br/><div id="38634661" class="c"><input type="checkbox" id="c-38634661" checked=""/><div class="controls bullet"><span class="by">zogrodea</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634354">parent</a><span>|</span><a href="#38635409">next</a><span>|</span><label class="collapse" for="c-38634661">[-]</label><label class="expand" for="c-38634661">[3 more]</label></div><br/><div class="children"><div class="content">I (a different person replying to your post) don&#x27;t mind ternary operators, but I do prefer if-expressions which convey the same thing semantically but can be nicer to read (and also way better when chaining else-if ladders - nested ternaries can be a nightmare to read). <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;a&#x2F;46843369" rel="nofollow noreferrer">https:&#x2F;&#x2F;stackoverflow.com&#x2F;a&#x2F;46843369</a></div><br/><div id="38636986" class="c"><input type="checkbox" id="c-38636986" checked=""/><div class="controls bullet"><span class="by">8372049</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634661">parent</a><span>|</span><a href="#38635409">next</a><span>|</span><label class="collapse" for="c-38636986">[-]</label><label class="expand" for="c-38636986">[2 more]</label></div><br/><div class="children"><div class="content">To me personally, the use case for ?: is selecting a value for a const:<p><pre><code>    const value = cond ? a : b;
</code></pre>
Using an if instead would mean you can&#x27;t make it const, and is usually more convoluted to read.<p>For pretty much all other use cases, I agree that ifs are better.</div><br/><div id="38639021" class="c"><input type="checkbox" id="c-38639021" checked=""/><div class="controls bullet"><span class="by">kevindamm</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38636986">parent</a><span>|</span><a href="#38635409">next</a><span>|</span><label class="collapse" for="c-38639021">[-]</label><label class="expand" for="c-38639021">[1 more]</label></div><br/><div class="children"><div class="content">In that case you can have the result of a function call be assigned to the const, and the function be the if&#x2F;else for the value.  With a well-named function it can even be more readable than the ternary.</div><br/></div></div></div></div></div></div><div id="38635409" class="c"><input type="checkbox" id="c-38635409" checked=""/><div class="controls bullet"><span class="by">dgfitz</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634354">parent</a><span>|</span><a href="#38634661">prev</a><span>|</span><a href="#38636618">next</a><span>|</span><label class="collapse" for="c-38635409">[-]</label><label class="expand" for="c-38635409">[1 more]</label></div><br/><div class="children"><div class="content">I don’t like them because they’re easy to write and a pain to deal with later. My biggest irritation comes when I’d like to break inside the if or else clause of a ternary and can’t. There is also more mental overhead to parse and keep in the mental stack.<p>I have also seen them used cleanly and beautifully, but that is a rare occurrence.</div><br/></div></div><div id="38636618" class="c"><input type="checkbox" id="c-38636618" checked=""/><div class="controls bullet"><span class="by">speed_spread</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634354">parent</a><span>|</span><a href="#38635409">prev</a><span>|</span><a href="#38638388">next</a><span>|</span><label class="collapse" for="c-38636618">[-]</label><label class="expand" for="c-38636618">[1 more]</label></div><br/><div class="children"><div class="content">I like the ternary too but to pretend that it&#x27;s ok because it&#x27;s useful in perl is more of a counter argument...</div><br/></div></div></div></div><div id="38638388" class="c"><input type="checkbox" id="c-38638388" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634083">parent</a><span>|</span><a href="#38634354">prev</a><span>|</span><a href="#38638526">next</a><span>|</span><label class="collapse" for="c-38638388">[-]</label><label class="expand" for="c-38638388">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Namely it is easier to write a naive rust compiler than a C compiler?<p>You must be joking.</div><br/></div></div><div id="38638526" class="c"><input type="checkbox" id="c-38638526" checked=""/><div class="controls bullet"><span class="by">cellularmitosis</span><span>|</span><a href="#38633438">root</a><span>|</span><a href="#38634083">parent</a><span>|</span><a href="#38638388">prev</a><span>|</span><a href="#38634923">next</a><span>|</span><label class="collapse" for="c-38638526">[-]</label><label class="expand" for="c-38638526">[1 more]</label></div><br/><div class="children"><div class="content">Easier to write a rust compiler than a C compiler?  I must be somehow misinterpreting this.</div><br/></div></div></div></div><div id="38634923" class="c"><input type="checkbox" id="c-38634923" checked=""/><div class="controls bullet"><span class="by">dekhn</span><span>|</span><a href="#38633438">parent</a><span>|</span><a href="#38634083">prev</a><span>|</span><a href="#38633477">next</a><span>|</span><label class="collapse" for="c-38634923">[-]</label><label class="expand" for="c-38634923">[1 more]</label></div><br/><div class="children"><div class="content">I feel like this comment could be best structured in the form of a series of commits sent as a combined Merge Request.<p>First, a commit to change the docs to say it&#x27;s a pure C99 (or C11 or C17) implementation.<p>Second, for each of your points, a single commit fixing each style issue (_dispose -&gt; _destroy, typedefs).<p>Seperately, another MR with the commit for _select improvements.<p>Or maybe just send the C99 one first, and if that gets rejected, don&#x27;t bother with the rest.</div><br/></div></div></div></div><div id="38633477" class="c"><input type="checkbox" id="c-38633477" checked=""/><div class="controls bullet"><span class="by">vore</span><span>|</span><a href="#38633438">prev</a><span>|</span><a href="#38634866">next</a><span>|</span><label class="collapse" for="c-38633477">[-]</label><label class="expand" for="c-38633477">[4 more]</label></div><br/><div class="children"><div class="content">while (!CspChan_closed(chan)) { ... } seems like a concurrency footgun – what&#x27;s stopping the channel from being closed in between the check for it being closed and the operation on the channel?</div><br/><div id="38636671" class="c"><input type="checkbox" id="c-38636671" checked=""/><div class="controls bullet"><span class="by">codys</span><span>|</span><a href="#38633477">parent</a><span>|</span><a href="#38634616">next</a><span>|</span><label class="collapse" for="c-38636671">[-]</label><label class="expand" for="c-38636671">[2 more]</label></div><br/><div class="children"><div class="content">Nothing stops that. You&#x27;ll end up getting a message full of 0 bytes (messages are fixed size) if it closes between the `closed()` check and the `receive()` operation. Common designs in this space instead indicate if the receive call has obtained data (return values typically indicate this). This is a kind of time-of-check&#x2F;time-of-use bug.<p>Go, for its part, has its receive operation, `&lt;-`, return a status indicating if the channel is still open, as in `v, ok := &lt;-ch`</div><br/><div id="38637987" class="c"><input type="checkbox" id="c-38637987" checked=""/><div class="controls bullet"><span class="by">vore</span><span>|</span><a href="#38633477">root</a><span>|</span><a href="#38636671">parent</a><span>|</span><a href="#38634616">next</a><span>|</span><label class="collapse" for="c-38637987">[-]</label><label class="expand" for="c-38637987">[1 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think CspChan_closed is a super useful operation if using it is always prone to TOCTTOU issues – maybe as an optimization hint but that&#x27;s about it. In Go, the receive operation indicating the channel is closed is atomic with receiving a value, so it&#x27;s not possible to have a TOCTTOU problem there.</div><br/></div></div></div></div><div id="38634616" class="c"><input type="checkbox" id="c-38634616" checked=""/><div class="controls bullet"><span class="by">withinboredom</span><span>|</span><a href="#38633477">parent</a><span>|</span><a href="#38636671">prev</a><span>|</span><a href="#38634866">next</a><span>|</span><label class="collapse" for="c-38634616">[-]</label><label class="expand" for="c-38634616">[1 more]</label></div><br/><div class="children"><div class="content">And further, what if there are messages still in the closed channel? Do they just go &quot;poof&quot;? It&#x27;s fine if they do, but that should be documented.</div><br/></div></div></div></div><div id="38634866" class="c"><input type="checkbox" id="c-38634866" checked=""/><div class="controls bullet"><span class="by">iainmerrick</span><span>|</span><a href="#38633477">prev</a><span>|</span><a href="#38633497">next</a><span>|</span><label class="collapse" for="c-38634866">[-]</label><label class="expand" for="c-38634866">[6 more]</label></div><br/><div class="children"><div class="content">Sorry for going a bit off-topic, but something I&#x27;m curious about: are channels thought to be a good&#x2F;useful tool for concurrent programming?<p>My feeling is that they&#x27;re probably too low-level and error-prone, and you really want higher-level structures like worker pools or actors. So as a concurrency building block they&#x27;d be on the same abstraction level as pthreads or Java monitors -- nice and flexible for building on top of, but too finicky to be used <i>directly</i> in application code.<p>But I&#x27;m not a Go expert, and maybe Go programmers do successfully use channels directly for application code?</div><br/><div id="38635532" class="c"><input type="checkbox" id="c-38635532" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#38634866">parent</a><span>|</span><a href="#38634944">next</a><span>|</span><label class="collapse" for="c-38635532">[-]</label><label class="expand" for="c-38635532">[4 more]</label></div><br/><div class="children"><div class="content">I program in Go a lot professionally. I use channels a decent amount of the time, but often drop down to using mutexes or atomics. But I generally prefer channels to mutexes and atomics; generally I reach for those alternatives only due to performance concerns.<p>One thing that struck me about your comment is referring to actors as a “higher level structure” compared to channels. Comparing Go channels with the actor model is more a matter of apples and oranges than one being more high level than the other. Go is built on the Communicating Sequential Processes (CSP) model: <a href="https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Communicating_sequential_processes" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;Communicating_sequential_pro...</a> . See the comparison to the actor model in that article if you are curious. The essential idea to CSP is that you have independent processes that only communicate with each other via these channels. This is in comparison to the actor mode where each process has its own dedicated “mailbox” that it can receive from (but can send messages to any other actor it wants). I think that wiki does a better job of outlining the differences than I can in a comment, but essentially these are two similar but subtly different ways to model parallelism.<p>Personally, I find the CSP model a bit more intuitive than the actor model (though admittedly I have not worked with the actor model as extensively). For the basic idea of “make a process that receives input data, processes it, and submits output data somewhere else” CSP and the actor model are more or less identical. But for more complex use cases, like a process that can receive multiple kinds of messages from different places, or having multiple processes all handling the same stream of incoming data (aka load balancing) I find the CSP model more intuitive. This might be personal bias though. In particular I’ve never seen an actor model with static types and how that would handle different types of messages coming into the mailbox.<p>Short answer: channels for concurrent programming is definitely a good tool.</div><br/><div id="38636258" class="c"><input type="checkbox" id="c-38636258" checked=""/><div class="controls bullet"><span class="by">iainmerrick</span><span>|</span><a href="#38634866">root</a><span>|</span><a href="#38635532">parent</a><span>|</span><a href="#38637602">next</a><span>|</span><label class="collapse" for="c-38636258">[-]</label><label class="expand" for="c-38636258">[2 more]</label></div><br/><div class="children"><div class="content"><i>Personally, I find the CSP model a bit more intuitive than the actor model (though admittedly I have not worked with the actor model as extensively).</i><p>That’s really the question I was trying to ask -- is the CSP style suitably intuitive for general-purpose use? I personally find other primitives easier to use, but that could well just be my bias.<p>(I’ve done some academic work around process calculi, a long time ago now, and I always found the CSP style much more awkward than CCS &#x2F; π-calculus.)<p><i>I’ve never seen an actor model with static types and how that would handle different types of messages coming into the mailbox.</i><p>I think it fits really well in an OO approach, where your messages just become method calls on the actor object -- I believe Swift does that.<p>That transformation of a method call into a message struct is a kind of defunctionalization, which is a really useful technique (in e.g. Redux) but usually involves a ton of boilerplate. Having a core language primitive that gives you defunctionalization <i>and</i> concurrency, now that’s interesting. I feel like that’s something I would end up building by hand on top of channels (I haven’t done that in Go, but I have for web workers).</div><br/><div id="38636802" class="c"><input type="checkbox" id="c-38636802" checked=""/><div class="controls bullet"><span class="by">openasocket</span><span>|</span><a href="#38634866">root</a><span>|</span><a href="#38636258">parent</a><span>|</span><a href="#38637602">next</a><span>|</span><label class="collapse" for="c-38636802">[-]</label><label class="expand" for="c-38636802">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I think it fits really well in an OO approach, where your messages just become method calls on the actor object -- I believe Swift does that.<p>That’s definitely true. Here’s what I think of as a motivating example: consider a process that takes input data in an input channel, provides some sort of enrichment, and writes the result to an output channel. Simple, right? Now imagine that enrichment requires some sort of configuration data. And that’s mostly static, but there are regular updates to that configuration that are provided by some sort of side channel. In the CSP model, that’s fine: have the process read from two channels, one with input data and the other with updated configuration data. In the Actor model, you have to read from your mailbox, check if this is an input message or a configuration update, and act accordingly. There’s no sort of OO approach that makes that switch statement feel “natural.” I feel that there’s no point into trying to shoehorn both that input data and configuration updates into the same message queue. Any attempt to do so in a clean way is basically just putting arbitrary functions onto a queue.<p>That said, I recognize that, beyond certain edge cases, the two models are logically equivalent.</div><br/></div></div></div></div><div id="38637602" class="c"><input type="checkbox" id="c-38637602" checked=""/><div class="controls bullet"><span class="by">jen20</span><span>|</span><a href="#38634866">root</a><span>|</span><a href="#38635532">parent</a><span>|</span><a href="#38636258">prev</a><span>|</span><a href="#38634944">next</a><span>|</span><label class="collapse" for="c-38637602">[-]</label><label class="expand" for="c-38637602">[1 more]</label></div><br/><div class="children"><div class="content">&gt; In particular I’ve never seen an actor model with static types and how that would handle different types of messages coming into the mailbox.<p>This is what sum types give you, or dynamic handler registration if you need to support runtime-configurable message types (perhaps plugins or something).<p>There’s a good article about Tokio tasks as actors: <a href="https:&#x2F;&#x2F;ryhl.io&#x2F;blog&#x2F;actors-with-tokio&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;ryhl.io&#x2F;blog&#x2F;actors-with-tokio&#x2F;</a><p>Of course, these still use channels!</div><br/></div></div></div></div><div id="38634944" class="c"><input type="checkbox" id="c-38634944" checked=""/><div class="controls bullet"><span class="by">JyB</span><span>|</span><a href="#38634866">parent</a><span>|</span><a href="#38635532">prev</a><span>|</span><a href="#38633497">next</a><span>|</span><label class="collapse" for="c-38634944">[-]</label><label class="expand" for="c-38634944">[1 more]</label></div><br/><div class="children"><div class="content">The opposite. Channels are often used to orchestrate higher-level structures&#x2F;abstractions; not &#x27;low-level&#x27; stuff where more common primitives such as mutexes&#x2F;semaphores are sometime preferred.</div><br/></div></div></div></div><div id="38633497" class="c"><input type="checkbox" id="c-38633497" checked=""/><div class="controls bullet"><span class="by">rockwotj</span><span>|</span><a href="#38634866">prev</a><span>|</span><a href="#38633708">next</a><span>|</span><label class="collapse" for="c-38633497">[-]</label><label class="expand" for="c-38633497">[2 more]</label></div><br/><div class="children"><div class="content">Related is libmill, which has been around for awhile and is was previously discussed on HN: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30699829">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=30699829</a><p>libmill supports a bunch of stuff like sockets, timers, files, etc.</div><br/><div id="38638185" class="c"><input type="checkbox" id="c-38638185" checked=""/><div class="controls bullet"><span class="by">adastra22</span><span>|</span><a href="#38633497">parent</a><span>|</span><a href="#38633708">next</a><span>|</span><label class="collapse" for="c-38638185">[-]</label><label class="expand" for="c-38638185">[1 more]</label></div><br/><div class="children"><div class="content">Domains are expired. Do you have other links?</div><br/></div></div></div></div><div id="38633708" class="c"><input type="checkbox" id="c-38633708" checked=""/><div class="controls bullet"><span class="by">mmcgaha</span><span>|</span><a href="#38633497">prev</a><span>|</span><a href="#38633768">next</a><span>|</span><label class="collapse" for="c-38633708">[-]</label><label class="expand" for="c-38633708">[1 more]</label></div><br/><div class="children"><div class="content">When it said pure C89 I figured it was going to have some setjmp and longjmp going on instead of threads.</div><br/></div></div><div id="38633768" class="c"><input type="checkbox" id="c-38633768" checked=""/><div class="controls bullet"><span class="by">galkk</span><span>|</span><a href="#38633708">prev</a><span>|</span><a href="#38633965">next</a><span>|</span><label class="collapse" for="c-38633768">[-]</label><label class="expand" for="c-38633768">[9 more]</label></div><br/><div class="children"><div class="content">Even looking at simple code example, with casting from&#x2F;to void<i>, returning 0 as void</i> etc, I cannot understand how people are calling C easy and productive language</div><br/><div id="38634528" class="c"><input type="checkbox" id="c-38634528" checked=""/><div class="controls bullet"><span class="by">zeroCalories</span><span>|</span><a href="#38633768">parent</a><span>|</span><a href="#38637558">next</a><span>|</span><label class="collapse" for="c-38634528">[-]</label><label class="expand" for="c-38634528">[1 more]</label></div><br/><div class="children"><div class="content">Despite all of the scary casting, there is fairly little you need to know about C to understand what&#x27;s going on.</div><br/></div></div><div id="38637558" class="c"><input type="checkbox" id="c-38637558" checked=""/><div class="controls bullet"><span class="by">codys</span><span>|</span><a href="#38633768">parent</a><span>|</span><a href="#38634528">prev</a><span>|</span><a href="#38633815">next</a><span>|</span><label class="collapse" for="c-38637558">[-]</label><label class="expand" for="c-38637558">[1 more]</label></div><br/><div class="children"><div class="content">The things you&#x27;ve described are either not required or often considered bad style in C even though they are valid C.<p>Casting to&#x2F;from `void *` isn&#x27;t needed in C, and is commonly against coding conventions, like those used by the Linux kernel.<p>One would generally return `NULL` instead of `0` as `void *`.<p>But yes, it is possible to write some funky C code that could be technically correct but still not be considered good.</div><br/></div></div><div id="38633815" class="c"><input type="checkbox" id="c-38633815" checked=""/><div class="controls bullet"><span class="by">vngzs</span><span>|</span><a href="#38633768">parent</a><span>|</span><a href="#38637558">prev</a><span>|</span><a href="#38634654">next</a><span>|</span><label class="collapse" for="c-38633815">[-]</label><label class="expand" for="c-38633815">[4 more]</label></div><br/><div class="children"><div class="content">That claim isn&#x27;t made on the linked site, though. I think people who write C nowadays tend to be working in the drivers and OS development spaces.</div><br/><div id="38637984" class="c"><input type="checkbox" id="c-38637984" checked=""/><div class="controls bullet"><span class="by">0xbadcafebee</span><span>|</span><a href="#38633768">root</a><span>|</span><a href="#38633815">parent</a><span>|</span><a href="#38636063">next</a><span>|</span><label class="collapse" for="c-38637984">[-]</label><label class="expand" for="c-38637984">[1 more]</label></div><br/><div class="children"><div class="content">There&#x27;s at least 4 kinds of C programmers today:<p>- People who work on projects which require low-level access, potentially mixing in assembly code (drivers, OS, etc), porting to different architectures, real-time, high-precision, control of timing, lack of MMU, etc<p>- People who want to perform specific actions, like a specific OS syscall, that may not be exposed [easily] by a higher level language in the way the programmer wants<p>- People who want to write very fast&#x2F;efficient code<p>- Legacy code maintainers<p>Not too long ago I busted out some C to create a stripped binary for a job interview round. The interviewee needed to diagnose what the binary was doing and why and report back. Not all that common for most programmers today, but I expect a good amount of detail from a senior-level systems candidate.</div><br/></div></div><div id="38636063" class="c"><input type="checkbox" id="c-38636063" checked=""/><div class="controls bullet"><span class="by">trealira</span><span>|</span><a href="#38633768">root</a><span>|</span><a href="#38633815">parent</a><span>|</span><a href="#38637984">prev</a><span>|</span><a href="#38634654">next</a><span>|</span><label class="collapse" for="c-38636063">[-]</label><label class="expand" for="c-38636063">[2 more]</label></div><br/><div class="children"><div class="content">&gt; I think people who write C nowadays tend to be working in the drivers and OS development spaces.<p>I think it&#x27;s also students; I think some people are still taught C as their first programming language. If you go on r&#x2F;C_programming on Reddit, a lot of it is filled by very basic questions from what seem like beginners; I suspect they&#x27;re students trying to do their homework.</div><br/><div id="38637651" class="c"><input type="checkbox" id="c-38637651" checked=""/><div class="controls bullet"><span class="by">kristianp</span><span>|</span><a href="#38633768">root</a><span>|</span><a href="#38636063">parent</a><span>|</span><a href="#38634654">next</a><span>|</span><label class="collapse" for="c-38637651">[-]</label><label class="expand" for="c-38637651">[1 more]</label></div><br/><div class="children"><div class="content">Perhaps not the first language. In my experience C is often in the second batch of languages after the introductory one (java back in my day).</div><br/></div></div></div></div></div></div><div id="38634654" class="c"><input type="checkbox" id="c-38634654" checked=""/><div class="controls bullet"><span class="by">SAI_Peregrinus</span><span>|</span><a href="#38633768">parent</a><span>|</span><a href="#38633815">prev</a><span>|</span><a href="#38633989">next</a><span>|</span><label class="collapse" for="c-38634654">[-]</label><label class="expand" for="c-38634654">[1 more]</label></div><br/><div class="children"><div class="content">C is a <i>small</i> language. It&#x27;s not simple, nor is it easy.<p>Brainfuck is a tiny language.<p>C++ is a gigantic language.<p>Language size and ease of use are not directly related.</div><br/></div></div><div id="38633989" class="c"><input type="checkbox" id="c-38633989" checked=""/><div class="controls bullet"><span class="by">salawat</span><span>|</span><a href="#38633768">parent</a><span>|</span><a href="#38634654">prev</a><span>|</span><a href="#38633965">next</a><span>|</span><label class="collapse" for="c-38633989">[-]</label><label class="expand" for="c-38633989">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re making bits dance through hardware with minimal overhead or layers of abstraction&#x2F;other programmer&#x27;s opinions to deal with.<p>I call that productive.<p>Further, you have the smallest API&#x2F;ABI stdlib to work through the quirks of of any language. Again. Productive.<p>I, of course, take the precaution of allocating time to blow up 5&#x2F;8 of a solar system&#x2F;a star into my projects. I have a tendency to find ways to do things other than intended, and like to absorb the lessons.<p>As a result, I have quite the collection of ways not to do things, or how to do things other than I intended. Just because your management fu disagrees with my definition of productive is not my concern.</div><br/></div></div></div></div><div id="38633965" class="c"><input type="checkbox" id="c-38633965" checked=""/><div class="controls bullet"><span class="by">p_l</span><span>|</span><a href="#38633768">prev</a><span>|</span><a href="#38636566">next</a><span>|</span><label class="collapse" for="c-38633965">[-]</label><label class="expand" for="c-38633965">[1 more]</label></div><br/><div class="children"><div class="content">fun fact - Go Channels started out as pretty thin syntax sugar over features provided by Plan9&#x27;s C libthread.</div><br/></div></div><div id="38636566" class="c"><input type="checkbox" id="c-38636566" checked=""/><div class="controls bullet"><span class="by">solid_fuel</span><span>|</span><a href="#38633965">prev</a><span>|</span><a href="#38634674">next</a><span>|</span><label class="collapse" for="c-38636566">[-]</label><label class="expand" for="c-38636566">[1 more]</label></div><br/><div class="children"><div class="content">I love seeing projects like this, thanks for sharing.  I&#x27;ve worked in constrained environments before where anything past C89 was trouble, it&#x27;s a nice target for portability even if it takes more work.</div><br/></div></div><div id="38634674" class="c"><input type="checkbox" id="c-38634674" checked=""/><div class="controls bullet"><span class="by">segmondy</span><span>|</span><a href="#38636566">prev</a><span>|</span><a href="#38633419">next</a><span>|</span><label class="collapse" for="c-38634674">[-]</label><label class="expand" for="c-38634674">[1 more]</label></div><br/><div class="children"><div class="content">if you don&#x27;t get anything out of this and don&#x27;t know Hoare&#x27;s work, go read CSP - <a href="http:&#x2F;&#x2F;www.usingcsp.com&#x2F;cspbook.pdf" rel="nofollow noreferrer">http:&#x2F;&#x2F;www.usingcsp.com&#x2F;cspbook.pdf</a></div><br/></div></div><div id="38633419" class="c"><input type="checkbox" id="c-38633419" checked=""/><div class="controls bullet"><span class="by">sim7c00</span><span>|</span><a href="#38634674">prev</a><span>|</span><a href="#38635515">next</a><span>|</span><label class="collapse" for="c-38633419">[-]</label><label class="expand" for="c-38633419">[1 more]</label></div><br/><div class="children"><div class="content">not being a god level programmer i wont go into quality of code, but this looks to me really neat and easy to use. well done!</div><br/></div></div><div id="38635515" class="c"><input type="checkbox" id="c-38635515" checked=""/><div class="controls bullet"><span class="by">flkenosad</span><span>|</span><a href="#38633419">prev</a><span>|</span><a href="#38633654">next</a><span>|</span><label class="collapse" for="c-38635515">[-]</label><label class="expand" for="c-38635515">[1 more]</label></div><br/><div class="children"><div class="content">Brilliant. Thank you so much!</div><br/></div></div><div id="38633654" class="c"><input type="checkbox" id="c-38633654" checked=""/><div class="controls bullet"><span class="by">bufo</span><span>|</span><a href="#38635515">prev</a><span>|</span><a href="#38634743">next</a><span>|</span><label class="collapse" for="c-38633654">[-]</label><label class="expand" for="c-38633654">[4 more]</label></div><br/><div class="children"><div class="content">Great! I was looking into something like this. I assume ending up with epoll will be better?</div><br/><div id="38633743" class="c"><input type="checkbox" id="c-38633743" checked=""/><div class="controls bullet"><span class="by">eqvinox</span><span>|</span><a href="#38633654">parent</a><span>|</span><a href="#38634743">next</a><span>|</span><label class="collapse" for="c-38633743">[-]</label><label class="expand" for="c-38633743">[3 more]</label></div><br/><div class="children"><div class="content">Considering that epoll is Linux specific anyway, I would highly advise going straight to io_uring.  epoll has a whole bunch of footguns in particular with edge triggered modes of operation;  io_uring has a higher initial threshold in understanding how it works but is worth that effort.<p>(Unless you need to support older Linux kernels that have epoll but no io_uring yet.)</div><br/><div id="38634635" class="c"><input type="checkbox" id="c-38634635" checked=""/><div class="controls bullet"><span class="by">bufo</span><span>|</span><a href="#38633654">root</a><span>|</span><a href="#38633743">parent</a><span>|</span><a href="#38634743">next</a><span>|</span><label class="collapse" for="c-38634635">[-]</label><label class="expand" for="c-38634635">[2 more]</label></div><br/><div class="children"><div class="content">Oh yeah I meant io_uring too. Plus Windows copied it so you can implement things very similarly for Windows.</div><br/><div id="38638216" class="c"><input type="checkbox" id="c-38638216" checked=""/><div class="controls bullet"><span class="by">adastra22</span><span>|</span><a href="#38633654">root</a><span>|</span><a href="#38634635">parent</a><span>|</span><a href="#38634743">next</a><span>|</span><label class="collapse" for="c-38638216">[-]</label><label class="expand" for="c-38638216">[1 more]</label></div><br/><div class="children"><div class="content">Is there something similar on macOS&#x2F;iOS?</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>