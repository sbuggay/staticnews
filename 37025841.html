<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1691398881124" as="style"/><link rel="stylesheet" href="styles.css?v=1691398881124"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/lucavallin/barco">Barco: Linux Containers from Scratch in C</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>lcvln</span> | <span>55 comments</span></div><br/><div><div id="37032028" class="c"><input type="checkbox" id="c-37032028" checked=""/><div class="controls bullet"><span class="by">elcapitan</span><span>|</span><a href="#37031697">next</a><span>|</span><label class="collapse" for="c-37032028">[-]</label><label class="expand" for="c-37032028">[1 more]</label></div><br/><div class="children"><div class="content">Just came to say that this is a very nicely set up C project, understandable structure and simple Makefile, very beginner friendly, congrats :)</div><br/></div></div><div id="37031697" class="c"><input type="checkbox" id="c-37031697" checked=""/><div class="controls bullet"><span class="by">nedt</span><span>|</span><a href="#37032028">prev</a><span>|</span><a href="#37025842">next</a><span>|</span><label class="collapse" for="c-37031697">[-]</label><label class="expand" for="c-37031697">[1 more]</label></div><br/><div class="children"><div class="content">When I did a talk about docker I also wanted to show a bit of what it does under the hood without going through all the layers and without too much details. This ~120 lines of shell script is really good in providing just an intro into what&#x27;s needed for containers: <a href="https:&#x2F;&#x2F;github.com&#x2F;p8952&#x2F;bocker&#x2F;blob&#x2F;master&#x2F;bocker">https:&#x2F;&#x2F;github.com&#x2F;p8952&#x2F;bocker&#x2F;blob&#x2F;master&#x2F;bocker</a>
(not mine)</div><br/></div></div><div id="37025842" class="c"><input type="checkbox" id="c-37025842" checked=""/><div class="controls bullet"><span class="by">lcvln</span><span>|</span><a href="#37031697">prev</a><span>|</span><a href="#37026411">next</a><span>|</span><label class="collapse" for="c-37025842">[-]</label><label class="expand" for="c-37025842">[18 more]</label></div><br/><div class="children"><div class="content">barco is a project I worked on to learn more about Linux containers and the Linux kernel, based on other guides on the internet.</div><br/><div id="37029938" class="c"><input type="checkbox" id="c-37029938" checked=""/><div class="controls bullet"><span class="by">teleforce</span><span>|</span><a href="#37025842">parent</a><span>|</span><a href="#37029602">next</a><span>|</span><label class="collapse" for="c-37029938">[-]</label><label class="expand" for="c-37029938">[10 more]</label></div><br/><div class="children"><div class="content">Looks like a good project to learn container from scratch.<p>Just wondering the main reason you&#x27;re C since most of the container project now seems to be using Go or Rust?</div><br/><div id="37029967" class="c"><input type="checkbox" id="c-37029967" checked=""/><div class="controls bullet"><span class="by">cyphar</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37029938">parent</a><span>|</span><a href="#37030307">next</a><span>|</span><label class="collapse" for="c-37029967">[-]</label><label class="expand" for="c-37029967">[6 more]</label></div><br/><div class="children"><div class="content">As the maintainer of a Go container runtime (runc), and having worked with Rust in various other projects, while they can be better languages for building large projects, they make it harder to understand what exactly your program is doing when writing software like this.<p>One example that immediately comes to mind from Rust is a bug with O_PATH file descriptors I found a while ago[1], which would&#x27;ve made certain code we use in runc not work. And from Go, here is a bug I just found in their code for handling file descriptors for ForkExec[2] which is causing issues in a runc patch I&#x27;m working on. Neither of these issues exist in C programs. Though of course, C programs have their own issues. For better or worse, the Linux kernel APIs are easiest to use from C.<p>In runc we actually implement the core container setup code in C because Go doesn&#x27;t allow you to do everything we need for setting up a container (it has gotten better though, in the past it was completely impossible to set up a container properly in pure Go -- now you can set one up but there are still certain configurations that are not possible to implement in pure Go, such as &quot;docker exec&quot;). You also cannot run Go in single-threaded mode, which means that certain kernel APIs (unshare(CLONE_NEWUSER) for instance) simply cannot be used from regular Go code.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;62314">https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;62314</a>
[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;golang&#x2F;go&#x2F;issues&#x2F;61751">https:&#x2F;&#x2F;github.com&#x2F;golang&#x2F;go&#x2F;issues&#x2F;61751</a></div><br/><div id="37031377" class="c"><input type="checkbox" id="c-37031377" checked=""/><div class="controls bullet"><span class="by">kouteiheika</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37029967">parent</a><span>|</span><a href="#37030699">next</a><span>|</span><label class="collapse" for="c-37031377">[-]</label><label class="expand" for="c-37031377">[1 more]</label></div><br/><div class="children"><div class="content">&gt; One example that immediately comes to mind from Rust is a bug with O_PATH file descriptors I found a while ago[1], which would&#x27;ve made certain code we use in runc not work. [...] Neither of these issues exist in C programs.<p>This issue doesn&#x27;t intrinsically affect Rust as a language (when compared to C), because you can just do exactly the same thing as you&#x27;d have done in C:<p><pre><code>    let fd = libc::open(b&quot;&#x2F;path\0&quot;.as_ptr().cast(), libc::libc::O_CLOEXEC | libc::O_PATH);
</code></pre>
Or just make the syscall directly-ish:<p><pre><code>    let fd = libc::syscall(libc::SYS_open, b&quot;&#x2F;path\0&quot;.as_ptr(), libc::O_CLOEXEC | libc::O_PATH);
</code></pre>
Or use rustix if you want more convenient idiomatic wrappers.<p>And for setting up containers you&#x27;ll have to do this anyway because Rust&#x27;s standard library doesn&#x27;t expose all of the necessary functionality anyway.</div><br/></div></div><div id="37030699" class="c"><input type="checkbox" id="c-37030699" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37029967">parent</a><span>|</span><a href="#37031377">prev</a><span>|</span><a href="#37030638">next</a><span>|</span><label class="collapse" for="c-37030699">[-]</label><label class="expand" for="c-37030699">[3 more]</label></div><br/><div class="children"><div class="content">Those Rust and Go bugs aren&#x27;t much different from C gotchas when writing portable UNIX code.</div><br/><div id="37030807" class="c"><input type="checkbox" id="c-37030807" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37030699">parent</a><span>|</span><a href="#37030638">next</a><span>|</span><label class="collapse" for="c-37030807">[-]</label><label class="expand" for="c-37030807">[2 more]</label></div><br/><div class="children"><div class="content">&gt;  Those Rust and Go bugs aren&#x27;t much different from C gotchas when writing portable UNIX code.<p>Maybe, but:<p>1. It&#x27;s irrelevant to this product (no one is writing portable UNIX code when they are writing some Linux-specific software, like container implementations).<p>and<p>2. It&#x27;s irrelevant to the author&#x27;s goals (learning Linux kernel stuff using the language that the interface to the kernel uses is a better idea than using a different language and hacking shims for all the stuff you want to do).<p>and<p>3. The cost to switch to a new language is substantial, and only makes sense if you&#x27;re either joining a team and project that uses that new language, or if the goal is to learn that new language.</div><br/><div id="37030898" class="c"><input type="checkbox" id="c-37030898" checked=""/><div class="controls bullet"><span class="by">pjmlp</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37030807">parent</a><span>|</span><a href="#37030638">next</a><span>|</span><label class="collapse" for="c-37030898">[-]</label><label class="expand" for="c-37030898">[1 more]</label></div><br/><div class="children"><div class="content">1. Containers predate Linux, appeared in other UNIXes before GNU&#x2F;Linux, and Windows also has them.<p>2. Any languge able to call into Linux API surface is usable. And if we go down the UNIX native languages route born at Bell Labs, C++ also counts.<p>3. That depends on how much someone knows C (properly), versus other alternatives</div><br/></div></div></div></div></div></div><div id="37030638" class="c"><input type="checkbox" id="c-37030638" checked=""/><div class="controls bullet"><span class="by">bheadmaster</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37029967">parent</a><span>|</span><a href="#37030699">prev</a><span>|</span><a href="#37030307">next</a><span>|</span><label class="collapse" for="c-37030638">[-]</label><label class="expand" for="c-37030638">[1 more]</label></div><br/><div class="children"><div class="content">Wouldn&#x27;t &quot;runtime.LockOSThead()&quot; help with the single-threaded API?</div><br/></div></div></div></div><div id="37030307" class="c"><input type="checkbox" id="c-37030307" checked=""/><div class="controls bullet"><span class="by">serf</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37029938">parent</a><span>|</span><a href="#37029967">prev</a><span>|</span><a href="#37031038">next</a><span>|</span><label class="collapse" for="c-37030307">[-]</label><label class="expand" for="c-37030307">[1 more]</label></div><br/><div class="children"><div class="content">I can&#x27;t answer for the developer, but the answer to that with most small one-person-show projects is familiarity&#x2F;comfort&#x2F;ability.<p>the head-space that adopting a new language for a specific project takes is immense compared to tackling it in a familiar language that you know you&#x27;re already able in; there is rarely a benefit to doing so outside of team environments where a certain level of on-boarding is expected, or because you have a really niche language requirement&#x2F;feature that your project is begging for.</div><br/></div></div><div id="37031038" class="c"><input type="checkbox" id="c-37031038" checked=""/><div class="controls bullet"><span class="by">lcvln</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37029938">parent</a><span>|</span><a href="#37030307">prev</a><span>|</span><a href="#37030161">next</a><span>|</span><label class="collapse" for="c-37031038">[-]</label><label class="expand" for="c-37031038">[1 more]</label></div><br/><div class="children"><div class="content">I haven&#x27;t written much C since college and I felt nostalgic, so I went for it.</div><br/></div></div></div></div><div id="37029602" class="c"><input type="checkbox" id="c-37029602" checked=""/><div class="controls bullet"><span class="by">murphyslaw</span><span>|</span><a href="#37025842">parent</a><span>|</span><a href="#37029938">prev</a><span>|</span><a href="#37028901">next</a><span>|</span><label class="collapse" for="c-37029602">[-]</label><label class="expand" for="c-37029602">[1 more]</label></div><br/><div class="children"><div class="content">This could be quite useful in a CS course on containers.</div><br/></div></div><div id="37028901" class="c"><input type="checkbox" id="c-37028901" checked=""/><div class="controls bullet"><span class="by">metadat</span><span>|</span><a href="#37025842">parent</a><span>|</span><a href="#37029602">prev</a><span>|</span><a href="#37025918">next</a><span>|</span><label class="collapse" for="c-37028901">[-]</label><label class="expand" for="c-37028901">[5 more]</label></div><br/><div class="children"><div class="content">How did you come up with the name &quot;Barco&quot;?</div><br/><div id="37031043" class="c"><input type="checkbox" id="c-37031043" checked=""/><div class="controls bullet"><span class="by">lcvln</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37028901">parent</a><span>|</span><a href="#37031119">next</a><span>|</span><label class="collapse" for="c-37031043">[-]</label><label class="expand" for="c-37031043">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s Venetian (my native language) for &quot;hay barrack&quot;: <a href="http:&#x2F;&#x2F;vec.wikipedia.org&#x2F;wiki&#x2F;Barco" rel="nofollow noreferrer">http:&#x2F;&#x2F;vec.wikipedia.org&#x2F;wiki&#x2F;Barco</a></div><br/></div></div><div id="37031119" class="c"><input type="checkbox" id="c-37031119" checked=""/><div class="controls bullet"><span class="by">mlashcorp</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37028901">parent</a><span>|</span><a href="#37031043">prev</a><span>|</span><a href="#37028907">next</a><span>|</span><label class="collapse" for="c-37031119">[-]</label><label class="expand" for="c-37031119">[1 more]</label></div><br/><div class="children"><div class="content">Also, Portuguese for boat.</div><br/></div></div><div id="37028907" class="c"><input type="checkbox" id="c-37028907" checked=""/><div class="controls bullet"><span class="by">voidmain0001</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37028901">parent</a><span>|</span><a href="#37031119">prev</a><span>|</span><a href="#37028908">next</a><span>|</span><label class="collapse" for="c-37028907">[-]</label><label class="expand" for="c-37028907">[1 more]</label></div><br/><div class="children"><div class="content">It’s Spanish for boat.</div><br/></div></div><div id="37028908" class="c"><input type="checkbox" id="c-37028908" checked=""/><div class="controls bullet"><span class="by">29athrowaway</span><span>|</span><a href="#37025842">root</a><span>|</span><a href="#37028901">parent</a><span>|</span><a href="#37028907">prev</a><span>|</span><a href="#37025918">next</a><span>|</span><label class="collapse" for="c-37028908">[-]</label><label class="expand" for="c-37028908">[1 more]</label></div><br/><div class="children"><div class="content">docker has to do with ships and barco means ship.</div><br/></div></div></div></div><div id="37025918" class="c"><input type="checkbox" id="c-37025918" checked=""/><div class="controls bullet"><span class="by">intelVISA</span><span>|</span><a href="#37025842">parent</a><span>|</span><a href="#37028901">prev</a><span>|</span><a href="#37026411">next</a><span>|</span><label class="collapse" for="c-37025918">[-]</label><label class="expand" for="c-37025918">[1 more]</label></div><br/><div class="children"><div class="content">awesome, thx for sharing this :)</div><br/></div></div></div></div><div id="37026411" class="c"><input type="checkbox" id="c-37026411" checked=""/><div class="controls bullet"><span class="by">zamalek</span><span>|</span><a href="#37025842">prev</a><span>|</span><a href="#37028646">next</a><span>|</span><label class="collapse" for="c-37026411">[-]</label><label class="expand" for="c-37026411">[14 more]</label></div><br/><div class="children"><div class="content">&gt; barco enforces a minimal set of restrictions to run untrusted code, which is not recommended for production use, where a more robust solution should be used.<p>Aren&#x27;t containers never suitable for running untrusted code? You need AppArmor, bwrap, or similar AFAIK.</div><br/><div id="37029575" class="c"><input type="checkbox" id="c-37029575" checked=""/><div class="controls bullet"><span class="by">creatonez</span><span>|</span><a href="#37026411">parent</a><span>|</span><a href="#37027290">next</a><span>|</span><label class="collapse" for="c-37029575">[-]</label><label class="expand" for="c-37029575">[4 more]</label></div><br/><div class="children"><div class="content">If built to spec, then the various container technologies in the kernel used together are theoretically secure. It closes all of the holes <i>that we know about</i>, aside from a few trivial things like the container spying on process id numbers on the host, and of course the vast potential to accidentally misconfigure it.<p>However, all this code is quite complex, and the kernel and the software ecosystem are lacking in having a layered approach to security that goes all the way down to the low-level nitty gritty stuff. For example, kernel memory structures are not robustly protected against the usual memory exploits, and there isn&#x27;t as strong W^X protection as desired. Windows, in contrast, is able to provide layered security through a variety of approaches, including running the entire operating system in a virtual machine, with the host ensuring integrity of kernel memory. These sorts of layered approaches to security are desirable because there will always be defects in any complex software.<p>Side note: AppArmor and bwrap are distinct. Bubblewrap is a relatively simple userspace program that makes use of existing kernel containerization features (the same ones that Docker&#x2F;Podman use), whereas AppArmor and SELinux are security features that are patched into the kernel itself. AppArmor and SELinux have made some progress in adding layered low-level security to the kernel, but it&#x27;s not particularly impressive. Bubblewrap has done great work in exposing the kernel&#x27;s existing tech to users, but they are not fundamental improvements to the kernel itself.</div><br/><div id="37029625" class="c"><input type="checkbox" id="c-37029625" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37029575">parent</a><span>|</span><a href="#37027290">next</a><span>|</span><label class="collapse" for="c-37029625">[-]</label><label class="expand" for="c-37029625">[3 more]</label></div><br/><div class="children"><div class="content">&gt; aside from a few trivial things like the container spying on process id numbers on the host<p>Containers with own PID namespace can&#x27;t spy on process IDs on the host though? Not sure what you mean here.<p>&gt; and there isn&#x27;t as strong W^X protection as desired<p>What level is desired? Bootup warnings for W^X got merged a while ago. Changes that try to include anything violating it are rejected (see bcachefs).<p>&gt; Windows, in contrast, is able to provide layered security through a variety of approaches, including running the entire operating system in a virtual machine, with the host ensuring integrity of kernel memory.<p>What? Xen existed for years, that&#x27;s not &quot;in contrast&quot;. Secureboot and lockdown exists on Linux too. There&#x27;s also per-service firecracker microvm.<p>&gt; whereas AppArmor and SELinux are new security features that are patched into the kernel itself<p>That&#x27;s very misleading. They&#x27;re not new - selinux is over 2 decades old. They&#x27;re also not &quot;patched in&quot; - LSMs have been integrated into Linux for a very long time with multiple implementations available. Selinux had multilabel security created for gov use. It&#x27;s quite impressive actually.</div><br/><div id="37029954" class="c"><input type="checkbox" id="c-37029954" checked=""/><div class="controls bullet"><span class="by">creatonez</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37029625">parent</a><span>|</span><a href="#37027290">next</a><span>|</span><label class="collapse" for="c-37029954">[-]</label><label class="expand" for="c-37029954">[2 more]</label></div><br/><div class="children"><div class="content">&gt; That&#x27;s very misleading. They&#x27;re not new - selinux is over 2 decades old.<p>I misspoke on SELinux and AppArmor being &quot;new&quot;. What I was getting at is that they are distinct kernel features, compared to bwrap which is just a user of kernel features already familiar in this discussion. So &quot;new&quot;, as in, &quot;additional&quot;, e.g. &quot;We turned up some new evidence from the old files&quot;.<p>And yes, SELinux is included as a first-class kernel feature. AppArmor is a bit different because it still has a lot of hurdles before all its features can be upstreamed. However, upstreaming is not the end-all-be-all so it&#x27;s not necessarily a bad thing that parts of AppArmor are patched in, so I&#x27;m not emphasizing this point at all.<p>&gt; What? Xen existed for years, that&#x27;s not &quot;in contrast&quot;.<p>Does the Xen or KVM ecosystems provide anything comparable to Windows hypervisor-enforced code integrity? That is, the host is aware of what kernel memory needs to be set to read-only or checked regularly for corruption or irregularities, in a system that is impossible to interfere with without a VM break. (<a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows-hardware&#x2F;design&#x2F;device-experiences&#x2F;oem-vbs" rel="nofollow noreferrer">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;windows-hardware&#x2F;design&#x2F;de...</a> )<p>Secure VMs are great, VMs that are actually monitoring and enhancing the security of the code running inside are even better.</div><br/><div id="37030183" class="c"><input type="checkbox" id="c-37030183" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37029954">parent</a><span>|</span><a href="#37027290">next</a><span>|</span><label class="collapse" for="c-37030183">[-]</label><label class="expand" for="c-37030183">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Does the Xen or KVM ecosystems provide anything comparable to Windows hypervisor-enforced code integrity?<p>Xen can do it, KVM had some attempts at memory enforcement patches, but not sure where it ended up. I&#x27;m not sure how well utilised it is though from the guest side ootb. (I think poorly)<p>A lot of the signing&#x2F;module loading issues are prevented on the guest side though with <a href="https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man7&#x2F;kernel_lockdown.7.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man7&#x2F;kernel_lockdown.7.html</a><p>So it&#x27;s... not the same, but the facilities are available. (Unless someone wants to correct me and it&#x27;s already used)</div><br/></div></div></div></div></div></div></div></div><div id="37027290" class="c"><input type="checkbox" id="c-37027290" checked=""/><div class="controls bullet"><span class="by">cyphar</span><span>|</span><a href="#37026411">parent</a><span>|</span><a href="#37029575">prev</a><span>|</span><a href="#37029567">next</a><span>|</span><label class="collapse" for="c-37027290">[-]</label><label class="expand" for="c-37027290">[3 more]</label></div><br/><div class="children"><div class="content">bwrap is a container and AppArmor is used by basically every container runtime if the system is using AppArmor (otherwise they use SELinux). Seccomp is also enabled by default, and I would argue it is a more significant protection against container breakouts because it protects against kernel 0-days as well and doesn&#x27;t rely on LSM hooks to block operations. The real question is whether you are using user namespaces.<p>Jessica Frazelle ran a public bug bounty to break out of a container image that is properly secured, and as far as I know nobody collected the bounty. The website isn&#x27;t up at the 
moment, maybe she took it down. <a href="https:&#x2F;&#x2F;contained.af&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;contained.af&#x2F;</a></div><br/><div id="37027470" class="c"><input type="checkbox" id="c-37027470" checked=""/><div class="controls bullet"><span class="by">jppittma</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37027290">parent</a><span>|</span><a href="#37029567">next</a><span>|</span><label class="collapse" for="c-37027470">[-]</label><label class="expand" for="c-37027470">[2 more]</label></div><br/><div class="children"><div class="content">Sounds like free money to me. You just press Ctrl+D, and you&#x27;re out.</div><br/><div id="37027583" class="c"><input type="checkbox" id="c-37027583" checked=""/><div class="controls bullet"><span class="by">cyphar</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37027470">parent</a><span>|</span><a href="#37029567">next</a><span>|</span><label class="collapse" for="c-37027583">[-]</label><label class="expand" for="c-37027583">[1 more]</label></div><br/><div class="children"><div class="content">Sadly that doesn&#x27;t help you get access to the flag file you need to collect the bounty. ;)</div><br/></div></div></div></div></div></div><div id="37029567" class="c"><input type="checkbox" id="c-37029567" checked=""/><div class="controls bullet"><span class="by">viraptor</span><span>|</span><a href="#37026411">parent</a><span>|</span><a href="#37027290">prev</a><span>|</span><a href="#37026459">next</a><span>|</span><label class="collapse" for="c-37029567">[-]</label><label class="expand" for="c-37029567">[1 more]</label></div><br/><div class="children"><div class="content">Depends what you mean by suitable. If you run the service as a new user, it&#x27;s more secure than running without a new namespace (you&#x27;re isolated from other apps) and potentially less secure than running on host (one more layer of indirection for system resource access).<p>Since in reality most attacks will be against your app itself before the attacker has direct access to syscalls, I see namespaces&#x2F;containers as extra protection.</div><br/></div></div><div id="37026459" class="c"><input type="checkbox" id="c-37026459" checked=""/><div class="controls bullet"><span class="by">loeg</span><span>|</span><a href="#37026411">parent</a><span>|</span><a href="#37029567">prev</a><span>|</span><a href="#37026876">next</a><span>|</span><label class="collapse" for="c-37026459">[-]</label><label class="expand" for="c-37026459">[2 more]</label></div><br/><div class="children"><div class="content">I would probably point at a virtual machine for a convenient place to run untrusted code.  It&#x27;s not perfect -- there are VM escapes -- but it&#x27;s more convenient than a dedicated, air-gapped machine.</div><br/><div id="37026506" class="c"><input type="checkbox" id="c-37026506" checked=""/><div class="controls bullet"><span class="by">CameronNemo</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37026459">parent</a><span>|</span><a href="#37026876">next</a><span>|</span><label class="collapse" for="c-37026506">[-]</label><label class="expand" for="c-37026506">[1 more]</label></div><br/><div class="children"><div class="content">GKE runs every kubelet in its own gvisor-like userspace hypervisor.<p><a href="https:&#x2F;&#x2F;cloud.google.com&#x2F;blog&#x2F;products&#x2F;containers-kubernetes&#x2F;how-gvisor-protects-google-cloud-services-from-cve-2020-14386" rel="nofollow noreferrer">https:&#x2F;&#x2F;cloud.google.com&#x2F;blog&#x2F;products&#x2F;containers-kubernetes...</a></div><br/></div></div></div></div><div id="37026876" class="c"><input type="checkbox" id="c-37026876" checked=""/><div class="controls bullet"><span class="by">charcircuit</span><span>|</span><a href="#37026411">parent</a><span>|</span><a href="#37026459">prev</a><span>|</span><a href="#37028646">next</a><span>|</span><label class="collapse" for="c-37026876">[-]</label><label class="expand" for="c-37026876">[3 more]</label></div><br/><div class="children"><div class="content">&gt;Aren&#x27;t containers never suitable for running untrusted code?<p>They are suitable provided the kernel is secure.</div><br/><div id="37027439" class="c"><input type="checkbox" id="c-37027439" checked=""/><div class="controls bullet"><span class="by">cyphar</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37026876">parent</a><span>|</span><a href="#37028646">next</a><span>|</span><label class="collapse" for="c-37027439">[-]</label><label class="expand" for="c-37027439">[2 more]</label></div><br/><div class="children"><div class="content">This is tautologically true -- &quot;Is X secure? Yes, assuming the technology X uses is secure.&quot;<p>The more nuanced answer is that containers have several layers of protections (seccomp, LSMs, user namespaces, namespaces, cgroups, capabilities, and standard process permissions by running as an unprivileged user) which all act together to help protect against container attacks. It&#x27;s not perfect, but most container breakout attacks we&#x27;ve had so far are related to when container runtimes have to operate on a container during process setup (IMHO because the process for creating a container process is far from atomic) -- some of these attacks were enabled by kernel bugs which we went and fixed as well. It is very difficult to break out of a container once it has been configured and left alone.</div><br/><div id="37030698" class="c"><input type="checkbox" id="c-37030698" checked=""/><div class="controls bullet"><span class="by">raesene9</span><span>|</span><a href="#37026411">root</a><span>|</span><a href="#37027439">parent</a><span>|</span><a href="#37028646">next</a><span>|</span><label class="collapse" for="c-37030698">[-]</label><label class="expand" for="c-37030698">[1 more]</label></div><br/><div class="children"><div class="content">Possibly, but I&#x27;d say that Google&#x27;s experience with kCTF was that allowing io_uring on hosts running containers has allowed for multiple breakouts. They paid out over $1m on io_uring related bug bounties <a href="https:&#x2F;&#x2F;security.googleblog.com&#x2F;2023&#x2F;06&#x2F;learnings-from-kctf-vrps-42-linux.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;security.googleblog.com&#x2F;2023&#x2F;06&#x2F;learnings-from-kctf-...</a><p>Also while user namespaces help in theory, in practice expanding the attack surface of the kernel exposed to unprivileged users has consequences in allowing container breakout (e.g. CVE-2022-0185) also more recently CVE-2023-3390</div><br/></div></div></div></div></div></div></div></div><div id="37028646" class="c"><input type="checkbox" id="c-37028646" checked=""/><div class="controls bullet"><span class="by">favflam</span><span>|</span><a href="#37026411">prev</a><span>|</span><a href="#37031025">next</a><span>|</span><label class="collapse" for="c-37028646">[-]</label><label class="expand" for="c-37028646">[2 more]</label></div><br/><div class="children"><div class="content">Question: for sandboxing untrusted code, should I invest time in learning more linux container stuff or switch to learning WASI?  I am inclined towards WASI myself.</div><br/><div id="37028906" class="c"><input type="checkbox" id="c-37028906" checked=""/><div class="controls bullet"><span class="by">lmm</span><span>|</span><a href="#37028646">parent</a><span>|</span><a href="#37031025">next</a><span>|</span><label class="collapse" for="c-37028906">[-]</label><label class="expand" for="c-37028906">[1 more]</label></div><br/><div class="children"><div class="content">I have more faith in WASI. Linux containers is inherently in a whack-a-mole position where they&#x27;re trying to retrofit security onto something that was never built for it, which very rarely works.</div><br/></div></div></div></div><div id="37031025" class="c"><input type="checkbox" id="c-37031025" checked=""/><div class="controls bullet"><span class="by">yukIttEft</span><span>|</span><a href="#37028646">prev</a><span>|</span><a href="#37026192">next</a><span>|</span><label class="collapse" for="c-37031025">[-]</label><label class="expand" for="c-37031025">[2 more]</label></div><br/><div class="children"><div class="content">Could this also be implemented as a bashscript?</div><br/><div id="37031032" class="c"><input type="checkbox" id="c-37031032" checked=""/><div class="controls bullet"><span class="by">lcvln</span><span>|</span><a href="#37031025">parent</a><span>|</span><a href="#37026192">next</a><span>|</span><label class="collapse" for="c-37031032">[-]</label><label class="expand" for="c-37031032">[1 more]</label></div><br/><div class="children"><div class="content">Probably: <a href="https:&#x2F;&#x2F;github.com&#x2F;p8952&#x2F;bocker">https:&#x2F;&#x2F;github.com&#x2F;p8952&#x2F;bocker</a></div><br/></div></div></div></div><div id="37026192" class="c"><input type="checkbox" id="c-37026192" checked=""/><div class="controls bullet"><span class="by">gjkood</span><span>|</span><a href="#37031025">prev</a><span>|</span><a href="#37026330">next</a><span>|</span><label class="collapse" for="c-37026192">[-]</label><label class="expand" for="c-37026192">[12 more]</label></div><br/><div class="children"><div class="content">Your project is not in the same space but do you forsee any conflicts with the name regarding copyrights, trademarks etc with Barco, Inc. [1], the projector&#x2F;display company?<p>[1] <a href="https:&#x2F;&#x2F;www.barco.com&#x2F;en" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.barco.com&#x2F;en</a></div><br/><div id="37026213" class="c"><input type="checkbox" id="c-37026213" checked=""/><div class="controls bullet"><span class="by">CameronNemo</span><span>|</span><a href="#37026192">parent</a><span>|</span><a href="#37028671">next</a><span>|</span><label class="collapse" for="c-37026213">[-]</label><label class="expand" for="c-37026213">[9 more]</label></div><br/><div class="children"><div class="content"><i>Please don&#x27;t complain about tangential annoyances—e.g. article or website formats, name collisions, or back-button breakage. They&#x27;re too common to be interesting.</i></div><br/><div id="37026688" class="c"><input type="checkbox" id="c-37026688" checked=""/><div class="controls bullet"><span class="by">Philpax</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37026213">parent</a><span>|</span><a href="#37028671">next</a><span>|</span><label class="collapse" for="c-37026688">[-]</label><label class="expand" for="c-37026688">[8 more]</label></div><br/><div class="children"><div class="content">GP was asking if it could cause an issue for the OP, not complaining about an annoyance. It&#x27;s something that the OP may want to address.</div><br/><div id="37026924" class="c"><input type="checkbox" id="c-37026924" checked=""/><div class="controls bullet"><span class="by">CameronNemo</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37026688">parent</a><span>|</span><a href="#37028671">next</a><span>|</span><label class="collapse" for="c-37026924">[-]</label><label class="expand" for="c-37026924">[7 more]</label></div><br/><div class="children"><div class="content">I still think it is tangential. The author stated that they wrote this project to learn. The readme says that it is not intended for production use and that there is no networking set up in the containers.<p>With that context, I doubt that name collisions outside of the containers space are top of mind.</div><br/><div id="37028233" class="c"><input type="checkbox" id="c-37028233" checked=""/><div class="controls bullet"><span class="by">LeFantome</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37026924">parent</a><span>|</span><a href="#37027070">next</a><span>|</span><label class="collapse" for="c-37028233">[-]</label><label class="expand" for="c-37028233">[1 more]</label></div><br/><div class="children"><div class="content">If it was my project, I would want to know about a possible name collision. Saying it once seems fine.</div><br/></div></div><div id="37027070" class="c"><input type="checkbox" id="c-37027070" checked=""/><div class="controls bullet"><span class="by">lcvln</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37026924">parent</a><span>|</span><a href="#37028233">prev</a><span>|</span><a href="#37028671">next</a><span>|</span><label class="collapse" for="c-37027070">[-]</label><label class="expand" for="c-37027070">[5 more]</label></div><br/><div class="children"><div class="content">barco really just means &quot;hay barrack&quot; in my native language ¯\_(ツ)_&#x2F;¯</div><br/><div id="37027878" class="c"><input type="checkbox" id="c-37027878" checked=""/><div class="controls bullet"><span class="by">brezelgoring</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37027070">parent</a><span>|</span><a href="#37028409">next</a><span>|</span><label class="collapse" for="c-37027878">[-]</label><label class="expand" for="c-37027878">[2 more]</label></div><br/><div class="children"><div class="content">It means &#x27;watercraft&#x27; or &#x27;sea worthy ship&#x27; in Spanish, too. :)<p>In what language does it mean &#x27;hay barrack&#x27;?</div><br/><div id="37027904" class="c"><input type="checkbox" id="c-37027904" checked=""/><div class="controls bullet"><span class="by">CameronNemo</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37027878">parent</a><span>|</span><a href="#37028409">next</a><span>|</span><label class="collapse" for="c-37027904">[-]</label><label class="expand" for="c-37027904">[1 more]</label></div><br/><div class="children"><div class="content">Indeed the wiki yields no matches<p><a href="https:&#x2F;&#x2F;en.m.wiktionary.org&#x2F;wiki&#x2F;barco" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.m.wiktionary.org&#x2F;wiki&#x2F;barco</a></div><br/></div></div></div></div><div id="37028409" class="c"><input type="checkbox" id="c-37028409" checked=""/><div class="controls bullet"><span class="by">lcvln</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37027070">parent</a><span>|</span><a href="#37027878">prev</a><span>|</span><a href="#37027929">next</a><span>|</span><label class="collapse" for="c-37028409">[-]</label><label class="expand" for="c-37028409">[1 more]</label></div><br/><div class="children"><div class="content">Venetian: <a href="https:&#x2F;&#x2F;vec.m.wikipedia.org&#x2F;wiki&#x2F;Barco" rel="nofollow noreferrer">https:&#x2F;&#x2F;vec.m.wikipedia.org&#x2F;wiki&#x2F;Barco</a></div><br/></div></div><div id="37027929" class="c"><input type="checkbox" id="c-37027929" checked=""/><div class="controls bullet"><span class="by">gabrielhidasy</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37027070">parent</a><span>|</span><a href="#37028409">prev</a><span>|</span><a href="#37028671">next</a><span>|</span><label class="collapse" for="c-37027929">[-]</label><label class="expand" for="c-37027929">[1 more]</label></div><br/><div class="children"><div class="content">&#x27;Boat&#x27; in mine</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37028671" class="c"><input type="checkbox" id="c-37028671" checked=""/><div class="controls bullet"><span class="by">memefrog</span><span>|</span><a href="#37026192">parent</a><span>|</span><a href="#37026213">prev</a><span>|</span><a href="#37026330">next</a><span>|</span><label class="collapse" for="c-37028671">[-]</label><label class="expand" for="c-37028671">[2 more]</label></div><br/><div class="children"><div class="content">Why would there be any conflict?  They&#x27;re in completely different domains so there is no potential for confusion.  Why would copyright be relevant in <i>any</i> way?  Do you even know what copyright is?</div><br/><div id="37030550" class="c"><input type="checkbox" id="c-37030550" checked=""/><div class="controls bullet"><span class="by">ivoc</span><span>|</span><a href="#37026192">root</a><span>|</span><a href="#37028671">parent</a><span>|</span><a href="#37026330">next</a><span>|</span><label class="collapse" for="c-37030550">[-]</label><label class="expand" for="c-37030550">[1 more]</label></div><br/><div class="children"><div class="content">Legally it&#x27;s probably fine, but as the Belgian American Radio Company has been around since the 1930s, the title of the article did confuse me: my first guess was something about how Barco was using Linux containers in their products.</div><br/></div></div></div></div></div></div><div id="37026330" class="c"><input type="checkbox" id="c-37026330" checked=""/><div class="controls bullet"><span class="by">shortrounddev2</span><span>|</span><a href="#37026192">prev</a><span>|</span><a href="#37027850">next</a><span>|</span><label class="collapse" for="c-37026330">[-]</label><label class="expand" for="c-37026330">[3 more]</label></div><br/><div class="children"><div class="content">Very cool, I was thinking of doing something similar in windows</div><br/><div id="37027430" class="c"><input type="checkbox" id="c-37027430" checked=""/><div class="controls bullet"><span class="by">semiquaver</span><span>|</span><a href="#37026330">parent</a><span>|</span><a href="#37027850">next</a><span>|</span><label class="collapse" for="c-37027430">[-]</label><label class="expand" for="c-37027430">[2 more]</label></div><br/><div class="children"><div class="content">What is the underlying isolation technology that would be used in windows?</div><br/><div id="37030989" class="c"><input type="checkbox" id="c-37030989" checked=""/><div class="controls bullet"><span class="by">AkshitGarg</span><span>|</span><a href="#37026330">root</a><span>|</span><a href="#37027430">parent</a><span>|</span><a href="#37027850">next</a><span>|</span><label class="collapse" for="c-37030989">[-]</label><label class="expand" for="c-37030989">[1 more]</label></div><br/><div class="children"><div class="content">Windows also supports containers: <a href="https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;virtualization&#x2F;windowscontainers&#x2F;about&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;learn.microsoft.com&#x2F;en-us&#x2F;virtualization&#x2F;windowscont...</a></div><br/></div></div></div></div></div></div><div id="37027850" class="c"><input type="checkbox" id="c-37027850" checked=""/><div class="controls bullet"><span class="by">godlover</span><span>|</span><a href="#37026330">prev</a><span>|</span><label class="collapse" for="c-37027850">[-]</label><label class="expand" for="c-37027850">[1 more]</label></div><br/><div class="children"><div class="content">?</div><br/></div></div></div></div></div></div></div></body></html>