<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1684918865747" as="style"/><link rel="stylesheet" href="styles.css?v=1684918865747"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://im.salty.fish/index.php/archives/linux-networking-shallow-dive.html">Linux Networking Shallow Dive: WireGuard, Routing, TCP/IP and NAT</a> <span class="domain">(<a href="https://im.salty.fish">im.salty.fish</a>)</span></div><div class="subtext"><span>devStorms</span> | <span>54 comments</span></div><br/><div><div id="36050185" class="c"><input type="checkbox" id="c-36050185" checked=""/><div class="controls bullet"><span class="by">1970-01-01</span><span>|</span><a href="#36048871">next</a><span>|</span><label class="collapse" for="c-36050185">[-]</label><label class="expand" for="c-36050185">[7 more]</label></div><br/><div class="children"><div class="content">&gt;I always felt, and still feel, that applied Linux networking is difficult to get started with, mainly due to lack of good guidance. Most of the time I had to dig through small pieces of documentation scattered throughout the internet, trying to put them together to form a systematic overview of the network stack in Linux.<p>...<p>&gt;It is extremely frustrating when somebody interested in setting up their own network infrastructure has to at some point get stuck at some convoluted networking concepts, intricate and abstract tools, mysterious errors here and there, or lack of systematic documentation. I wish everyone has some choices other than spending days and weeks trying to figure these out alone, so I decided to write down what I have done, what I have learned and what I have to share with the rest of the internet. I sincerely hope that some day IT operations would be more beginner-friendly, and hosting one&#x27;s own network infrastructure no longer means headache and mess.<p>These are exactly my feelings. Stinky.fish makes more sense for a Linux blog. Everything about it stinks <i>until it actually works</i>. :)</div><br/><div id="36051040" class="c"><input type="checkbox" id="c-36051040" checked=""/><div class="controls bullet"><span class="by">slacka</span><span>|</span><a href="#36050185">parent</a><span>|</span><a href="#36051066">next</a><span>|</span><label class="collapse" for="c-36051040">[-]</label><label class="expand" for="c-36051040">[5 more]</label></div><br/><div class="children"><div class="content">I experienced this back when I configured my home Linux boxes as a router, VPN server, firewall, media server, etc. Since I had the time, compiled all of the info I found on random blogs and sites and added them to the Ubuntu Community wiki. That was the 12.x days, when Ubuntu was in its prime and the distro to use.<p>While these blogs were a great resource, I often found the commands outdated or applied to a different distro. A distro specific wiki solves both those issue. While I don&#x27;t get the glory of a blog, I just checked an it&#x27;s nice to see my notes still there for future Denvercoder9&#x27;s.</div><br/><div id="36052285" class="c"><input type="checkbox" id="c-36052285" checked=""/><div class="controls bullet"><span class="by">bombcar</span><span>|</span><a href="#36050185">root</a><span>|</span><a href="#36051040">parent</a><span>|</span><a href="#36051456">next</a><span>|</span><label class="collapse" for="c-36052285">[-]</label><label class="expand" for="c-36052285">[2 more]</label></div><br/><div class="children"><div class="content">The Gentoo Wiki was a great resource for <i>many</i> networking questions, even when I wasn&#x27;t using Gentoo.<p>A major hurdle is simply learning how to describe what you want to do &quot;in the industry terms&quot; - &quot;I can&#x27;t access my server from my computer but it works from the Internet&quot; is a lot easier to resolve when you learn what &quot;hairpin NAT&quot; is.</div><br/><div id="36052723" class="c"><input type="checkbox" id="c-36052723" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#36050185">root</a><span>|</span><a href="#36052285">parent</a><span>|</span><a href="#36051456">next</a><span>|</span><label class="collapse" for="c-36052723">[-]</label><label class="expand" for="c-36052723">[1 more]</label></div><br/><div class="children"><div class="content">Searching for things when you don&#x27;t know the terminology seems like an ideal use for AIs.</div><br/></div></div></div></div><div id="36051456" class="c"><input type="checkbox" id="c-36051456" checked=""/><div class="controls bullet"><span class="by">gerdesj</span><span>|</span><a href="#36050185">root</a><span>|</span><a href="#36051040">parent</a><span>|</span><a href="#36052285">prev</a><span>|</span><a href="#36053410">next</a><span>|</span><label class="collapse" for="c-36051456">[-]</label><label class="expand" for="c-36051456">[1 more]</label></div><br/><div class="children"><div class="content">Ahhh, it sounds like you&#x27;ve only done this once.  I started off with ipfw, then ipchains, then iptables and now whatever firewalld supports. OK that&#x27;s roughly 25 years so not too much firewalling churn!  I stopped hand rolling my own rule sets with ipchains and switched to generators and there are loads of them.<p>For me some of the problems nowadays are caused by search engine manipulation.  Up until around five or so years ago Linux concept searches would get you pointed at the usual big hitters - Arch&#x2F;Gentoo&#x2F;Ubuntu&#x2F;etc wikis and useful and quite well known blogs.  My modern block list for ublacklist is huge and barely scratches the surface.<p>Now I come to think of it, we now have ChatGPT and I bet it can roll a decent ruleset without hallucinating madly.  No doubt someone will soon be Showing HN: their smart new firewall prompt generator language for &lt;insert AI here&gt;.  It will make the LLM use Rust as an intermediary for extra safety.</div><br/></div></div><div id="36053410" class="c"><input type="checkbox" id="c-36053410" checked=""/><div class="controls bullet"><span class="by">cyberax</span><span>|</span><a href="#36050185">root</a><span>|</span><a href="#36051040">parent</a><span>|</span><a href="#36051456">prev</a><span>|</span><a href="#36051066">next</a><span>|</span><label class="collapse" for="c-36053410">[-]</label><label class="expand" for="c-36053410">[1 more]</label></div><br/><div class="children"><div class="content">This is one reason Mikrotik products are so nice. At least, they have a pretty decent Web UI that you can use to configure stuff.</div><br/></div></div></div></div><div id="36051066" class="c"><input type="checkbox" id="c-36051066" checked=""/><div class="controls bullet"><span class="by">easytiger</span><span>|</span><a href="#36050185">parent</a><span>|</span><a href="#36051040">prev</a><span>|</span><a href="#36048871">next</a><span>|</span><label class="collapse" for="c-36051066">[-]</label><label class="expand" for="c-36051066">[1 more]</label></div><br/><div class="children"><div class="content">Ironically enterprise networking on Linux is incredibly simple</div><br/></div></div></div></div><div id="36048871" class="c"><input type="checkbox" id="c-36048871" checked=""/><div class="controls bullet"><span class="by">systems_glitch</span><span>|</span><a href="#36050185">prev</a><span>|</span><a href="#36051067">next</a><span>|</span><label class="collapse" for="c-36048871">[-]</label><label class="expand" for="c-36048871">[24 more]</label></div><br/><div class="children"><div class="content">We recently switched a bunch of stuff from OpenVPN to Wireguard. A number of the links were OpenVPN layer 2 tunnels to pass, of all things, Novell Netware running on IPX (the particular situation precludes switching to TCP&#x2F;IP for those customers). Now, layer 2 tunneling is being performed using RFC 3378 EtherIP, and it&#x27;s much more performant, not to mention easier to manage.<p>Old and new systems are running OpenBSD.</div><br/><div id="36051223" class="c"><input type="checkbox" id="c-36051223" checked=""/><div class="controls bullet"><span class="by">gerdesj</span><span>|</span><a href="#36048871">parent</a><span>|</span><a href="#36049564">next</a><span>|</span><label class="collapse" for="c-36051223">[-]</label><label class="expand" for="c-36051223">[6 more]</label></div><br/><div class="children"><div class="content">Good grief - NetWare with only IPX!  Presumably you&#x27;ll be installing their Y2K patches any day soon 8)<p>I&#x27;m pretty sure NetWare can natively tunnel IPX&#x2F;SPX over TCP&#x2F;IP, assuming you are not stuck on 3.12.  I don&#x27;t think you have to fork out for the multi protocol router thing.  They will crash regularly until you get the magic combination spot on and then run forever.<p>A NW 6.5 box will run quite happily as a pretty tiny VM - you could scatter them around as routers to support whatever nightmare of an app you need to run over IPX.  Tunnel them over IPSEC or whatever floats your boat.</div><br/><div id="36051675" class="c"><input type="checkbox" id="c-36051675" checked=""/><div class="controls bullet"><span class="by">systems_glitch</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051223">parent</a><span>|</span><a href="#36049564">next</a><span>|</span><label class="collapse" for="c-36051675">[-]</label><label class="expand" for="c-36051675">[5 more]</label></div><br/><div class="children"><div class="content">That particular client is stuck on NetWare 5.1 and due to how bad their maintenance has been I dare not touch the running instances. Virtualization didn&#x27;t work out as there&#x27;s some issue with the current patchlevel that dies on Intel CPUs greater than Pentium 4 (including hyperthreading P4s). It&#x27;s...a stupid story.</div><br/><div id="36051839" class="c"><input type="checkbox" id="c-36051839" checked=""/><div class="controls bullet"><span class="by">gerdesj</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051675">parent</a><span>|</span><a href="#36049564">next</a><span>|</span><label class="collapse" for="c-36051839">[-]</label><label class="expand" for="c-36051839">[4 more]</label></div><br/><div class="children"><div class="content">On VMware you can hide CPU features - ie backrev the CPU and I&#x27;m sure HV can do the same, and no doubt KVM&#x2F;QEMMU too.<p>I used to run a lot of NW back in the day.  I remember deploying a NW 5 cluster of three Compaq boxes with six NICs each (for each VLAN) to do just DHCP&#x2F;Dynamic DNS!  I also ran up four HP boxes a year later with single ATM cards in them with a lot of VLANs to replace a load of 4.11 jobbies.  The autoexec.ncf was a masterpiece!  The cluster hosts had 6GB RAM each and despite being 32bit had quite a lot of cache which nss absolutely loved.  I can&#x27;t remember when NW 32 bit managed to devote &gt;4Gb to cache but it was handy.  As a file server it was absolutely unmatched.  Apply an ACL and it simply worked - none of that marking subfolders and files thing that MS and Unix need.  NDS&#x2F;eDir was streets ahead of that weird LDAP n Kerberos thingie that MS &quot;invented&quot; and frankly still is.<p>I would suggest that you virty them as a matter of urgency. Presumably you have limited and dwindling hardware resources available and at some point something will go pop that can&#x27;t be fixed.  Once you have them as VMs then you can snapshot and all the other lovely things that virty brings to the game and you will never run out of hardware!</div><br/><div id="36051894" class="c"><input type="checkbox" id="c-36051894" checked=""/><div class="controls bullet"><span class="by">systems_glitch</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051839">parent</a><span>|</span><a href="#36049564">next</a><span>|</span><label class="collapse" for="c-36051894">[-]</label><label class="expand" for="c-36051894">[3 more]</label></div><br/><div class="children"><div class="content">Pretty cool to hear about big NW installs! Thanks for sharing!<p>We&#x27;re actively working on moving that customer off Netware entirely. The main reason they can&#x27;t get away from it is they&#x27;re running a custom god program that manages the entire business, and it&#x27;s tied in pretty tightly with their old configuration. The whole thing is in Delphi 7.<p>W.R.T. old hardware, they are actually some of the newer old boxes we support! My main line of business is keeping old industrial control systems online and reliable. On the PC side, the oldest stuff we have in 24&#x2F;7 operation is 286-based. Pre-PC, we have a few customers running CNC stuff on PDP-11s. I don&#x27;t know if we still have any PDP-8 customers, I think most of them closed up shop during the pandemic.</div><br/><div id="36052327" class="c"><input type="checkbox" id="c-36052327" checked=""/><div class="controls bullet"><span class="by">gerdesj</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051894">parent</a><span>|</span><a href="#36049564">next</a><span>|</span><label class="collapse" for="c-36052327">[-]</label><label class="expand" for="c-36052327">[2 more]</label></div><br/><div class="children"><div class="content">Good skills.<p>You beat our DOS 5 booting control system into a cocked hat, that a customer is running.  You&#x27;ve got to love <i>cough</i> technical debt.  Why on earth is &quot;Enterprise gone awry&quot; considered the right way to go for your IT strategy over that boring old open source bollocks that has a nasty habit of still being supported or at least working decades later?  To be fair, open source wasn&#x27;t a thing in the 80s for most people (nor the 90s ... ).<p>PDP-11s are my uncle&#x27;s era and I&#x27;m 53!  My first real PC was a 80286 (don&#x27;t forget the 80) I bought a &#x27;287 maths co pro for about £115 so I could run a dodgy copy of AutoCAD on it.  I do still have my old Commodore 64 which now has a USB interface.  I assembled a ZX80 or two ...<p>Delphi is &quot;just&quot; Pascal - port it!</div><br/><div id="36052493" class="c"><input type="checkbox" id="c-36052493" checked=""/><div class="controls bullet"><span class="by">systems_glitch</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36052327">parent</a><span>|</span><a href="#36049564">next</a><span>|</span><label class="collapse" for="c-36052493">[-]</label><label class="expand" for="c-36052493">[1 more]</label></div><br/><div class="children"><div class="content">The bad part is mostly the DB and the Netware integration, but mostly the DB. It&#x27;s Borland Paradox.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="36049564" class="c"><input type="checkbox" id="c-36049564" checked=""/><div class="controls bullet"><span class="by">generalizations</span><span>|</span><a href="#36048871">parent</a><span>|</span><a href="#36051223">prev</a><span>|</span><a href="#36049143">next</a><span>|</span><label class="collapse" for="c-36049564">[-]</label><label class="expand" for="c-36049564">[16 more]</label></div><br/><div class="children"><div class="content">If you have a write up of how you managed to get layer 2 working inside wireguard, I&#x27;d love to read it.</div><br/><div id="36051664" class="c"><input type="checkbox" id="c-36051664" checked=""/><div class="controls bullet"><span class="by">systems_glitch</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36049564">parent</a><span>|</span><a href="#36050559">next</a><span>|</span><label class="collapse" for="c-36051664">[-]</label><label class="expand" for="c-36051664">[1 more]</label></div><br/><div class="children"><div class="content">I basically just followed the OpenBSD documentation! One of the big advantages of OpenBSD is that pretty much everything you need to know is contained in the manpages.<p>As I&#x27;d said above, we ended up using RFC 3378 EtherIP to link the two layer 2 broadcast domains across the Wireguard tunnel. OpenBSD supports this with the etherip interface. You end up creating a bridge with the etherip interface and whatever physical Ethernet interfaces you want to bridge, on either side of the Wireguard tunnel.<p>I also tried VXLAN but did not have good results. I&#x27;m not entirely sure it wasn&#x27;t a problem with my configuration. Traffic often went one-directional, where broadcast packets from Site A made it to Site B, but they did not come from Site B to Site A. EtherIP worked right off, so I didn&#x27;t investigate further.</div><br/></div></div><div id="36050559" class="c"><input type="checkbox" id="c-36050559" checked=""/><div class="controls bullet"><span class="by">gammajmp</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36049564">parent</a><span>|</span><a href="#36051664">prev</a><span>|</span><a href="#36050413">next</a><span>|</span><label class="collapse" for="c-36050559">[-]</label><label class="expand" for="c-36050559">[4 more]</label></div><br/><div class="children"><div class="content">Use a GRETAP interface; Red Hat&#x27;s virtual interface documentation is phenomenal:<p><a href="https:&#x2F;&#x2F;developers.redhat.com&#x2F;blog&#x2F;2019&#x2F;05&#x2F;17&#x2F;an-introduction-to-linux-virtual-interfaces-tunnels" rel="nofollow">https:&#x2F;&#x2F;developers.redhat.com&#x2F;blog&#x2F;2019&#x2F;05&#x2F;17&#x2F;an-introductio...</a></div><br/><div id="36051394" class="c"><input type="checkbox" id="c-36051394" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36050559">parent</a><span>|</span><a href="#36050413">next</a><span>|</span><label class="collapse" for="c-36051394">[-]</label><label class="expand" for="c-36051394">[3 more]</label></div><br/><div class="children"><div class="content">The docs are indeed great, but to me it seems like they are recommending GENEVE (RFC 8926):<p>&gt; Generic Network Virtualization Encapsulation (GENEVE) supports all of the capabilities of VXLAN, NVGRE, and STT and was designed to overcome their perceived limitations. Many believe GENEVE could eventually replace these earlier formats entirely<p>I&#x27;m bit surprised that they didn&#x27;t have section on vxlan there considering it is pretty popular afaik?<p>Anyways, I think tunneling GENEVE (or any other Ethernet-over-IP protocol) should work fine over WireGuard, same as using regular network interfaces.</div><br/><div id="36052620" class="c"><input type="checkbox" id="c-36052620" checked=""/><div class="controls bullet"><span class="by">pm2222</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051394">parent</a><span>|</span><a href="#36051536">next</a><span>|</span><label class="collapse" for="c-36052620">[-]</label><label class="expand" for="c-36052620">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;developers.redhat.com&#x2F;blog&#x2F;2018&#x2F;10&#x2F;22&#x2F;introduction-to-linux-interfaces-for-virtual-networking" rel="nofollow">https:&#x2F;&#x2F;developers.redhat.com&#x2F;blog&#x2F;2018&#x2F;10&#x2F;22&#x2F;introduction-t...</a> vxlan and many others are here</div><br/></div></div><div id="36051536" class="c"><input type="checkbox" id="c-36051536" checked=""/><div class="controls bullet"><span class="by">gammajmp</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051394">parent</a><span>|</span><a href="#36052620">prev</a><span>|</span><a href="#36050413">next</a><span>|</span><label class="collapse" for="c-36051536">[-]</label><label class="expand" for="c-36051536">[1 more]</label></div><br/><div class="children"><div class="content">Yes! I definitely agree. I&#x27;ve used GRETAP for L2 over Wireguard in the past, but it was quite a while ago. GENEVE looks like the way to go these days</div><br/></div></div></div></div></div></div><div id="36050413" class="c"><input type="checkbox" id="c-36050413" checked=""/><div class="controls bullet"><span class="by">usui</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36049564">parent</a><span>|</span><a href="#36050559">prev</a><span>|</span><a href="#36049645">next</a><span>|</span><label class="collapse" for="c-36050413">[-]</label><label class="expand" for="c-36050413">[9 more]</label></div><br/><div class="children"><div class="content">Since WireGuard is Layer 3, what would is everyone&#x27;s use case of doing Layer 2 on it? Or, what can it improve over existing solutions? I have tried to do the same for a bit while still learning networking, but ran into Layer 3 limitations.</div><br/><div id="36051441" class="c"><input type="checkbox" id="c-36051441" checked=""/><div class="controls bullet"><span class="by">simonjgreen</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36050413">parent</a><span>|</span><a href="#36051619">next</a><span>|</span><label class="collapse" for="c-36051441">[-]</label><label class="expand" for="c-36051441">[1 more]</label></div><br/><div class="children"><div class="content">People who require layer 2 require either a protocol which is neither TCP nor UDP or they need devices in the same broadcast domain</div><br/></div></div><div id="36051619" class="c"><input type="checkbox" id="c-36051619" checked=""/><div class="controls bullet"><span class="by">systems_glitch</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36050413">parent</a><span>|</span><a href="#36051441">prev</a><span>|</span><a href="#36053211">next</a><span>|</span><label class="collapse" for="c-36051619">[-]</label><label class="expand" for="c-36051619">[3 more]</label></div><br/><div class="children"><div class="content">Probably the most common use case is letting Avahi&#x2F;Bonjour&#x2F;etc. or DHCP work across a tunnel.</div><br/><div id="36052212" class="c"><input type="checkbox" id="c-36052212" checked=""/><div class="controls bullet"><span class="by">tjohns</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051619">parent</a><span>|</span><a href="#36053211">next</a><span>|</span><label class="collapse" for="c-36052212">[-]</label><label class="expand" for="c-36052212">[2 more]</label></div><br/><div class="children"><div class="content">Bonjour is built on top of DNS. You don&#x27;t need a layer 2 tunnel to make it work.<p>However, it normally does rely on multicast. Rather than trying to bridge broadcast domains (which is going to cause performance issues), a more efficient option is to setup an Avahi mDNS reflector on either end of the tunnel to rebroadcast mDNS packets.<p>See, for example: <a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;WireGuard&#x2F;comments&#x2F;g80bxf&#x2F;comment&#x2F;hr9bqi4&#x2F;?utm_source=reddit&amp;utm_medium=web2x&amp;context=3" rel="nofollow">https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;WireGuard&#x2F;comments&#x2F;g80bxf&#x2F;comment&#x2F;h...</a><p>Alternatively, there&#x27;s also a Wide-Area Bonjour service that works over unicast and doesn&#x27;t need any special packet forwarding, provided you run a Bonjour-aware DNS server:<p><a href="http:&#x2F;&#x2F;www.dns-sd.org&#x2F;serversetup.html" rel="nofollow">http:&#x2F;&#x2F;www.dns-sd.org&#x2F;serversetup.html</a><p><a href="https:&#x2F;&#x2F;help.dyn.com&#x2F;bonjour-and-dns-discovery&#x2F;" rel="nofollow">https:&#x2F;&#x2F;help.dyn.com&#x2F;bonjour-and-dns-discovery&#x2F;</a><p>(More generally, Layer 2 tunnels are best avoided unless you really need them for something arcane, like IPX or NetBIOS.)</div><br/><div id="36054947" class="c"><input type="checkbox" id="c-36054947" checked=""/><div class="controls bullet"><span class="by">simonjgreen</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36052212">parent</a><span>|</span><a href="#36053211">next</a><span>|</span><label class="collapse" for="c-36054947">[-]</label><label class="expand" for="c-36054947">[1 more]</label></div><br/><div class="children"><div class="content">You are technically correct (best kind of correct) however, in reality, I see folks using L2 tunnels to solve for bonjour etc all the time. Usually those without networking knowledge to solve the forwarding.</div><br/></div></div></div></div></div></div><div id="36053211" class="c"><input type="checkbox" id="c-36053211" checked=""/><div class="controls bullet"><span class="by">teleforce</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36050413">parent</a><span>|</span><a href="#36051619">prev</a><span>|</span><a href="#36051437">next</a><span>|</span><label class="collapse" for="c-36053211">[-]</label><label class="expand" for="c-36053211">[2 more]</label></div><br/><div class="children"><div class="content">The best way to perform something like this on Layer 2 is to use Shortest Path Bridging (SPB) based on IEEE 802.1Q-2018. However the Linux kernel does not yet fully supporting this feature natively although the standard has been out for quite sometime and already being supported by commercial network solutions and the popular Open vSwitch (OVS) [1].<p>[1] Ask HN: Project ideas for a Linux kernel module:<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35785158" rel="nofollow">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=35785158</a></div><br/><div id="36053585" class="c"><input type="checkbox" id="c-36053585" checked=""/><div class="controls bullet"><span class="by">wmf</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36053211">parent</a><span>|</span><a href="#36051437">next</a><span>|</span><label class="collapse" for="c-36053585">[-]</label><label class="expand" for="c-36053585">[1 more]</label></div><br/><div class="children"><div class="content">SPB uses MAC-in-MAC encapsulation which won&#x27;t help you run over Wireguard. You need some flavor of Ethernet over IP like GRE, VXLAN, or GENEVE.</div><br/></div></div></div></div><div id="36051437" class="c"><input type="checkbox" id="c-36051437" checked=""/><div class="controls bullet"><span class="by">zokier</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36050413">parent</a><span>|</span><a href="#36053211">prev</a><span>|</span><a href="#36049645">next</a><span>|</span><label class="collapse" for="c-36051437">[-]</label><label class="expand" for="c-36051437">[2 more]</label></div><br/><div class="children"><div class="content">One example usecase would be to try to tunnel something like BOOTP&#x2F;DHCP&#x2F;PXE&#x2F;TFTP stack, which iirc is bit tricky with only L3 tunneling.</div><br/><div id="36054951" class="c"><input type="checkbox" id="c-36054951" checked=""/><div class="controls bullet"><span class="by">simonjgreen</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36051437">parent</a><span>|</span><a href="#36049645">next</a><span>|</span><label class="collapse" for="c-36054951">[-]</label><label class="expand" for="c-36054951">[1 more]</label></div><br/><div class="children"><div class="content">Yes, this is common among those who don&#x27;t understand how DHCP Relay works</div><br/></div></div></div></div></div></div><div id="36049645" class="c"><input type="checkbox" id="c-36049645" checked=""/><div class="controls bullet"><span class="by">FL410</span><span>|</span><a href="#36048871">root</a><span>|</span><a href="#36049564">parent</a><span>|</span><a href="#36050413">prev</a><span>|</span><a href="#36049143">next</a><span>|</span><label class="collapse" for="c-36049645">[-]</label><label class="expand" for="c-36049645">[1 more]</label></div><br/><div class="children"><div class="content">Me too.</div><br/></div></div></div></div></div></div><div id="36051067" class="c"><input type="checkbox" id="c-36051067" checked=""/><div class="controls bullet"><span class="by">mulmen</span><span>|</span><a href="#36048871">prev</a><span>|</span><a href="#36049664">next</a><span>|</span><label class="collapse" for="c-36051067">[-]</label><label class="expand" for="c-36051067">[3 more]</label></div><br/><div class="children"><div class="content">Meta: Huh.  I don’t use “shallow dive” enough.  “Deep dive” of course, everyone loves a good deep dive.  But what about a shallow dive, or even just “getting your feet wet”?  These are useful concepts too.  This headline alone revealed a blind spot for me.</div><br/><div id="36054085" class="c"><input type="checkbox" id="c-36054085" checked=""/><div class="controls bullet"><span class="by">kagevf</span><span>|</span><a href="#36051067">parent</a><span>|</span><a href="#36051926">next</a><span>|</span><label class="collapse" for="c-36054085">[-]</label><label class="expand" for="c-36054085">[1 more]</label></div><br/><div class="children"><div class="content">Maybe we can expand X in Y minutes beyond programming languages?</div><br/></div></div><div id="36051926" class="c"><input type="checkbox" id="c-36051926" checked=""/><div class="controls bullet"><span class="by">bryancoxwell</span><span>|</span><a href="#36051067">parent</a><span>|</span><a href="#36054085">prev</a><span>|</span><a href="#36049664">next</a><span>|</span><label class="collapse" for="c-36051926">[-]</label><label class="expand" for="c-36051926">[1 more]</label></div><br/><div class="children"><div class="content">Had the same thought. Could do with more shallow dives to be honest.</div><br/></div></div></div></div><div id="36049664" class="c"><input type="checkbox" id="c-36049664" checked=""/><div class="controls bullet"><span class="by">Snawoot</span><span>|</span><a href="#36051067">prev</a><span>|</span><a href="#36054753">next</a><span>|</span><label class="collapse" for="c-36049664">[-]</label><label class="expand" for="c-36049664">[1 more]</label></div><br/><div class="children"><div class="content">Or instead you can have HTTP proxy over TLS in just four steps: <a href="https:&#x2F;&#x2F;github.com&#x2F;Snawoot&#x2F;dumbproxy&#x2F;wiki&#x2F;Quick-deployment">https:&#x2F;&#x2F;github.com&#x2F;Snawoot&#x2F;dumbproxy&#x2F;wiki&#x2F;Quick-deployment</a><p>You don&#x27;t even need a client for this, any modern browser can work with it right away: <a href="https:&#x2F;&#x2F;github.com&#x2F;Snawoot&#x2F;dumbproxy#using-http-over-tls-proxy">https:&#x2F;&#x2F;github.com&#x2F;Snawoot&#x2F;dumbproxy#using-http-over-tls-pro...</a></div><br/></div></div><div id="36054753" class="c"><input type="checkbox" id="c-36054753" checked=""/><div class="controls bullet"><span class="by">jarym</span><span>|</span><a href="#36049664">prev</a><span>|</span><a href="#36050162">next</a><span>|</span><label class="collapse" for="c-36054753">[-]</label><label class="expand" for="c-36054753">[1 more]</label></div><br/><div class="children"><div class="content">Dumb question but the frp example shows op forwarding to port 443 on local, how then did the spammers get access to port 25 or was there a separate forward rule setup for 25?</div><br/></div></div><div id="36050162" class="c"><input type="checkbox" id="c-36050162" checked=""/><div class="controls bullet"><span class="by">garbagecoder</span><span>|</span><a href="#36054753">prev</a><span>|</span><a href="#36048115">next</a><span>|</span><label class="collapse" for="c-36050162">[-]</label><label class="expand" for="c-36050162">[4 more]</label></div><br/><div class="children"><div class="content">I just moved from OpenVPN to tailscale, which uses Wireguard, on my personal stuff. I have a similar situation as OP describes at first where my residential account has the ports blocked.<p>I am quite happy so far, just wish it was innately supported in my consumer grade router, which support vanilla wireguard.</div><br/><div id="36050613" class="c"><input type="checkbox" id="c-36050613" checked=""/><div class="controls bullet"><span class="by">manmal</span><span>|</span><a href="#36050162">parent</a><span>|</span><a href="#36050803">next</a><span>|</span><label class="collapse" for="c-36050613">[-]</label><label class="expand" for="c-36050613">[1 more]</label></div><br/><div class="children"><div class="content">I thought tailscale works through all kinds of firewalls due to some connection setup magic (initiating connection from both sides at once).<p>EDIT: I think I misunderstood your comment, you probably are wishing for tailscale client support in the router?</div><br/></div></div><div id="36050803" class="c"><input type="checkbox" id="c-36050803" checked=""/><div class="controls bullet"><span class="by">nirav72</span><span>|</span><a href="#36050162">parent</a><span>|</span><a href="#36050613">prev</a><span>|</span><a href="#36048115">next</a><span>|</span><label class="collapse" for="c-36050803">[-]</label><label class="expand" for="c-36050803">[2 more]</label></div><br/><div class="children"><div class="content">&gt;consumer grade router, which support vanilla wireguard.<p>See if your consumer grade router supports flashing OpenWRT. It supports Wireguard.</div><br/><div id="36051303" class="c"><input type="checkbox" id="c-36051303" checked=""/><div class="controls bullet"><span class="by">garbagecoder</span><span>|</span><a href="#36050162">root</a><span>|</span><a href="#36050803">parent</a><span>|</span><a href="#36048115">next</a><span>|</span><label class="collapse" for="c-36051303">[-]</label><label class="expand" for="c-36051303">[1 more]</label></div><br/><div class="children"><div class="content">It doesn&#x27;t, really. It&#x27;s an AX-82 and there&#x27;s only a hackish version for it.</div><br/></div></div></div></div></div></div><div id="36048115" class="c"><input type="checkbox" id="c-36048115" checked=""/><div class="controls bullet"><span class="by">sushidev</span><span>|</span><a href="#36050162">prev</a><span>|</span><a href="#36048105">next</a><span>|</span><label class="collapse" for="c-36048115">[-]</label><label class="expand" for="c-36048115">[2 more]</label></div><br/><div class="children"><div class="content">i agree it&#x27;s very hard to learn from the internet.. (the bottomline in the post)</div><br/><div id="36052134" class="c"><input type="checkbox" id="c-36052134" checked=""/><div class="controls bullet"><span class="by">harry8</span><span>|</span><a href="#36048115">parent</a><span>|</span><a href="#36048105">next</a><span>|</span><label class="collapse" for="c-36052134">[-]</label><label class="expand" for="c-36052134">[1 more]</label></div><br/><div class="children"><div class="content">It was incredibly so much easier when popular search engines did search instead of &quot;recommendation.&quot; The hardest thing is actually finding the thing that exists, in multiple forms, that you set out to find.<p>We&#x27;ve gone backwards in the past 15 years.</div><br/></div></div></div></div><div id="36048105" class="c"><input type="checkbox" id="c-36048105" checked=""/><div class="controls bullet"><span class="by">sushidev</span><span>|</span><a href="#36048115">prev</a><span>|</span><a href="#36041170">next</a><span>|</span><label class="collapse" for="c-36048105">[-]</label><label class="expand" for="c-36048105">[1 more]</label></div><br/><div class="children"><div class="content">nice</div><br/></div></div><div id="36041170" class="c"><input type="checkbox" id="c-36041170" checked=""/><div class="controls bullet"><span class="by">hkwerf</span><span>|</span><a href="#36048105">prev</a><span>|</span><a href="#36048317">next</a><span>|</span><label class="collapse" for="c-36041170">[-]</label><label class="expand" for="c-36041170">[3 more]</label></div><br/><div class="children"><div class="content">Link was probably supposed to be <a href="https:&#x2F;&#x2F;im.salty.fish&#x2F;index.php&#x2F;archives&#x2F;linux-networking-shallow-dive.html" rel="nofollow">https:&#x2F;&#x2F;im.salty.fish&#x2F;index.php&#x2F;archives&#x2F;linux-networking-sh...</a>.</div><br/><div id="36041808" class="c"><input type="checkbox" id="c-36041808" checked=""/><div class="controls bullet"><span class="by">devStorms</span><span>|</span><a href="#36041170">parent</a><span>|</span><a href="#36046930">next</a><span>|</span><label class="collapse" for="c-36041808">[-]</label><label class="expand" for="c-36041808">[1 more]</label></div><br/><div class="children"><div class="content">Yup thanks for pointing out. There was an issue with the canonical link meta tag. Should be fixed now :)</div><br/></div></div><div id="36046930" class="c"><input type="checkbox" id="c-36046930" checked=""/><div class="controls bullet"><span class="by">dang</span><span>|</span><a href="#36041170">parent</a><span>|</span><a href="#36041808">prev</a><span>|</span><a href="#36048317">next</a><span>|</span><label class="collapse" for="c-36046930">[-]</label><label class="expand" for="c-36046930">[1 more]</label></div><br/><div class="children"><div class="content">Fixed above. Thanks!</div><br/></div></div></div></div><div id="36048317" class="c"><input type="checkbox" id="c-36048317" checked=""/><div class="controls bullet"><span class="by">litia</span><span>|</span><a href="#36041170">prev</a><span>|</span><a href="#36053483">next</a><span>|</span><label class="collapse" for="c-36048317">[-]</label><label class="expand" for="c-36048317">[1 more]</label></div><br/><div class="children"><div class="content">tql</div><br/></div></div><div id="36053483" class="c"><input type="checkbox" id="c-36053483" checked=""/><div class="controls bullet"><span class="by">igtztorrero</span><span>|</span><a href="#36048317">prev</a><span>|</span><a href="#36048396">next</a><span>|</span><label class="collapse" for="c-36053483">[-]</label><label class="expand" for="c-36053483">[1 more]</label></div><br/><div class="children"><div class="content">UPS and Downs a chinesse programmer should do.
Hosting is prohibited in CN<p>It would be interesting to make a Github repo titled: how to hack CN goverment !</div><br/></div></div><div id="36048396" class="c"><input type="checkbox" id="c-36048396" checked=""/><div class="controls bullet"><span class="by">jmclnx</span><span>|</span><a href="#36053483">prev</a><span>|</span><label class="collapse" for="c-36048396">[-]</label><label class="expand" for="c-36048396">[5 more]</label></div><br/><div class="children"><div class="content">For people using wireguard, it was not designed to provide anonymity.  Otherwise it is fine for use in Countries with decent protections for their citizens. If you need privacy, you should use OpenVPN.<p>Quote:<p>&gt;WireGuard is highly secure, but it’s not designed with privacy in mind.<p>from<p><a href="https:&#x2F;&#x2F;www.tomsguide.com&#x2F;how-to&#x2F;is-the-new-wireguard-protocol-secure" rel="nofollow">https:&#x2F;&#x2F;www.tomsguide.com&#x2F;how-to&#x2F;is-the-new-wireguard-protoc...</a></div><br/><div id="36048668" class="c"><input type="checkbox" id="c-36048668" checked=""/><div class="controls bullet"><span class="by">nixcraft</span><span>|</span><a href="#36048396">parent</a><span>|</span><a href="#36051020">next</a><span>|</span><label class="collapse" for="c-36048668">[-]</label><label class="expand" for="c-36048668">[1 more]</label></div><br/><div class="children"><div class="content">&gt; WireGuard is highly secure, but it’s not designed with privacy in mind.<p>I&#x27;m sorry, but I must inform you that the Toms guide contains affiliate links to OpenVPN services. However, it is important to note that neither OpenVPN nor WireGuard can guarantee your safety if you are being targeted by government agencies. The guide&#x27;s attempt from TFA is to promote these VPN services as a solution for anonymity and censorship (deep packets inspection can block all VPN protocols) avoidance is misleading. VPNs are primarily useful for accessing corporate or home resources and viewing geo-blocked streaming content (say from your home network) on insecure networks like hotel or cafe WiFi.</div><br/></div></div><div id="36051020" class="c"><input type="checkbox" id="c-36051020" checked=""/><div class="controls bullet"><span class="by">icehawk</span><span>|</span><a href="#36048396">parent</a><span>|</span><a href="#36048668">prev</a><span>|</span><a href="#36048594">next</a><span>|</span><label class="collapse" for="c-36051020">[-]</label><label class="expand" for="c-36051020">[1 more]</label></div><br/><div class="children"><div class="content">Parts of this article are just downright wrong<p><i>At time of writing, the biggest privacy weakness that WireGuard has is how it assigns IP addresses. When you connect to a VPN service using OpenVPN or IKEv2, you’re assigned a different IP address each time. WireGuard instead gives you the same IP address each time. This is faster, but it means the VPN server must keep logs of your real IP address and connection timestamps.</i><p>The address assigned inside the tunnel has nothing to do with your real address, and definitely does not have anything to do with whether or not the VPN server is keeping logs of your real IP address and timestamps of your connection.<p>OpenVPN and charon keep far more logs of those things by default that wireguard and you have to trust your VPN provider turned them off.</div><br/></div></div><div id="36048594" class="c"><input type="checkbox" id="c-36048594" checked=""/><div class="controls bullet"><span class="by">jbverschoor</span><span>|</span><a href="#36048396">parent</a><span>|</span><a href="#36051020">prev</a><span>|</span><a href="#36048821">next</a><span>|</span><label class="collapse" for="c-36048594">[-]</label><label class="expand" for="c-36048594">[1 more]</label></div><br/><div class="children"><div class="content">Almost nothing was created with privacy in mind. Security and privacy are different things.<p>I hate that people think that a VPN is private as in anonymous. But then again, those providers had great marketing.. So now devs and sysops need to call VPNs &quot;tunneled networks&quot;.</div><br/></div></div><div id="36048821" class="c"><input type="checkbox" id="c-36048821" checked=""/><div class="controls bullet"><span class="by">freedomben</span><span>|</span><a href="#36048396">parent</a><span>|</span><a href="#36048594">prev</a><span>|</span><label class="collapse" for="c-36048821">[-]</label><label class="expand" for="c-36048821">[1 more]</label></div><br/><div class="children"><div class="content">You&#x27;re not wrong, but there are VPN services that add on privacy to their wireguard offerings, such as PIA (private internet access).  They open sourced the connection code so you can see how they do it[1] using an API that initializes a temporary wireguard connection for you.  I&#x27;ve been really pleased with PIA&#x27;s wireguard setup, which even includes forwarding of an incoming port!<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;pia-foss&#x2F;manual-connections&#x2F;blob&#x2F;master&#x2F;connect_to_wireguard_with_token.sh">https:&#x2F;&#x2F;github.com&#x2F;pia-foss&#x2F;manual-connections&#x2F;blob&#x2F;master&#x2F;c...</a></div><br/></div></div></div></div></div></div></div></div></div></body></html>