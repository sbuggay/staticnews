<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1702803670708" as="style"/><link rel="stylesheet" href="styles.css?v=1702803670708"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://jack-vanlightly.com/blog/2023/11/29/s3-express-one-zone-not-quite-what-i-hoped-for">S3 Express One Zone, not quite what I hoped for</a> <span class="domain">(<a href="https://jack-vanlightly.com">jack-vanlightly.com</a>)</span></div><div class="subtext"><span>e2e4</span> | <span>17 comments</span></div><br/><div><div id="38669957" class="c"><input type="checkbox" id="c-38669957" checked=""/><div class="controls bullet"><span class="by">zX41ZdbW</span><span>|</span><a href="#38670515">next</a><span>|</span><label class="collapse" for="c-38669957">[-]</label><label class="expand" for="c-38669957">[1 more]</label></div><br/><div class="children"><div class="content">A small correction about ClickHouse Cloud:<p>1. It uses a cache on local SSDs (&quot;instance store&quot; in AWS terms) + page cache in memory.<p>2. This is a write-through cache. The data is written into cache and S3.<p>3. Writes to S3 are synchronous. The write is confirmed only after the data is accepted by S3, and the metadata is accepted by ClickHouse Keeper.<p>4. The cache is ephemeral (not durable, not redundant, not essential for work).<p>5. The consistency requirements are fairly strict. Although it is still possible to have a stale read on a replica due to sequentially consistent replication of the metadata, it is not related to S3 or the cache either.<p>6. It is expected to have low latency on reads, while latency on writes can be tolerated up to around one second.<p>7. We also tested S3 Express One Zone: <a href="https:&#x2F;&#x2F;aws.amazon.com&#x2F;blogs&#x2F;storage&#x2F;clickhouse-cloud-amazon-s3-express-one-zone-making-a-blazing-fast-analytical-database-even-faster&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;aws.amazon.com&#x2F;blogs&#x2F;storage&#x2F;clickhouse-cloud-amazon...</a></div><br/></div></div><div id="38670515" class="c"><input type="checkbox" id="c-38670515" checked=""/><div class="controls bullet"><span class="by">DylanSp</span><span>|</span><a href="#38669957">prev</a><span>|</span><a href="#38670886">next</a><span>|</span><label class="collapse" for="c-38670515">[-]</label><label class="expand" for="c-38670515">[2 more]</label></div><br/><div class="children"><div class="content">Interesting article, though I wish there were some more concrete numbers, particularly around latency - what&#x27;s the latency on normal S3, what is it on S3 Express One Zone, and what latency&#x2F;throughput is necessary for the kind of systems he&#x27;s talking about? Some cost estimates would also be interesting, though that would be harder to figure out.</div><br/><div id="38671015" class="c"><input type="checkbox" id="c-38671015" checked=""/><div class="controls bullet"><span class="by">JoshTriplett</span><span>|</span><a href="#38670515">parent</a><span>|</span><a href="#38670886">next</a><span>|</span><label class="collapse" for="c-38671015">[-]</label><label class="expand" for="c-38671015">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;d love to see those latency numbers for S3 Standard and S3 Express One Zone as well.</div><br/></div></div></div></div><div id="38670886" class="c"><input type="checkbox" id="c-38670886" checked=""/><div class="controls bullet"><span class="by">camkego</span><span>|</span><a href="#38670515">prev</a><span>|</span><a href="#38669461">next</a><span>|</span><label class="collapse" for="c-38670886">[-]</label><label class="expand" for="c-38670886">[3 more]</label></div><br/><div class="children"><div class="content">Any S3 experts in the house?<p>Does Amazon S3 use erasure coding or a similar scheme to increase durability?<p>Is erasure coding or another redundancy&#x2F;durability scheme the primary cause of the high latency?<p>Does Minio have a similar latency profile? What about other S3 software solutions.<p>I know it&#x27;s a lot, but maybe someone wants to share?<p>If there are any papers or articles on the specifics of this, please share!</div><br/><div id="38671321" class="c"><input type="checkbox" id="c-38671321" checked=""/><div class="controls bullet"><span class="by">jmpman</span><span>|</span><a href="#38670886">parent</a><span>|</span><a href="#38671170">next</a><span>|</span><label class="collapse" for="c-38671321">[-]</label><label class="expand" for="c-38671321">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?si=M2dVLHnmHsTG47XR&amp;t=23m25s&amp;v=sc3J4McebHE&amp;feature=youtu.be" rel="nofollow noreferrer">https:&#x2F;&#x2F;m.youtube.com&#x2F;watch?si=M2dVLHnmHsTG47XR&amp;t=23m25s&amp;v=s...</a></div><br/></div></div><div id="38671170" class="c"><input type="checkbox" id="c-38671170" checked=""/><div class="controls bullet"><span class="by">ec109685</span><span>|</span><a href="#38670886">parent</a><span>|</span><a href="#38671321">prev</a><span>|</span><a href="#38669461">next</a><span>|</span><label class="collapse" for="c-38671170">[-]</label><label class="expand" for="c-38671170">[1 more]</label></div><br/><div class="children"><div class="content">This is a good write up: <a href="https:&#x2F;&#x2F;www.allthingsdistributed.com&#x2F;2023&#x2F;07&#x2F;building-and-operating-a-pretty-big-storage-system.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.allthingsdistributed.com&#x2F;2023&#x2F;07&#x2F;building-and-op...</a></div><br/></div></div></div></div><div id="38669461" class="c"><input type="checkbox" id="c-38669461" checked=""/><div class="controls bullet"><span class="by">JoshTriplett</span><span>|</span><a href="#38670886">prev</a><span>|</span><a href="#38670796">next</a><span>|</span><label class="collapse" for="c-38669461">[-]</label><label class="expand" for="c-38669461">[4 more]</label></div><br/><div class="children"><div class="content">One nice thing about this: despite the &quot;one zone&quot; in the name, it still has the <i>durability</i> of standard S3, just not the <i>availability</i>.</div><br/><div id="38669714" class="c"><input type="checkbox" id="c-38669714" checked=""/><div class="controls bullet"><span class="by">jpittis</span><span>|</span><a href="#38669461">parent</a><span>|</span><a href="#38669615">next</a><span>|</span><label class="collapse" for="c-38669714">[-]</label><label class="expand" for="c-38669714">[1 more]</label></div><br/><div class="children"><div class="content">Keep in mind that &quot;one zone&quot; has durability implications:<p>&gt; In the unlikely case of the loss or damage to all or part of an AWS Availability Zone, data in a One Zone storage class may be lost. For example, events like fire and water damage could result in data loss.</div><br/></div></div><div id="38669615" class="c"><input type="checkbox" id="c-38669615" checked=""/><div class="controls bullet"><span class="by">jnsaff2</span><span>|</span><a href="#38669461">parent</a><span>|</span><a href="#38669714">prev</a><span>|</span><a href="#38670796">next</a><span>|</span><label class="collapse" for="c-38669615">[-]</label><label class="expand" for="c-38669615">[2 more]</label></div><br/><div class="children"><div class="content">Or yet another example of horrible naming from AWS.</div><br/><div id="38670574" class="c"><input type="checkbox" id="c-38670574" checked=""/><div class="controls bullet"><span class="by">dylan604</span><span>|</span><a href="#38669461">root</a><span>|</span><a href="#38669615">parent</a><span>|</span><a href="#38670796">next</a><span>|</span><label class="collapse" for="c-38670574">[-]</label><label class="expand" for="c-38670574">[1 more]</label></div><br/><div class="children"><div class="content">They&#x27;re as bad as bigPharma, but they take the non-sense name and make it unpronounceable. At least we can say the AWS name even if it is just as meaningless</div><br/></div></div></div></div></div></div><div id="38670796" class="c"><input type="checkbox" id="c-38670796" checked=""/><div class="controls bullet"><span class="by">up2isomorphism</span><span>|</span><a href="#38669461">prev</a><span>|</span><a href="#38669844">next</a><span>|</span><label class="collapse" for="c-38670796">[-]</label><label class="expand" for="c-38670796">[3 more]</label></div><br/><div class="children"><div class="content">Nobody seems to bother but why anybody who use a cloud object storage will care about latency?</div><br/><div id="38670888" class="c"><input type="checkbox" id="c-38670888" checked=""/><div class="controls bullet"><span class="by">wenc</span><span>|</span><a href="#38670796">parent</a><span>|</span><a href="#38671057">next</a><span>|</span><label class="collapse" for="c-38670888">[-]</label><label class="expand" for="c-38670888">[1 more]</label></div><br/><div class="children"><div class="content">For me, I want to be able to query data faster.<p>SQL queries on S3 data are affected by read latencies. When you&#x27;re doing huge aggregations and joins say on Parquet files, the engine has to read the Parquet metadata multiple times, and read the relevant portions of the data. There are multiple reads going on, and every read incurs latency.<p>Implementing a caching layer really helps, but it&#x27;s not out of the box.</div><br/></div></div></div></div><div id="38669844" class="c"><input type="checkbox" id="c-38669844" checked=""/><div class="controls bullet"><span class="by">refulgentis</span><span>|</span><a href="#38670796">prev</a><span>|</span><label class="collapse" for="c-38669844">[-]</label><label class="expand" for="c-38669844">[3 more]</label></div><br/><div class="children"><div class="content">What does high latency mean in this case? I&#x27;ve been in mobile for 15 years and now find myself using S3 as a document backup space. I&#x27;m rather alarmed because I&#x27;m only seeing, idk, 200-400 ms of latency. But then again, I&#x27;m in Boston. Am I just lucky to be near US-East?</div><br/><div id="38670003" class="c"><input type="checkbox" id="c-38670003" checked=""/><div class="controls bullet"><span class="by">trillic</span><span>|</span><a href="#38669844">parent</a><span>|</span><a href="#38670823">next</a><span>|</span><label class="collapse" for="c-38670003">[-]</label><label class="expand" for="c-38670003">[1 more]</label></div><br/><div class="children"><div class="content">200ms is enough for an RTT from Boston-Auckland-Boston. S3 is slow. You’re single digit milliseconds from us-east-1 under optimal conditions.</div><br/></div></div><div id="38670823" class="c"><input type="checkbox" id="c-38670823" checked=""/><div class="controls bullet"><span class="by">isignal</span><span>|</span><a href="#38669844">parent</a><span>|</span><a href="#38670003">prev</a><span>|</span><label class="collapse" for="c-38670823">[-]</label><label class="expand" for="c-38670823">[1 more]</label></div><br/><div class="children"><div class="content">For a key value store you expect server side latencies less than 5 ms for point gets and writes.</div><br/></div></div></div></div></div></div></div></div></div></body></html>