<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1711443656754" as="style"/><link rel="stylesheet" href="styles.css?v=1711443656754"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/robertmuth/Cwerg">Cwerg: C-like language that can be implemented in 10kLOC</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>nateb2022</span> | <span>31 comments</span></div><br/><div><div id="39790410" class="c"><input type="checkbox" id="c-39790410" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39793176">prev</a><span>|</span><a href="#39789245">next</a><span>|</span><label class="collapse" for="c-39790410">[-]</label><label class="expand" for="c-39790410">[7 more]</label></div><br/><div class="children"><div class="content">Author here - happy to answer questions</div><br/><div id="39791685" class="c"><input type="checkbox" id="c-39791685" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#39790410">parent</a><span>|</span><a href="#39792276">next</a><span>|</span><label class="collapse" for="c-39791685">[-]</label><label class="expand" for="c-39791685">[4 more]</label></div><br/><div class="children"><div class="content">&gt; Author here - happy to answer questions<p>What&#x27;s the goal with this? I mean, where are you going with this?<p>Research language? Scratching an itch? Learning exercise?<p>All good answers, IMHO.<p>But ... is there a real gap in the needs of programmers that  Cwerg is attempting to address? If there is, can you explain a little more the actual gap being addressed?</div><br/><div id="39792232" class="c"><input type="checkbox" id="c-39792232" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39790410">root</a><span>|</span><a href="#39791685">parent</a><span>|</span><a href="#39791925">next</a><span>|</span><label class="collapse" for="c-39792232">[-]</label><label class="expand" for="c-39792232">[1 more]</label></div><br/><div class="children"><div class="content">Cwerg started off as a &quot;Covid side project&quot; with no pericular goal other than seeing how far you can push something that is simple enough be maintained by a single person. Oberon was an inspiration and I&#x27;d like to make Cwerg self hosted and maybe work on an OS written in it some day.<p>In term of features, Cwerg is roughly in the same space as Odin, Zig, Hare, etc.
(see <a href="https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;awesome-low-level-programming-languages">https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;awesome-low-level-programming-...</a>)
But I am much more willing to sacrifice compatibility for simplicity, e.g.
no shared libs, no varargs, no linking with non-Cwerg code etc.<p>I also feel that compilation speed has not received as much attention in the compiler space as it deserves. Go-lang was one of the first to highlight this recently.</div><br/></div></div><div id="39791925" class="c"><input type="checkbox" id="c-39791925" checked=""/><div class="controls bullet"><span class="by">bobajeff</span><span>|</span><a href="#39790410">root</a><span>|</span><a href="#39791685">parent</a><span>|</span><a href="#39792232">prev</a><span>|</span><a href="#39792276">next</a><span>|</span><label class="collapse" for="c-39791925">[-]</label><label class="expand" for="c-39791925">[2 more]</label></div><br/><div class="children"><div class="content">I too am curious about this. I&#x27;ve seen other languages with similar features similar such as Odin and C3 but they used llvm and now Odin is trying to use TildeBackend (from cuik c compiler) as an alternative. What i&#x27;m really interested in, is if the risc-like IR is a alternative to llvm.</div><br/><div id="39792289" class="c"><input type="checkbox" id="c-39792289" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39790410">root</a><span>|</span><a href="#39791925">parent</a><span>|</span><a href="#39792276">next</a><span>|</span><label class="collapse" for="c-39792289">[-]</label><label class="expand" for="c-39792289">[1 more]</label></div><br/><div class="children"><div class="content">This section contains a list of features that are unlikely to be added to the Cwerg backend:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg?tab=readme-ov-file#intentional-limitations">https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg?tab=readme-ov-file#inten...</a><p>If you can live without them, it can be a replacement for LLVM.</div><br/></div></div></div></div></div></div><div id="39792276" class="c"><input type="checkbox" id="c-39792276" checked=""/><div class="controls bullet"><span class="by">xcdzvyn</span><span>|</span><a href="#39790410">parent</a><span>|</span><a href="#39791685">prev</a><span>|</span><a href="#39789245">next</a><span>|</span><label class="collapse" for="c-39792276">[-]</label><label class="expand" for="c-39792276">[2 more]</label></div><br/><div class="children"><div class="content">Looking over the Readme, this sounds a lot like Zig. What languages have you taken the most inspiration from?</div><br/><div id="39792675" class="c"><input type="checkbox" id="c-39792675" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39790410">root</a><span>|</span><a href="#39792276">parent</a><span>|</span><a href="#39789245">next</a><span>|</span><label class="collapse" for="c-39792675">[-]</label><label class="expand" for="c-39792675">[1 more]</label></div><br/><div class="children"><div class="content">Hard to say. I created this for inspiration:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;awesome-low-level-programming-languages">https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;awesome-low-level-programming-...</a></div><br/></div></div></div></div></div></div><div id="39789245" class="c"><input type="checkbox" id="c-39789245" checked=""/><div class="controls bullet"><span class="by">bonki</span><span>|</span><a href="#39790410">prev</a><span>|</span><label class="collapse" for="c-39789245">[-]</label><label class="expand" for="c-39789245">[22 more]</label></div><br/><div class="children"><div class="content">C-like and S-expressions? I guess my definition of a C-like language is a bit off.</div><br/><div id="39791334" class="c"><input type="checkbox" id="c-39791334" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#39789245">parent</a><span>|</span><a href="#39789404">next</a><span>|</span><label class="collapse" for="c-39791334">[-]</label><label class="expand" for="c-39791334">[4 more]</label></div><br/><div class="children"><div class="content">They aren&#x27;t incompatible.<p>My own toy language which is intended to be a C replacement for myself is prototyped entirely in s-expressions.<p>What else would you use to represent a syntax tree?</div><br/><div id="39791448" class="c"><input type="checkbox" id="c-39791448" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39791334">parent</a><span>|</span><a href="#39789404">next</a><span>|</span><label class="collapse" for="c-39791448">[-]</label><label class="expand" for="c-39791448">[3 more]</label></div><br/><div class="children"><div class="content">Also with some tweaking you can push s-expr pretty far WRT readability.
Here is an example of a cwerg program using &quot;enhanced&quot; s-exprs:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg&#x2F;blob&#x2F;master&#x2F;FrontEnd&#x2F;TestData&#x2F;wordcount.cw">https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg&#x2F;blob&#x2F;master&#x2F;FrontEnd&#x2F;Tes...</a><p>And here is same the same program in the tentative concrete syntax:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg&#x2F;blob&#x2F;master&#x2F;FrontEnd&#x2F;ConcteteSyntax&#x2F;wordcount.concrete.cw">https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg&#x2F;blob&#x2F;master&#x2F;FrontEnd&#x2F;Con...</a></div><br/><div id="39793141" class="c"><input type="checkbox" id="c-39793141" checked=""/><div class="controls bullet"><span class="by">bonki</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39791448">parent</a><span>|</span><a href="#39791651">next</a><span>|</span><label class="collapse" for="c-39793141">[-]</label><label class="expand" for="c-39793141">[1 more]</label></div><br/><div class="children"><div class="content">I had skimmed through the readme and then went straight to the example folder so missed the fact that this is not supposed to be the final concrete syntax, makes much more sense now!</div><br/></div></div><div id="39791651" class="c"><input type="checkbox" id="c-39791651" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39791448">parent</a><span>|</span><a href="#39793141">prev</a><span>|</span><a href="#39789404">next</a><span>|</span><label class="collapse" for="c-39791651">[-]</label><label class="expand" for="c-39791651">[1 more]</label></div><br/><div class="children"><div class="content">Honestly I&#x27;m doing pretty much the same thing; been through several iterations of AST without yet deciding on a syntax, other than <i>&quot;Easy for C Programmers&quot;</i> and <i>&quot;Doesn&#x27;t look like someone ate alphabet soup and vomited it all over the screen&quot;</i>.</div><br/></div></div></div></div></div></div><div id="39789404" class="c"><input type="checkbox" id="c-39789404" checked=""/><div class="controls bullet"><span class="by">lifthrasiir</span><span>|</span><a href="#39789245">parent</a><span>|</span><a href="#39791334">prev</a><span>|</span><a href="#39789691">next</a><span>|</span><label class="collapse" for="c-39789404">[-]</label><label class="expand" for="c-39789404">[15 more]</label></div><br/><div class="children"><div class="content">Apparently the actual surface syntax is not yet decided and the S-expression abstract syntax is currently used as a stand-in.</div><br/><div id="39790194" class="c"><input type="checkbox" id="c-39790194" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39789404">parent</a><span>|</span><a href="#39791305">next</a><span>|</span><label class="collapse" for="c-39790194">[-]</label><label class="expand" for="c-39790194">[2 more]</label></div><br/><div class="children"><div class="content">That is correct. The concrete syntax will be python-like.
Somer examples are here:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg&#x2F;tree&#x2F;master&#x2F;FrontEnd&#x2F;ConcteteSyntax">https:&#x2F;&#x2F;github.com&#x2F;robertmuth&#x2F;Cwerg&#x2F;tree&#x2F;master&#x2F;FrontEnd&#x2F;Con...</a></div><br/><div id="39796370" class="c"><input type="checkbox" id="c-39796370" checked=""/><div class="controls bullet"><span class="by">alwaysbeconsing</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39790194">parent</a><span>|</span><a href="#39791305">next</a><span>|</span><label class="collapse" for="c-39796370">[-]</label><label class="expand" for="c-39796370">[1 more]</label></div><br/><div class="children"><div class="content">Precedent for Python-like but C-level language in Nim; will be interested to see how yours develops too. Good luck!</div><br/></div></div></div></div><div id="39791305" class="c"><input type="checkbox" id="c-39791305" checked=""/><div class="controls bullet"><span class="by">kouteiheika</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39789404">parent</a><span>|</span><a href="#39790194">prev</a><span>|</span><a href="#39791634">next</a><span>|</span><label class="collapse" for="c-39791305">[-]</label><label class="expand" for="c-39791305">[1 more]</label></div><br/><div class="children"><div class="content">IIRC, wasn&#x27;t this originally also the case for Lisp?</div><br/></div></div><div id="39791634" class="c"><input type="checkbox" id="c-39791634" checked=""/><div class="controls bullet"><span class="by">eigenhombre</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39789404">parent</a><span>|</span><a href="#39791305">prev</a><span>|</span><a href="#39792138">next</a><span>|</span><label class="collapse" for="c-39791634">[-]</label><label class="expand" for="c-39791634">[5 more]</label></div><br/><div class="children"><div class="content">I wonder how hard it would be to keep the S-expression syntax when the new one is implemented.  As a C and Lisp programmer I&#x27;m intrigued by the possibilities - C-family syntax being IMO more readable, but Lisp providing unparalleled (in my experience) metaprogramming possibilities.</div><br/><div id="39791730" class="c"><input type="checkbox" id="c-39791730" checked=""/><div class="controls bullet"><span class="by">lelanthran</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39791634">parent</a><span>|</span><a href="#39792320">next</a><span>|</span><label class="collapse" for="c-39791730">[-]</label><label class="expand" for="c-39791730">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;m also a Lisp and C programmer (want to get better at Forth too).<p>I think Lisp and C (not C++) share an important characteristic that few other languages share: being <i>low-level</i>.<p>C is <i>low-level</i> due to <i>minimal abstractions</i> from the hardware.<p>Lisp is <i>low-level</i> due to <i>minimal abstractions</i> from the AST.<p>People wanting to program very close to hardware feel comfortable with C. People wanting to program very close to the compiler feel comfortable with Lisp.</div><br/></div></div><div id="39792320" class="c"><input type="checkbox" id="c-39792320" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39791634">parent</a><span>|</span><a href="#39791730">prev</a><span>|</span><a href="#39792138">next</a><span>|</span><label class="collapse" for="c-39792320">[-]</label><label class="expand" for="c-39792320">[3 more]</label></div><br/><div class="children"><div class="content">I am planning to make the s-expr form the on disk format.</div><br/><div id="39794210" class="c"><input type="checkbox" id="c-39794210" checked=""/><div class="controls bullet"><span class="by">oconnor0</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39792320">parent</a><span>|</span><a href="#39792138">next</a><span>|</span><label class="collapse" for="c-39794210">[-]</label><label class="expand" for="c-39794210">[2 more]</label></div><br/><div class="children"><div class="content">Does that mean you are planning a specific editor for it?</div><br/><div id="39795774" class="c"><input type="checkbox" id="c-39795774" checked=""/><div class="controls bullet"><span class="by">muth02446</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39794210">parent</a><span>|</span><a href="#39792138">next</a><span>|</span><label class="collapse" for="c-39795774">[-]</label><label class="expand" for="c-39795774">[1 more]</label></div><br/><div class="children"><div class="content">I was thinking more of some light weight tools that convert between the two representations and which can be hooked into existing editors.</div><br/></div></div></div></div></div></div></div></div><div id="39792138" class="c"><input type="checkbox" id="c-39792138" checked=""/><div class="controls bullet"><span class="by">qwerty456127</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39789404">parent</a><span>|</span><a href="#39791634">prev</a><span>|</span><a href="#39792118">next</a><span>|</span><label class="collapse" for="c-39792138">[-]</label><label class="expand" for="c-39792138">[5 more]</label></div><br/><div class="children"><div class="content">I see. And this led me to a question: what can make a language expressed in S-expressions not a lisp?</div><br/><div id="39792179" class="c"><input type="checkbox" id="c-39792179" checked=""/><div class="controls bullet"><span class="by">wrs</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39792138">parent</a><span>|</span><a href="#39792118">next</a><span>|</span><label class="collapse" for="c-39792179">[-]</label><label class="expand" for="c-39792179">[4 more]</label></div><br/><div class="children"><div class="content">Any language can be expressed in S-expressions. A translation of the syntax tree to sexprs is often used in parser debugging. And Lisp doesn’t have to be expressed in S-expressions (see Dylan, or M-expressions, a syntax for Lisp that predates S-expressions).<p>Lisp traditionally has these features, but they’re separate features:<p>* There is a rich syntax for literal data structures<p>* Code is directly exposed as data structures so it can be manipulated with code (macros)<p>* Code is written as literal data structures so it has no separate syntax</div><br/><div id="39798531" class="c"><input type="checkbox" id="c-39798531" checked=""/><div class="controls bullet"><span class="by">lispm</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39792179">parent</a><span>|</span><a href="#39796913">next</a><span>|</span><label class="collapse" for="c-39798531">[-]</label><label class="expand" for="c-39798531">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Lisp traditionally has these features<p>Lisp has traditionally a two stage syntax<p>1) S-expressions<p>2) Lisp<p>S-Expression level has a syntax to describe data: lists, conses, numbers, symbols, strings, arrays, ...<p>Lisp syntax is defined on top of that, as s-expressions: variables, function calls, macro calls, special forms (using quote, let, if, progn, setq, catch, throw, labels, flet, declare, ...), lambda expressions. Each macro also can implement syntax.</div><br/></div></div><div id="39796913" class="c"><input type="checkbox" id="c-39796913" checked=""/><div class="controls bullet"><span class="by">qwerty456127</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39792179">parent</a><span>|</span><a href="#39798531">prev</a><span>|</span><a href="#39792118">next</a><span>|</span><label class="collapse" for="c-39796913">[-]</label><label class="expand" for="c-39796913">[2 more]</label></div><br/><div class="children"><div class="content">Thanks. Can you please elaborate some bits on what is meant under &quot;rich syntax for literal data structures&quot;? I&#x27;m not a lisp pro, just started studying it.</div><br/><div id="39798567" class="c"><input type="checkbox" id="c-39798567" checked=""/><div class="controls bullet"><span class="by">lispm</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39796913">parent</a><span>|</span><a href="#39792118">next</a><span>|</span><label class="collapse" for="c-39798567">[-]</label><label class="expand" for="c-39798567">[1 more]</label></div><br/><div class="children"><div class="content">That&#x27;s nothing special of Lisp. Literal data structures means that one can write down data objects like list, arrays, vectors, numbers (floats, integers, rational, complex, ...), symbols, strings, characters, records&#x2F;structures, ...<p>Common Lisp for example:<p><pre><code>    (berlin hamburg munich cologne)   ; a list of symbols
    #(berlin hamburg munich cologne)  ; a vector of symbols
    (1.3 1.3d6 13 #c(1 3) 1&#x2F;3)        ; a list of numbers
    &quot;Hello World!&quot;                    ; a string
    #\H                               ; the character H
    #S(CITY :NAME BERLIN              ; a structure (aka record) of type CITY
            :COUNTRY GERMANY)
    #*1010101111                      ; a bitvector
    #2A((BERLIN GERMANY)              ; a 2d array
        (PARIS FRANCE))
</code></pre>
Other programming languages have their own syntax for literal data (even data structures like unicode characters, hash tables, unicode strings, decimal numbers, ...)
Common Lisp OTOH has an extensible reader, one can add new syntax extensions for data structures, using so-called <i>reader macros</i>. READ is the function to read s-expressions from text streams. It returns data objects.</div><br/></div></div></div></div></div></div></div></div><div id="39792118" class="c"><input type="checkbox" id="c-39792118" checked=""/><div class="controls bullet"><span class="by">user2342</span><span>|</span><a href="#39789245">root</a><span>|</span><a href="#39789404">parent</a><span>|</span><a href="#39792138">prev</a><span>|</span><a href="#39789691">next</a><span>|</span><label class="collapse" for="c-39792118">[-]</label><label class="expand" for="c-39792118">[1 more]</label></div><br/><div class="children"><div class="content">Ah, now I see. Thx.</div><br/></div></div></div></div><div id="39789691" class="c"><input type="checkbox" id="c-39789691" checked=""/><div class="controls bullet"><span class="by">anacrolix</span><span>|</span><a href="#39789245">parent</a><span>|</span><a href="#39789404">prev</a><span>|</span><a href="#39792107">next</a><span>|</span><label class="collapse" for="c-39789691">[-]</label><label class="expand" for="c-39789691">[1 more]</label></div><br/><div class="children"><div class="content">My thoughts too. I was expecting something between Go and Rust in syntax, maybe more terse.</div><br/></div></div><div id="39792107" class="c"><input type="checkbox" id="c-39792107" checked=""/><div class="controls bullet"><span class="by">user2342</span><span>|</span><a href="#39789245">parent</a><span>|</span><a href="#39789691">prev</a><span>|</span><label class="collapse" for="c-39792107">[-]</label><label class="expand" for="c-39792107">[1 more]</label></div><br/><div class="children"><div class="content">That was also my first thought after looking at the examples.</div><br/></div></div></div></div></div></div></div></div></div></body></html>