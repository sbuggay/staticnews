<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1685091693682" as="style"/><link rel="stylesheet" href="styles.css?v=1685091693682"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://github.com/tidwall/jj">Jj: JSON Stream Editor</a> <span class="domain">(<a href="https://github.com">github.com</a>)</span></div><div class="subtext"><span>ingve</span> | <span>23 comments</span></div><br/><div><div id="36081721" class="c"><input type="checkbox" id="c-36081721" checked=""/><div class="controls bullet"><span class="by">j1elo</span><span>|</span><a href="#36081575">next</a><span>|</span><label class="collapse" for="c-36081721">[-]</label><label class="expand" for="c-36081721">[1 more]</label></div><br/><div class="children"><div class="content">I&#x27;ll take the chance to bring attention to the maintenance issues that &#x27;jq&#x27; has been having in the last years [1]; there hasn&#x27;t been a new release since 2018, which IMO wouldn&#x27;t necessarily be a bad thing if not for the fact that the main branch has been collecting improvements and bug fixes [2] since then.<p>A group of motivated users are currently talking about what direction to take; a fork is being considered in order to unlock new development and bug fixes [3]. Maybe someone reading this is able and willing to join their efforts.<p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;stedolan&#x2F;jq&#x2F;issues&#x2F;2305">https:&#x2F;&#x2F;github.com&#x2F;stedolan&#x2F;jq&#x2F;issues&#x2F;2305</a><p>[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;stedolan&#x2F;jq&#x2F;pull&#x2F;1697">https:&#x2F;&#x2F;github.com&#x2F;stedolan&#x2F;jq&#x2F;pull&#x2F;1697</a><p>[3]: <a href="https:&#x2F;&#x2F;github.com&#x2F;stedolan&#x2F;jq&#x2F;issues&#x2F;2550">https:&#x2F;&#x2F;github.com&#x2F;stedolan&#x2F;jq&#x2F;issues&#x2F;2550</a></div><br/></div></div><div id="36081575" class="c"><input type="checkbox" id="c-36081575" checked=""/><div class="controls bullet"><span class="by">maleldil</span><span>|</span><a href="#36081721">prev</a><span>|</span><a href="#36080970">next</a><span>|</span><label class="collapse" for="c-36081575">[-]</label><label class="expand" for="c-36081575">[1 more]</label></div><br/><div class="children"><div class="content">Am I correct in understanding that this can only manipulate (get or set values) from a JSON path? That is, is it not a replacement for jq?<p>For example, I frequently use jq for queries like this:<p><pre><code>    jq &#x27;.data | map(select(.age &lt;= 25))&#x27; input.json
</code></pre>
Or this:<p><pre><code>    jq &#x27;.data | map(.country) | sort[]&#x27; input.json | uniq -c
</code></pre>
Is it possible to do something similar with this tool?<p>This is not a slight at jj. Even if it&#x27;s more limited than jq, it&#x27;s still of great value if it means it&#x27;s faster or more ergonomic for a subset of cases. I&#x27;m just trying to understand how it fits in my toolbox.</div><br/></div></div><div id="36080970" class="c"><input type="checkbox" id="c-36080970" checked=""/><div class="controls bullet"><span class="by">qhwudbebd</span><span>|</span><a href="#36081575">prev</a><span>|</span><a href="#36079146">next</a><span>|</span><label class="collapse" for="c-36080970">[-]</label><label class="expand" for="c-36080970">[4 more]</label></div><br/><div class="children"><div class="content">Interesting! I tend to use gron to bring JSON into (and out of) the line-based bailiwick of sed and awk where I&#x27;m most comfortable, rather than a custom query language like jq that I&#x27;d use much more rarely. But I guess that&#x27;s at the opposite extreme of (in)efficiency than both this and the original jq.<p>There might be a nice &#x27;edit just this path in-place in gron-style&#x27; recipe to be had out of jj&#x2F;jq + gron together...</div><br/><div id="36081634" class="c"><input type="checkbox" id="c-36081634" checked=""/><div class="controls bullet"><span class="by">robertlagrant</span><span>|</span><a href="#36080970">parent</a><span>|</span><a href="#36081044">next</a><span>|</span><label class="collapse" for="c-36081634">[-]</label><label class="expand" for="c-36081634">[1 more]</label></div><br/><div class="children"><div class="content">Just looked up gron - thanks. This looks useful.</div><br/></div></div><div id="36081044" class="c"><input type="checkbox" id="c-36081044" checked=""/><div class="controls bullet"><span class="by">qhwudbebd</span><span>|</span><a href="#36080970">parent</a><span>|</span><a href="#36081634">prev</a><span>|</span><a href="#36079146">next</a><span>|</span><label class="collapse" for="c-36081044">[-]</label><label class="expand" for="c-36081044">[2 more]</label></div><br/><div class="children"><div class="content">Are there any gron-like tools for xml? I&#x27;m aware it&#x27;s a harder problem (and an increasingly rare problem) but perhaps someone has tackled it nonetheless?</div><br/><div id="36081450" class="c"><input type="checkbox" id="c-36081450" checked=""/><div class="controls bullet"><span class="by">bandie91</span><span>|</span><a href="#36080970">root</a><span>|</span><a href="#36081044">parent</a><span>|</span><a href="#36079146">next</a><span>|</span><label class="collapse" for="c-36081450">[-]</label><label class="expand" for="c-36081450">[1 more]</label></div><br/><div class="children"><div class="content">xml2[1] turns xml into line-based output. and 2xml reverses.<p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;clone&#x2F;xml2">https:&#x2F;&#x2F;github.com&#x2F;clone&#x2F;xml2</a></div><br/></div></div></div></div></div></div><div id="36079146" class="c"><input type="checkbox" id="c-36079146" checked=""/><div class="controls bullet"><span class="by">cristoperb</span><span>|</span><a href="#36080970">prev</a><span>|</span><a href="#36067969">next</a><span>|</span><label class="collapse" for="c-36079146">[-]</label><label class="expand" for="c-36079146">[6 more]</label></div><br/><div class="children"><div class="content">I like jq, but jj is so fast it is my go-to for pretty printing large json blobs. Its parsing engine is available as a standalone go module, and I&#x27;ve used it in a few projects where I needed faster parsing than encoding&#x2F;json:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;tidwall&#x2F;gjson">https:&#x2F;&#x2F;github.com&#x2F;tidwall&#x2F;gjson</a></div><br/><div id="36079421" class="c"><input type="checkbox" id="c-36079421" checked=""/><div class="controls bullet"><span class="by">pcthrowaway</span><span>|</span><a href="#36079146">parent</a><span>|</span><a href="#36067969">next</a><span>|</span><label class="collapse" for="c-36079421">[-]</label><label class="expand" for="c-36079421">[5 more]</label></div><br/><div class="children"><div class="content">I don&#x27;t think I&#x27;ve ever been limited by jq&#x27;s speed, but good to know there are alternatives if it ever becomes a bottleneck.<p>Other than that I can&#x27;t think of a reason to use this over jq; the query language is perhaps a bit more forgiving in some ways, but not as expressive as jq (and I&#x27;ve spent ~8 years getting pretty familiar with jq&#x27;s quirks)</div><br/><div id="36079687" class="c"><input type="checkbox" id="c-36079687" checked=""/><div class="controls bullet"><span class="by">lathiat</span><span>|</span><a href="#36079146">root</a><span>|</span><a href="#36079421">parent</a><span>|</span><a href="#36067969">next</a><span>|</span><label class="collapse" for="c-36079687">[-]</label><label class="expand" for="c-36079687">[4 more]</label></div><br/><div class="children"><div class="content">The limiting speed factor of jq for me is, by far, figuring out how to write the expression I need to parse a fairly small amount of data. I do a bunch of support analysis and often writing a one-liner to put into a shell script to extract some bit of JSON to re-use later in the script. Often this is going to be used only once by me or a customer to run some task.<p>Followed closely by figuring out the path to the area of data I&#x27;m interested in. &quot;gron&quot; has been a real time saver there - it converts the json into single lines of key&#x2F;value - so you can use grep and find the full path for any string.<p>Switching to a GUI to browse the JSON that would let you copy the path to the current value would probably also help there, but, I&#x27;m usually in the terminal doing a bunch of different tasks looking through all manor of command outputs, logs, etc :)<p>Relatedly my primary use of ChatGPT has been asking it to write jq queries for me, it&#x27;s not too bad at getting close. It&#x27;s biggest blindness seems to be string values with a dash, which you have to write as [&quot;key-name&quot;].</div><br/><div id="36081163" class="c"><input type="checkbox" id="c-36081163" checked=""/><div class="controls bullet"><span class="by">Simran-B</span><span>|</span><a href="#36079146">root</a><span>|</span><a href="#36079687">parent</a><span>|</span><a href="#36081530">next</a><span>|</span><label class="collapse" for="c-36081163">[-]</label><label class="expand" for="c-36081163">[1 more]</label></div><br/><div class="children"><div class="content">I agree that figuring out non-trivial jq expressions takes a lot of time, often accompanied with a consultation of the somewhat lacking docs, and some additional googling.<p>Nonetheless, it is pretty slow at processing data. For example, converting a 1 GB JSON array of objects to JSON Lines takes ages, if it works at all. Using the steaming features helps, but they are hard to comprehend. It gets memory consumption under control and doesn&#x27;t take super long, but still way too long for such a trivial task IMO.</div><br/></div></div><div id="36081530" class="c"><input type="checkbox" id="c-36081530" checked=""/><div class="controls bullet"><span class="by">pdimitar</span><span>|</span><a href="#36079146">root</a><span>|</span><a href="#36079687">parent</a><span>|</span><a href="#36081163">prev</a><span>|</span><a href="#36081571">next</a><span>|</span><label class="collapse" for="c-36081530">[-]</label><label class="expand" for="c-36081530">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Switching to a GUI to browse the JSON that would let you copy the path to the current value would probably also help there</i><p>Try <a href="https:&#x2F;&#x2F;jless.io&#x2F;" rel="nofollow">https:&#x2F;&#x2F;jless.io&#x2F;</a> then.</div><br/></div></div><div id="36081571" class="c"><input type="checkbox" id="c-36081571" checked=""/><div class="controls bullet"><span class="by">Dobbs</span><span>|</span><a href="#36079146">root</a><span>|</span><a href="#36079687">parent</a><span>|</span><a href="#36081530">prev</a><span>|</span><a href="#36067969">next</a><span>|</span><label class="collapse" for="c-36081571">[-]</label><label class="expand" for="c-36081571">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Switching to a GUI to browse the JSON that would let you copy the path to the current value would probably also help there<p>I use an app called OK JSON on the mac for this. Its okay.</div><br/></div></div></div></div></div></div></div></div><div id="36067969" class="c"><input type="checkbox" id="c-36067969" checked=""/><div class="controls bullet"><span class="by">BiteCode_dev</span><span>|</span><a href="#36079146">prev</a><span>|</span><a href="#36079612">next</a><span>|</span><label class="collapse" for="c-36067969">[-]</label><label class="expand" for="c-36067969">[3 more]</label></div><br/><div class="children"><div class="content">For those wondering, the README states it&#x27;s a lot faster than JQ, which may be the selling point.</div><br/><div id="36079839" class="c"><input type="checkbox" id="c-36079839" checked=""/><div class="controls bullet"><span class="by">nigeltao</span><span>|</span><a href="#36067969">parent</a><span>|</span><a href="#36079653">next</a><span>|</span><label class="collapse" for="c-36079839">[-]</label><label class="expand" for="c-36079839">[1 more]</label></div><br/><div class="children"><div class="content">jj is faster than jq.<p>However, jsonptr is even faster and also runs in a self-imposed SECCOMP_MODE_STRICT sandbox (very secure; also implies no dynamically allocated memory).<p><pre><code>  $ time cat citylots.json | jq -cM .features[10000].properties.LOT_NUM
  &quot;091&quot;
  real  0m4.844s
  
  $ time cat citylots.json | jj -r features.10000.properties.LOT_NUM
  &quot;091&quot;
  real  0m0.210s

  $ time cat citylots.json | jsonptr -q=&#x2F;features&#x2F;10000&#x2F;properties&#x2F;LOT_NUM
  &quot;091&quot;
  real  0m0.040s
</code></pre>
jsonptr&#x27;s query format is RFC 6901 (JSON Pointer). More details are at
<a href="https:&#x2F;&#x2F;nigeltao.github.io&#x2F;blog&#x2F;2020&#x2F;jsonptr.html" rel="nofollow">https:&#x2F;&#x2F;nigeltao.github.io&#x2F;blog&#x2F;2020&#x2F;jsonptr.html</a></div><br/></div></div><div id="36079653" class="c"><input type="checkbox" id="c-36079653" checked=""/><div class="controls bullet"><span class="by">rektide</span><span>|</span><a href="#36067969">parent</a><span>|</span><a href="#36079839">prev</a><span>|</span><a href="#36079612">next</a><span>|</span><label class="collapse" for="c-36079653">[-]</label><label class="expand" for="c-36079653">[1 more]</label></div><br/><div class="children"><div class="content">Presumably the memory footprint is often far less too.</div><br/></div></div></div></div><div id="36079612" class="c"><input type="checkbox" id="c-36079612" checked=""/><div class="controls bullet"><span class="by">asadm</span><span>|</span><a href="#36067969">prev</a><span>|</span><a href="#36080206">next</a><span>|</span><label class="collapse" for="c-36079612">[-]</label><label class="expand" for="c-36079612">[2 more]</label></div><br/><div class="children"><div class="content">I wish this existed when I was trying to look at 20G of firebase database JSON dump.</div><br/><div id="36080996" class="c"><input type="checkbox" id="c-36080996" checked=""/><div class="controls bullet"><span class="by">vmfunction</span><span>|</span><a href="#36079612">parent</a><span>|</span><a href="#36080206">next</a><span>|</span><label class="collapse" for="c-36080996">[-]</label><label class="expand" for="c-36080996">[1 more]</label></div><br/><div class="children"><div class="content">that is what gets me, why did the file get to 20g? At that point just ship a SQLite file.</div><br/></div></div></div></div><div id="36080206" class="c"><input type="checkbox" id="c-36080206" checked=""/><div class="controls bullet"><span class="by">Self-Perfection</span><span>|</span><a href="#36079612">prev</a><span>|</span><a href="#36081284">next</a><span>|</span><label class="collapse" for="c-36080206">[-]</label><label class="expand" for="c-36080206">[3 more]</label></div><br/><div class="children"><div class="content">I would like to see a comparison with jshon. Jshon is way faster than jq and for many years available in your distro repositories.</div><br/><div id="36081056" class="c"><input type="checkbox" id="c-36081056" checked=""/><div class="controls bullet"><span class="by">Alifatisk</span><span>|</span><a href="#36080206">parent</a><span>|</span><a href="#36081284">next</a><span>|</span><label class="collapse" for="c-36081056">[-]</label><label class="expand" for="c-36081056">[2 more]</label></div><br/><div class="children"><div class="content">Cool, didn’t know about jshon, how’s the query language?</div><br/><div id="36081398" class="c"><input type="checkbox" id="c-36081398" checked=""/><div class="controls bullet"><span class="by">Self-Perfection</span><span>|</span><a href="#36080206">root</a><span>|</span><a href="#36081056">parent</a><span>|</span><a href="#36081284">next</a><span>|</span><label class="collapse" for="c-36081398">[-]</label><label class="expand" for="c-36081398">[1 more]</label></div><br/><div class="children"><div class="content">Almost non-existing. A couple of excerpts from man page:<p><pre><code>  {&quot;a&quot;:1,&quot;b&quot;:[true,false,null,&quot;str&quot;],&quot;c&quot;:{&quot;d&quot;:4,&quot;e&quot;:5}}
  jshon [actions] &lt; sample.json
  jshon -e c -&gt; {&quot;d&quot;:4,&quot;e&quot;:5}
  jshon -e c -e d -u -p -e e -u -&gt; 4 5
</code></pre>
Yet this covers like ~50% of possible use cases for jq.</div><br/></div></div></div></div></div></div><div id="36081284" class="c"><input type="checkbox" id="c-36081284" checked=""/><div class="controls bullet"><span class="by">listenallyall</span><span>|</span><a href="#36080206">prev</a><span>|</span><a href="#36081407">next</a><span>|</span><label class="collapse" for="c-36081284">[-]</label><label class="expand" for="c-36081284">[1 more]</label></div><br/><div class="children"><div class="content">Is this the SAX of JSON?</div><br/></div></div></div></div></div></div></div></body></html>