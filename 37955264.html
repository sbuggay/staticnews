<!DOCTYPE html><html lang="en"><head><title>Static News</title><meta charSet="utf-8"/><meta name="description" content="Static delayed Hacker News."/><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1d1f21"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="application-name" content="Static News"/><meta name="apple-mobile-web-app-title" content="Static News"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#1d1f21"/><link rel="preload" href="styles.css?v=1697878857372" as="style"/><link rel="stylesheet" href="styles.css?v=1697878857372"/></head><body><div id="container"><div id="inner"><header><a href="/">Static News</a><a href="/about">about</a></header><div id="content"><div><div id="title"><a href="https://notes.valdikss.org.ru/jabber.ru-mitm/">Encrypted traffic interception on Hetzner and Linode targeting Jabber service</a> <span class="domain">(<a href="https://notes.valdikss.org.ru">notes.valdikss.org.ru</a>)</span></div><div class="subtext"><span>f311a</span> | <span>237 comments</span></div><br/><div><div id="37958299" class="c"><input type="checkbox" id="c-37958299" checked=""/><div class="controls bullet"><span class="by">rodlette</span><span>|</span><a href="#37958892">next</a><span>|</span><label class="collapse" for="c-37958299">[-]</label><label class="expand" for="c-37958299">[33 more]</label></div><br/><div class="children"><div class="content">I agree with most of the mitigation suggestions.<p>For high risk targets, consider layering an additional auth mechanism that doesn&#x27;t rely on trusted CAs: Tor onion services, SSH, or Wireguard.<p>&gt; All issued SSL&#x2F;TLS certificates are subject to certificate transparency.<p>+1. crt.sh has RSS feeds for this.<p>&gt; Limit validation methods and set exact account identifiers<p>Using CAA is a good idea in general, but would it help in this case? The attacker would just request the exact cert configuration that is permitted by CAA. Maybe this helps if you can strengthen one validation method?<p>&gt; Monitor SSL&#x2F;TLS certificate changes on all your services using external service<p>+1. High-risk targets should be aware of what certs are valid at any time, and be checking for those.<p>&gt; Monitor MAC address of default gateway for changes<p>A more sophisticated attack could preserve the MAC address.<p>&gt; &quot;Channel binding&quot; is a feature in XMPP which can detect a MiTM even if the interceptor present a valid certificate.<p>TIL.</div><br/><div id="37958831" class="c"><input type="checkbox" id="c-37958831" checked=""/><div class="controls bullet"><span class="by">hlandau</span><span>|</span><a href="#37958299">parent</a><span>|</span><a href="#37960004">next</a><span>|</span><label class="collapse" for="c-37958831">[-]</label><label class="expand" for="c-37958831">[18 more]</label></div><br/><div class="children"><div class="content">&gt;Using CAA is a good idea in general, but would it help in this case? The attacker would just request the exact cert configuration that is permitted by CAA. Maybe this helps if you can strengthen one validation method?<p>Author of ACME-CAA (RFC 8657) here. ACME-CAA can mitigate this because you can put a unique identifier for your ACME account in the CAA record, so it is not possible for an attacker to do this unless they can get your ACME account private key (or coerce the ACME service). This assumes you have DNSSEC-secured nameservers, of course, otherwise DNS requests can potentially also be intercepted when queried by the CA.<p>See RFC 8657 for a full list of security caveats. The RFC is designed to be more readable than most.<p>Blogpost by me with more background: <a href="https:&#x2F;&#x2F;www.devever.net&#x2F;~hl&#x2F;acme-caa-live" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.devever.net&#x2F;~hl&#x2F;acme-caa-live</a></div><br/><div id="37961184" class="c"><input type="checkbox" id="c-37961184" checked=""/><div class="controls bullet"><span class="by">hlandau</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37958831">parent</a><span>|</span><a href="#37962243">next</a><span>|</span><label class="collapse" for="c-37961184">[-]</label><label class="expand" for="c-37961184">[4 more]</label></div><br/><div class="children"><div class="content">Small update: I&#x27;ve just written a blogpost with my thoughts on the incident. <a href="https:&#x2F;&#x2F;www.devever.net&#x2F;~hl&#x2F;xmpp-incident" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.devever.net&#x2F;~hl&#x2F;xmpp-incident</a><p>I usually brood on blogposts for days before publishing them since I care a lot about getting things accurate, but this is a bit of the moment, so here goes. Always happy to get feedback by email or IRC: <a href="https:&#x2F;&#x2F;www.devever.net&#x2F;~hl&#x2F;contact" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.devever.net&#x2F;~hl&#x2F;contact</a></div><br/><div id="37962010" class="c"><input type="checkbox" id="c-37962010" checked=""/><div class="controls bullet"><span class="by">ThePowerOfFuet</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37961184">parent</a><span>|</span><a href="#37962243">next</a><span>|</span><label class="collapse" for="c-37962010">[-]</label><label class="expand" for="c-37962010">[3 more]</label></div><br/><div class="children"><div class="content">Is it just me, or would a recurring RIPE Atlas measurement be a great way to detect fuckery like this?<p><a href="https:&#x2F;&#x2F;atlas.ripe.net&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;atlas.ripe.net&#x2F;</a></div><br/><div id="37962651" class="c"><input type="checkbox" id="c-37962651" checked=""/><div class="controls bullet"><span class="by">bananapub</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962010">parent</a><span>|</span><a href="#37962243">next</a><span>|</span><label class="collapse" for="c-37962651">[-]</label><label class="expand" for="c-37962651">[2 more]</label></div><br/><div class="children"><div class="content">not at all, since there were no Internet-visible routing changes.<p>atlas would be good for detecting the time Pakistan announced 0&#x2F;0 or whatever.</div><br/><div id="37963970" class="c"><input type="checkbox" id="c-37963970" checked=""/><div class="controls bullet"><span class="by">karmahunter1234</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962651">parent</a><span>|</span><a href="#37962243">next</a><span>|</span><label class="collapse" for="c-37963970">[-]</label><label class="expand" for="c-37963970">[1 more]</label></div><br/><div class="children"><div class="content">I think atlas allows tls&#x2F;ssl probes, so that could still be used to track unexpected changes in certificates?</div><br/></div></div></div></div></div></div></div></div><div id="37962243" class="c"><input type="checkbox" id="c-37962243" checked=""/><div class="controls bullet"><span class="by">3np</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37958831">parent</a><span>|</span><a href="#37961184">prev</a><span>|</span><a href="#37962527">next</a><span>|</span><label class="collapse" for="c-37962243">[-]</label><label class="expand" for="c-37962243">[2 more]</label></div><br/><div class="children"><div class="content">Wuuut, I missed they finally enabled it. Everyone who has infra MitM in their threat-model should look into and enable this.<p>Also, thank you for your work as well as popping in here.<p>Am I overstating it by seeing it as one of the most important milestones for Internet security in general over the past few years?<p>Do you have a take on DLT-based systems and if this is something that is (or could be) seriously discussed? It seems to me that the issues we have with PKI and certificate transparency could actually be mitigated very well if blockchain was seriously considered.</div><br/><div id="37962595" class="c"><input type="checkbox" id="c-37962595" checked=""/><div class="controls bullet"><span class="by">hlandau</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962243">parent</a><span>|</span><a href="#37962527">next</a><span>|</span><label class="collapse" for="c-37962595">[-]</label><label class="expand" for="c-37962595">[1 more]</label></div><br/><div class="children"><div class="content">So I assume DLT is a generic&#x2F;more general term for blockchain technology.<p>There&#x27;s this thing called Zooko&#x27;s triangle (<a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Zooko%27s_triangle" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Zooko%27s_triangle</a>), basically the premise that an identifier can only have two of the following properties: secure, decentralized, human-readable.<p>But a blockchain can actually be used to square this triangle and get all three. The original example of this is the Namecoin project, a fork of Bitcoin using a lightly modified Bitcoin codebase which can be used as a key-value store.<p>The idea is that a blockchain can be used to create a decentralized database mapping keys (domain names) to values (which can be things like IP addresses, but also PKI trust anchors, similar to DANE). Thus this can eliminate the need for a CA. You can also use it to map human-readable names to .onion addresses. There is also root-of-trust transparency built in since the contents of the database is public and any changes are also public. The right to change a key-value entry belongs to the public key of the person who registered that key. Nobody can override this. Namecoin domain names use the .bit (unofficial) TLD.<p>It&#x27;s a really neat technology and also makes things like censorship via domain suspensions, your registrar getting hacked, etc. infeasible.<p>Full disclosure, I previously worked on the Namecoin project, I authored the DNS resolution daemon and the technical specification for the format of DNS data in the KV store. Unfortunately public interest in the project has waned, and deployment is the real issue - you have to have the client software to be able to resolve these domain names. There is at least some conceivable possibility Tor might ship it in their bundle in the future though, so people could type example.bit in Tor Browser to get to a hidden service. The project remains active though.</div><br/></div></div></div></div><div id="37962527" class="c"><input type="checkbox" id="c-37962527" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37958831">parent</a><span>|</span><a href="#37962243">prev</a><span>|</span><a href="#37959798">next</a><span>|</span><label class="collapse" for="c-37962527">[-]</label><label class="expand" for="c-37962527">[3 more]</label></div><br/><div class="children"><div class="content">Interesting and I can see some of the benefits, particularly in preventing DNS controllers from going to other CAs and making new keys, but... this all seems like a weird run-around for the MITM part.<p>Couldn&#x27;t you exchange public keys with LetsEncrypt (in the web UI) and encrypt the response so you can&#x27;t be MITMed?  Why is http even an issue?</div><br/><div id="37963505" class="c"><input type="checkbox" id="c-37963505" checked=""/><div class="controls bullet"><span class="by">KairuByte</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962527">parent</a><span>|</span><a href="#37959798">next</a><span>|</span><label class="collapse" for="c-37963505">[-]</label><label class="expand" for="c-37963505">[2 more]</label></div><br/><div class="children"><div class="content">Because the attacker can simply request new keys. There’s nothing stopping them from going “hey LE, I need a new key! This is my domain, here is the challenge, give me my cert!” And LE will oblige, because as far as it can tell, they are you.<p>Edit: To be clear, this is a problem with a solution. But you asked why simply throwing a LE cert into the mix wouldn’t prevent the issue.</div><br/><div id="37963552" class="c"><input type="checkbox" id="c-37963552" checked=""/><div class="controls bullet"><span class="by">Groxx</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37963505">parent</a><span>|</span><a href="#37959798">next</a><span>|</span><label class="collapse" for="c-37963552">[-]</label><label class="expand" for="c-37963552">[1 more]</label></div><br/><div class="children"><div class="content">Ownership is already handled by checking DNS (and this thread covers a way to make that even more secure, which LE supports), and as far as I can tell neither has nothing to do with preventing MITM between LE and your servers.<p>And no, I don&#x27;t mean throwing LE certs around to prevent MITM - this whole article is about the difficulties <i>before</i> having an LE cert, so that&#x27;s necessarily excluded.<p>I&#x27;m wondering &quot;why not client certificates&quot;.  They&#x27;re a well established way to stop MITM, seems like a simple choice for the ownership validation step.</div><br/></div></div></div></div></div></div><div id="37959798" class="c"><input type="checkbox" id="c-37959798" checked=""/><div class="controls bullet"><span class="by">crosser</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37958831">parent</a><span>|</span><a href="#37962527">prev</a><span>|</span><a href="#37959676">next</a><span>|</span><label class="collapse" for="c-37959798">[-]</label><label class="expand" for="c-37959798">[7 more]</label></div><br/><div class="children"><div class="content">Could you please elaborate the reasons to implement this outside of DANE (RFC-7671) framework?</div><br/><div id="37960086" class="c"><input type="checkbox" id="c-37960086" checked=""/><div class="controls bullet"><span class="by">fanf2</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37959798">parent</a><span>|</span><a href="#37960043">next</a><span>|</span><label class="collapse" for="c-37960086">[-]</label><label class="expand" for="c-37960086">[5 more]</label></div><br/><div class="children"><div class="content">CAA is about preventing certificate mis-issuance, which is what happened in this attack. DNSSEC and CAA could have prevented this attack from being performed the way it was, by thwarting the MITM on ACME.<p>DANE is about changing the way certificates are authenticated. DANE makes it possible to authenticate certificates without getting them issued by a well-known CA. So CAA records are not particularly relevant to DANE. You <i>can</i> use DANE with certificates issued by a CA, which gives you two ways to authenticate the certificate; in this situation CAA secures one path and DANE the other.<p>I am one of the co-authors of the DANE SRV RFC <a href="https:&#x2F;&#x2F;www.rfc-editor.org&#x2F;rfc&#x2F;rfc7673" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.rfc-editor.org&#x2F;rfc&#x2F;rfc7673</a> which is what XMPP would use. I don’t follow XMPP development so I don’t know if it has been deployed. I would like it if DANE were more widely used, but it’s not pertinent to this attack.</div><br/><div id="37960961" class="c"><input type="checkbox" id="c-37960961" checked=""/><div class="controls bullet"><span class="by">hlandau</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960086">parent</a><span>|</span><a href="#37965184">next</a><span>|</span><label class="collapse" for="c-37960961">[-]</label><label class="expand" for="c-37960961">[2 more]</label></div><br/><div class="children"><div class="content">Yeah. I used to be 100% in on DANE and against CAs. I&#x27;m still 100% for DANE but I now think DANE using existing CAs is the better option in many cases because it means things get CT logged. We don&#x27;t have a DNSSEC transparency situation right now. OTOH there is one undersung issue with CAs, which is that Let&#x27;s Encrypt isn&#x27;t as universally available as people think (see the US embargo list) and that does potentially make access to the internet harder for some.<p>There are some use cases where DANE is actually winning real victories and is actually more viable than the existing CA infrastructure - site-to-site SMTP, for example.</div><br/><div id="37961434" class="c"><input type="checkbox" id="c-37961434" checked=""/><div class="controls bullet"><span class="by">fanf2</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960961">parent</a><span>|</span><a href="#37965184">next</a><span>|</span><label class="collapse" for="c-37961434">[-]</label><label class="expand" for="c-37961434">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, Viktor Dukhovni has been impressively energetic and persistent at improving the security of email.</div><br/></div></div></div></div><div id="37965184" class="c"><input type="checkbox" id="c-37965184" checked=""/><div class="controls bullet"><span class="by">KirillPanov</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960086">parent</a><span>|</span><a href="#37960961">prev</a><span>|</span><a href="#37960706">next</a><span>|</span><label class="collapse" for="c-37965184">[-]</label><label class="expand" for="c-37965184">[1 more]</label></div><br/><div class="children"><div class="content">I feel like packet size was and continues to be a major obstacle for DNSSEC. 
 Do you know why the DNSSEC&#x2F;DANE world hasn&#x27;t simply acknowledged this and switched to requiring ECC?<p>It is trivial to fit several compressed curve points (i.e. signatures) in a single packet, whereas  you can&#x27;t even fit two RSA signatures in a minimum-safe-to-assume DNS UDP reply packet after accounting for padding and ASN.1 overhead.<p>I get the feeling that there is some faction that really hates UDP and they sort of hijacked the DNSSEC situation to use as a lever to force people to allow DNS-over-TCP.<p>That seems to be backfiring, however, and DNSSEC has wound up taking a bullet for the UDP-haters.<p>Many very-large networks simply can&#x27;t afford for their DNS traffic to be exposed to TCP&#x27;s intrusion-detection malleability and slowloris (resource exhaustion) attacks.  These networks appear to be simply ignoring the &quot;thou must TCP thine DNS&quot; edict.  DNSSEC is not a good enough carrot for them.  I think ditching RSA would have been a more pragmatic choice than ditching UDP or skipping DNSSEC.</div><br/></div></div><div id="37960706" class="c"><input type="checkbox" id="c-37960706" checked=""/><div class="controls bullet"><span class="by">crosser</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960086">parent</a><span>|</span><a href="#37965184">prev</a><span>|</span><a href="#37960043">next</a><span>|</span><label class="collapse" for="c-37960706">[-]</label><label class="expand" for="c-37960706">[1 more]</label></div><br/><div class="children"><div class="content">Why not? You could use &quot;certificate usage&quot; value 1 and (if the implementation does not neglect it) immediately notice that validation by CA disagrees with validation by DNS. That should be good enough, no?</div><br/></div></div></div></div><div id="37960043" class="c"><input type="checkbox" id="c-37960043" checked=""/><div class="controls bullet"><span class="by">tialaramex</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37959798">parent</a><span>|</span><a href="#37960086">prev</a><span>|</span><a href="#37959676">next</a><span>|</span><label class="collapse" for="c-37960043">[-]</label><label class="expand" for="c-37960043">[1 more]</label></div><br/><div class="children"><div class="content">DANE assumes we can successfully deploy this to the entire Internet. It is unclear that&#x27;s ever possible, and it&#x27;s certainly not possible today. Lots of things would be great if you can deploy them, for example you wouldn&#x27;t build QUIC on top of UDP since you can &quot;just&quot; deploy a new transport protocol - except nope, for the foreseeable future that&#x27;s undeployable.<p>A public CA generally has a more sophisticated relationship with their network transit provider or (hopefully) providers and can get DNSSEC actually working as intended for them.<p>So this means mything.example&#x27;s DNS services and some public CA both need working DNSSEC, but the visitors to mything.example, such as your mom&#x27;s sister or some guy who just go into mything but isn&#x27;t entirely clear whether Apple make Windows - do not need DNSSEc, for them everything works exactly as before, yet the certificate acquisition step is protected from third parties.<p>Would that help? It depends.</div><br/></div></div></div></div><div id="37959676" class="c"><input type="checkbox" id="c-37959676" checked=""/><div class="controls bullet"><span class="by">aaomidi</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37958831">parent</a><span>|</span><a href="#37959798">prev</a><span>|</span><a href="#37960004">next</a><span>|</span><label class="collapse" for="c-37959676">[-]</label><label class="expand" for="c-37959676">[1 more]</label></div><br/><div class="children"><div class="content">Yep! This is one way of preventing this type of attack.</div><br/></div></div></div></div><div id="37960004" class="c"><input type="checkbox" id="c-37960004" checked=""/><div class="controls bullet"><span class="by">0xbadcafebee</span><span>|</span><a href="#37958299">parent</a><span>|</span><a href="#37958831">prev</a><span>|</span><a href="#37962446">next</a><span>|</span><label class="collapse" for="c-37960004">[-]</label><label class="expand" for="c-37960004">[8 more]</label></div><br/><div class="children"><div class="content">&gt; All issued SSL&#x2F;TLS certificates are subject to certificate transparency.<p>Until the nation state tells a CA within their borders to issue a cert without publishing the CT logs, along with a gag order. If they don&#x27;t comply they go to jail. You think Billy Bob Sysadmin wants to go to jail to protect a russian jabber server?</div><br/><div id="37961511" class="c"><input type="checkbox" id="c-37961511" checked=""/><div class="controls bullet"><span class="by">tgsovlerkhgsel</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960004">parent</a><span>|</span><a href="#37962043">next</a><span>|</span><label class="collapse" for="c-37961511">[-]</label><label class="expand" for="c-37961511">[1 more]</label></div><br/><div class="children"><div class="content">The malicious certificate either won&#x27;t have a SCT (which in itself would be highly suspicious <i>and</i> cause some clients to reject the certificate directly), or it will have one but it won&#x27;t be recorded in the log.<p>In the latter case, the malicious certificate + any CT log issued after that certificate should have been included are evidence of the attack that is easily verifiable and would likely cause browsers to drop the (edit) CT log unless provided with a very plausible excuse that isn&#x27;t &quot;we complied with a court&#x2F;gag order&quot;.<p>Also, this would require the police etc. to compel 2-3 different entities: The CA and two log operators (I think one of them could be the CA itself).<p>Using different logs than normal would stand out, so it&#x27;d typically be two <i>specific</i> log operators that would have to be compelled to hide this. The US may get lucky and have jurisdiction over all of them, other countries are much less likely to.</div><br/></div></div><div id="37962043" class="c"><input type="checkbox" id="c-37962043" checked=""/><div class="controls bullet"><span class="by">morpheuskafka</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960004">parent</a><span>|</span><a href="#37961511">prev</a><span>|</span><a href="#37960616">next</a><span>|</span><label class="collapse" for="c-37962043">[-]</label><label class="expand" for="c-37962043">[1 more]</label></div><br/><div class="children"><div class="content">If the certificate isn&#x27;t logged in CT, it&#x27;s not supposed to be trusted. That&#x27;s the whole point. If it is logged, then the site owners would notice (Cloudflare, for example, has a service that emails when certificates are issued for your domains).</div><br/></div></div><div id="37960616" class="c"><input type="checkbox" id="c-37960616" checked=""/><div class="controls bullet"><span class="by">bart__</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960004">parent</a><span>|</span><a href="#37962043">prev</a><span>|</span><a href="#37962446">next</a><span>|</span><label class="collapse" for="c-37960616">[-]</label><label class="expand" for="c-37960616">[5 more]</label></div><br/><div class="children"><div class="content">Browsers will check if a certificate is in the transparency log, and alert the user if it isn&#x27;t if I am not mistaken.</div><br/><div id="37961491" class="c"><input type="checkbox" id="c-37961491" checked=""/><div class="controls bullet"><span class="by">crtasm</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960616">parent</a><span>|</span><a href="#37964009">next</a><span>|</span><label class="collapse" for="c-37961491">[-]</label><label class="expand" for="c-37961491">[2 more]</label></div><br/><div class="children"><div class="content">But XMPP clients do not, as far as I&#x27;m aware? and browsers aren&#x27;t connecting to XMPP server ports.</div><br/><div id="37961852" class="c"><input type="checkbox" id="c-37961852" checked=""/><div class="controls bullet"><span class="by">est31</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37961491">parent</a><span>|</span><a href="#37964009">next</a><span>|</span><label class="collapse" for="c-37961852">[-]</label><label class="expand" for="c-37961852">[1 more]</label></div><br/><div class="children"><div class="content">Yeah usually the TLS libraries used by XMPP clients don&#x27;t check SCTs. Not even all browsers do it. Chrome does it, Firefox does not for example.</div><br/></div></div></div></div><div id="37964009" class="c"><input type="checkbox" id="c-37964009" checked=""/><div class="controls bullet"><span class="by">privacyking</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37960616">parent</a><span>|</span><a href="#37961491">prev</a><span>|</span><a href="#37960914">next</a><span>|</span><label class="collapse" for="c-37964009">[-]</label><label class="expand" for="c-37964009">[1 more]</label></div><br/><div class="children"><div class="content">Source?</div><br/></div></div></div></div></div></div><div id="37962446" class="c"><input type="checkbox" id="c-37962446" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958299">parent</a><span>|</span><a href="#37960004">prev</a><span>|</span><a href="#37962031">next</a><span>|</span><label class="collapse" for="c-37962446">[-]</label><label class="expand" for="c-37962446">[5 more]</label></div><br/><div class="children"><div class="content">The main problem is that Let&#x27;s Encrypt issued fake certificates without strict checking. This means any country  can start using this method to generate valid certificates for any site within the country. And if the country can pull BGP attack with traffic redirection then for any website.<p>Let&#x27;s Encrypt security is a joke.<p>UPD: It looks like many other CAs also can be tricked to issue valid certificates to any attacker capable of doing MitM, so in general SSL infrastructure security is a joke which is proven by this incident.</div><br/><div id="37962704" class="c"><input type="checkbox" id="c-37962704" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962446">parent</a><span>|</span><a href="#37962031">next</a><span>|</span><label class="collapse" for="c-37962704">[-]</label><label class="expand" for="c-37962704">[4 more]</label></div><br/><div class="children"><div class="content">How would you implement “strict checking” at scale and for free?</div><br/><div id="37962794" class="c"><input type="checkbox" id="c-37962794" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962704">parent</a><span>|</span><a href="#37962031">next</a><span>|</span><label class="collapse" for="c-37962794">[-]</label><label class="expand" for="c-37962794">[3 more]</label></div><br/><div class="children"><div class="content">If they used DNS validation it would be better because there would be only one point of failure (DNS) rather than many (DNS and every ISP between CA and a site).</div><br/><div id="37963202" class="c"><input type="checkbox" id="c-37963202" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962794">parent</a><span>|</span><a href="#37963293">next</a><span>|</span><label class="collapse" for="c-37963202">[-]</label><label class="expand" for="c-37963202">[1 more]</label></div><br/><div class="children"><div class="content">The thread above (<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37958831">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37958831</a>) elaborates on how to force DNS validation and&#x2F;or how to tie your private key with Let&#x27;s Encrypt via DNS.</div><br/></div></div><div id="37963293" class="c"><input type="checkbox" id="c-37963293" checked=""/><div class="controls bullet"><span class="by">lxgr</span><span>|</span><a href="#37958299">root</a><span>|</span><a href="#37962794">parent</a><span>|</span><a href="#37963202">prev</a><span>|</span><a href="#37962031">next</a><span>|</span><label class="collapse" for="c-37963293">[-]</label><label class="expand" for="c-37963293">[1 more]</label></div><br/><div class="children"><div class="content">And DNS does not traverse several ISPs?</div><br/></div></div></div></div></div></div></div></div><div id="37962031" class="c"><input type="checkbox" id="c-37962031" checked=""/><div class="controls bullet"><span class="by">abigail95</span><span>|</span><a href="#37958299">parent</a><span>|</span><a href="#37962446">prev</a><span>|</span><a href="#37958892">next</a><span>|</span><label class="collapse" for="c-37962031">[-]</label><label class="expand" for="c-37962031">[1 more]</label></div><br/><div class="children"><div class="content">If they have physical access to your server, they&#x27;ll just go for that.<p>With mild difficulty you can mirror the disk, net, and RAM of any &quot;commodity&quot; hardware.</div><br/></div></div></div></div><div id="37958892" class="c"><input type="checkbox" id="c-37958892" checked=""/><div class="controls bullet"><span class="by">lima</span><span>|</span><a href="#37958299">prev</a><span>|</span><a href="#37958508">next</a><span>|</span><label class="collapse" for="c-37958892">[-]</label><label class="expand" for="c-37958892">[9 more]</label></div><br/><div class="children"><div class="content">Perfectly pulling off an actual MitM attack and then forgetting to renew the certificate is certainly a very German thing :-)</div><br/><div id="37959667" class="c"><input type="checkbox" id="c-37959667" checked=""/><div class="controls bullet"><span class="by">jakub_g</span><span>|</span><a href="#37958892">parent</a><span>|</span><a href="#37962278">next</a><span>|</span><label class="collapse" for="c-37959667">[-]</label><label class="expand" for="c-37959667">[7 more]</label></div><br/><div class="children"><div class="content">I wonder if someone didn&#x27;t &quot;forget&quot; on purpose, so that people learn about it.<p>Or, someone <i>very diligently followed</i> the orders - there was an order to set up a cert, but there was no requirement that it has to auto-renew :)</div><br/><div id="37959854" class="c"><input type="checkbox" id="c-37959854" checked=""/><div class="controls bullet"><span class="by">luma</span><span>|</span><a href="#37958892">root</a><span>|</span><a href="#37959667">parent</a><span>|</span><a href="#37962278">next</a><span>|</span><label class="collapse" for="c-37959854">[-]</label><label class="expand" for="c-37959854">[6 more]</label></div><br/><div class="children"><div class="content">It was claimed to have been running for 6 months so it must have renewed certs at least once - LE certs are good for 90 days.</div><br/><div id="37960917" class="c"><input type="checkbox" id="c-37960917" checked=""/><div class="controls bullet"><span class="by">a1369209993</span><span>|</span><a href="#37958892">root</a><span>|</span><a href="#37959854">parent</a><span>|</span><a href="#37962278">next</a><span>|</span><label class="collapse" for="c-37960917">[-]</label><label class="expand" for="c-37960917">[5 more]</label></div><br/><div class="children"><div class="content">&gt; 6 months [...] 90 days.<p>So they were told to renew the certificate, but not how many <i>times</i> to renew it?</div><br/><div id="37961406" class="c"><input type="checkbox" id="c-37961406" checked=""/><div class="controls bullet"><span class="by">JPHPJ</span><span>|</span><a href="#37958892">root</a><span>|</span><a href="#37960917">parent</a><span>|</span><a href="#37962278">next</a><span>|</span><label class="collapse" for="c-37961406">[-]</label><label class="expand" for="c-37961406">[4 more]</label></div><br/><div class="children"><div class="content">Shouldn&#x27;t the certificate transparency logs have it?</div><br/><div id="37961612" class="c"><input type="checkbox" id="c-37961612" checked=""/><div class="controls bullet"><span class="by">tgsovlerkhgsel</span><span>|</span><a href="#37958892">root</a><span>|</span><a href="#37961406">parent</a><span>|</span><a href="#37961744">next</a><span>|</span><label class="collapse" for="c-37961612">[-]</label><label class="expand" for="c-37961612">[2 more]</label></div><br/><div class="children"><div class="content">I suspect it&#x27;s not trivial to distinguish between the legit and fake ones just based on CT logs. Unless Let&#x27;s Encrypt <i>publicly</i> logs the account used to issue the certificate (I think they don&#x27;t), only the logs held at Let&#x27;s Encrypt will reveal this information. I expect their security team to be looking at those logs right now.</div><br/><div id="37962825" class="c"><input type="checkbox" id="c-37962825" checked=""/><div class="controls bullet"><span class="by">pgporada</span><span>|</span><a href="#37958892">root</a><span>|</span><a href="#37961612">parent</a><span>|</span><a href="#37961744">next</a><span>|</span><label class="collapse" for="c-37962825">[-]</label><label class="expand" for="c-37962825">[1 more]</label></div><br/><div class="children"><div class="content">Why? Purely out of curios ity? Domain validation was successfully performed which enabled a certificate(s) to be issued.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="37962278" class="c"><input type="checkbox" id="c-37962278" checked=""/><div class="controls bullet"><span class="by">jlg23</span><span>|</span><a href="#37958892">parent</a><span>|</span><a href="#37959667">prev</a><span>|</span><a href="#37958508">next</a><span>|</span><label class="collapse" for="c-37962278">[-]</label><label class="expand" for="c-37962278">[1 more]</label></div><br/><div class="children"><div class="content">No, the German thing would have been to have the printout of the telefaxed scan of the court order collecting dust because the scanner in the receiving department is broken...</div><br/></div></div></div></div><div id="37958508" class="c"><input type="checkbox" id="c-37958508" checked=""/><div class="controls bullet"><span class="by">costco</span><span>|</span><a href="#37958892">prev</a><span>|</span><a href="#37964968">next</a><span>|</span><label class="collapse" for="c-37958508">[-]</label><label class="expand" for="c-37958508">[32 more]</label></div><br/><div class="children"><div class="content">This is almost certainly related to some sort of Russian cybercrime investigation.  If you ever read Krebs or peruse some of the seedier Russian forums, xmpp.ru will sound familiar to you, because it is.  Not imputing anything to the operator, that&#x27;s just the nature of operating an anonymous service.<p><a href="https:&#x2F;&#x2F;ddanchev.blogspot.com&#x2F;2021&#x2F;03&#x2F;exposing-currently-active-portfolio-of_82.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;ddanchev.blogspot.com&#x2F;2021&#x2F;03&#x2F;exposing-currently-act...</a><p><a href="https:&#x2F;&#x2F;ddanchev.blogspot.com&#x2F;2019&#x2F;07&#x2F;profiling-currently-active-portfolio-of.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;ddanchev.blogspot.com&#x2F;2019&#x2F;07&#x2F;profiling-currently-ac...</a><p><a href="https:&#x2F;&#x2F;blog.talosintelligence.com&#x2F;picking-apart-remcos&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;blog.talosintelligence.com&#x2F;picking-apart-remcos&#x2F;</a><p><a href="https:&#x2F;&#x2F;flashpoint.io&#x2F;wp-content&#x2F;uploads&#x2F;Plea-Agreement-USA-v.-Vitalii-Chychasov.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;flashpoint.io&#x2F;wp-content&#x2F;uploads&#x2F;Plea-Agreement-USA-...</a><p>Really interesting writeup though.  I guess it&#x27;s a practical example of why everyone should get a CT monitoring service!</div><br/><div id="37960119" class="c"><input type="checkbox" id="c-37960119" checked=""/><div class="controls bullet"><span class="by">orbital-decay</span><span>|</span><a href="#37958508">parent</a><span>|</span><a href="#37959147">next</a><span>|</span><label class="collapse" for="c-37960119">[-]</label><label class="expand" for="c-37960119">[18 more]</label></div><br/><div class="children"><div class="content">Drug gangs widely use XMPP as a secure communication channel in combination with Tor. Hydra (the darknet market) has been taken down by German police in 2022 after trying to extend their &quot;service&quot; to the EU; something similar might or might not have happened here.</div><br/><div id="37962404" class="c"><input type="checkbox" id="c-37962404" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37960119">parent</a><span>|</span><a href="#37959147">next</a><span>|</span><label class="collapse" for="c-37962404">[-]</label><label class="expand" for="c-37962404">[17 more]</label></div><br/><div class="children"><div class="content">They should have used Telegram: unlike Let&#x27;s Encrypt with a joke level security it is not so easy to break.</div><br/><div id="37963013" class="c"><input type="checkbox" id="c-37963013" checked=""/><div class="controls bullet"><span class="by">grishka</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962404">parent</a><span>|</span><a href="#37962967">next</a><span>|</span><label class="collapse" for="c-37963013">[-]</label><label class="expand" for="c-37963013">[5 more]</label></div><br/><div class="children"><div class="content">I&#x27;d like to add that MTProto is impossible to MITM because there are no trusted third parties. The handshake that happens before the user logs into their account includes a step with RSA. The public keys for that step are hardcoded into clients.<p>To anyone who wants to complain about Telegram not encrypting chats by default and using &quot;homebrew crypto&quot; I&#x27;d like to say that it&#x27;s XMPP we&#x27;re discussing here. Telegram offers marginally better security than XMPP over TLS. The &quot;homebrew crypto&quot; is still not broken in 10 years and not for the lack of trying.</div><br/><div id="37963268" class="c"><input type="checkbox" id="c-37963268" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963013">parent</a><span>|</span><a href="#37963419">next</a><span>|</span><label class="collapse" for="c-37963268">[-]</label><label class="expand" for="c-37963268">[3 more]</label></div><br/><div class="children"><div class="content">&gt; Telegram offers marginally better security than XMPP over TLS.<p>I think you should compare apples to apples, that is, end-to-end encrypted XMPP using OTR&#x2F;OMEMO&#x2F;PGP. However, I agree that many XMPP clients were UX disaster when using E2E.</div><br/><div id="37963316" class="c"><input type="checkbox" id="c-37963316" checked=""/><div class="controls bullet"><span class="by">grishka</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963268">parent</a><span>|</span><a href="#37963419">next</a><span>|</span><label class="collapse" for="c-37963316">[-]</label><label class="expand" for="c-37963316">[2 more]</label></div><br/><div class="children"><div class="content">End-to-end encrypted XMPP should be compared to Telegram&#x27;s secret chats then. Both are opt-in and both aren&#x27;t very popular among users of these services.</div><br/><div id="37964916" class="c"><input type="checkbox" id="c-37964916" checked=""/><div class="controls bullet"><span class="by">toastal</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963316">parent</a><span>|</span><a href="#37963419">next</a><span>|</span><label class="collapse" for="c-37964916">[-]</label><label class="expand" for="c-37964916">[1 more]</label></div><br/><div class="children"><div class="content">A lot of clients have OMEMO on by default now. You can’t enforce it for all clients &amp; across the entire network tho as XMPP is a ‘simple’ protocol without a let of bells &amp; whistles meant to be eXtended like OMEMO&#x2F;OTR&#x2F;PGP built atop it. With the newer compliance suites tho, to be considered ‘modern’ OMEMO &amp; other e2ee options are expected to be supported. Gajim makes the UI easy, &amp; Conversations isn’t bad. Profanity is a bit more obtuse to use since you need to trust your own keys manually too &amp; they’re not autocompleted, but all the tools are there even for a TUI client.</div><br/></div></div></div></div></div></div><div id="37963419" class="c"><input type="checkbox" id="c-37963419" checked=""/><div class="controls bullet"><span class="by">throwaway290</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963013">parent</a><span>|</span><a href="#37963268">prev</a><span>|</span><a href="#37962967">next</a><span>|</span><label class="collapse" for="c-37963419">[-]</label><label class="expand" for="c-37963419">[1 more]</label></div><br/><div class="children"><div class="content">&gt; The public keys for that step are hardcoded into clients.<p>Yeah, and the private keys are shared with Roskompozor.</div><br/></div></div></div></div><div id="37962967" class="c"><input type="checkbox" id="c-37962967" checked=""/><div class="controls bullet"><span class="by">asdfv09s9d80fu9</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962404">parent</a><span>|</span><a href="#37963013">prev</a><span>|</span><a href="#37962916">next</a><span>|</span><label class="collapse" for="c-37962967">[-]</label><label class="expand" for="c-37962967">[7 more]</label></div><br/><div class="children"><div class="content">The same Telegram that leaks your IP?<p><a href="https:&#x2F;&#x2F;techcrunch.com&#x2F;2023&#x2F;10&#x2F;19&#x2F;telegram-is-still-leaking-user-ip-addresses-to-contacts&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;techcrunch.com&#x2F;2023&#x2F;10&#x2F;19&#x2F;telegram-is-still-leaking-...</a></div><br/><div id="37963038" class="c"><input type="checkbox" id="c-37963038" checked=""/><div class="controls bullet"><span class="by">grishka</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962967">parent</a><span>|</span><a href="#37962916">next</a><span>|</span><label class="collapse" for="c-37963038">[-]</label><label class="expand" for="c-37963038">[6 more]</label></div><br/><div class="children"><div class="content">&gt; The popular messaging app Telegram can leak your IP address if you simply add a hacker to your contacts and accept a phone call from them.<p>Peer-to-peer communication reveals people&#x27;s IP addresses to each other, what a sensational revelation! By the way, water is wet.</div><br/><div id="37963100" class="c"><input type="checkbox" id="c-37963100" checked=""/><div class="controls bullet"><span class="by">asdfv09s9d80fu9</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963038">parent</a><span>|</span><a href="#37962916">next</a><span>|</span><label class="collapse" for="c-37963100">[-]</label><label class="expand" for="c-37963100">[5 more]</label></div><br/><div class="children"><div class="content">Since Telegram claims to be a secure messaging app, while leaking private details and since you used to work at Telegram, maybe stfu.<p>All voice can be E2E thru servers, like Signal does.</div><br/><div id="37963402" class="c"><input type="checkbox" id="c-37963402" checked=""/><div class="controls bullet"><span class="by">xp84</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963100">parent</a><span>|</span><a href="#37963166">next</a><span>|</span><label class="collapse" for="c-37963402">[-]</label><label class="expand" for="c-37963402">[1 more]</label></div><br/><div class="children"><div class="content">I actually think it depends on what your type of threat is. If secure means talking to trusted people, and no one else should know what you say or to whom, Telegram is still great and who cares if my confederate knows my IP. He doesn’t care.<p>If you’re using it to communicate to a hostile party who would love to unmask you, then very not so much. Personally I’m not in the second category but I’m sure some are.</div><br/></div></div><div id="37963166" class="c"><input type="checkbox" id="c-37963166" checked=""/><div class="controls bullet"><span class="by">grishka</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963100">parent</a><span>|</span><a href="#37963402">prev</a><span>|</span><a href="#37963121">next</a><span>|</span><label class="collapse" for="c-37963166">[-]</label><label class="expand" for="c-37963166">[1 more]</label></div><br/><div class="children"><div class="content">Telegram is as secure as it can possibly be without the security requiring compromises and leaking into the UX. I thought that was clear to anyone who has ever used it. If you require 100% bulletproof security and are willing to compromise on convenience, it&#x27;s not for you.<p>Since this thread is about XMPP, Telegram&#x27;s security is effectively the same as XMPP over TLS, maybe a bit better because there isn&#x27;t a trusted third party (the CA).<p>&gt; All voice can be E2E thru servers, like Signal does.<p>I know that. In fact, I built the first VoIP implementation for Telegram, libtgvoip, myself from scratch. Relay servers add delay, can run out of capacity, and cost money in bandwidth. Of course relays are still used if a P2P connection can not be established (libtgvoip always started the call through the relays and only switched to P2P if pings went through and RTT was lower, that took at least several seconds before enough statistics was gathered).</div><br/></div></div><div id="37963121" class="c"><input type="checkbox" id="c-37963121" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963100">parent</a><span>|</span><a href="#37963166">prev</a><span>|</span><a href="#37964051">next</a><span>|</span><label class="collapse" for="c-37963121">[-]</label><label class="expand" for="c-37963121">[1 more]</label></div><br/><div class="children"><div class="content">You can disable peer-to-peer connections in settings, as well as disable calls from everyone or specific contacts.</div><br/></div></div><div id="37964051" class="c"><input type="checkbox" id="c-37964051" checked=""/><div class="controls bullet"><span class="by">robjan</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37963100">parent</a><span>|</span><a href="#37963121">prev</a><span>|</span><a href="#37962916">next</a><span>|</span><label class="collapse" for="c-37964051">[-]</label><label class="expand" for="c-37964051">[1 more]</label></div><br/><div class="children"><div class="content">Signal is peer to peer by default as well unless you go into advanced settings and enable &quot;always relay calls&quot;</div><br/></div></div></div></div></div></div></div></div><div id="37962916" class="c"><input type="checkbox" id="c-37962916" checked=""/><div class="controls bullet"><span class="by">paulryanrogers</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962404">parent</a><span>|</span><a href="#37962967">prev</a><span>|</span><a href="#37964739">next</a><span>|</span><label class="collapse" for="c-37962916">[-]</label><label class="expand" for="c-37962916">[1 more]</label></div><br/><div class="children"><div class="content">Has Telegram been audited? Does it encrypt by default?</div><br/></div></div><div id="37964739" class="c"><input type="checkbox" id="c-37964739" checked=""/><div class="controls bullet"><span class="by">Nasreddin_Hodja</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962404">parent</a><span>|</span><a href="#37962916">prev</a><span>|</span><a href="#37962469">next</a><span>|</span><label class="collapse" for="c-37964739">[-]</label><label class="expand" for="c-37964739">[1 more]</label></div><br/><div class="children"><div class="content">&gt; They should have used Telegram<p>It requires phone number.</div><br/></div></div><div id="37962469" class="c"><input type="checkbox" id="c-37962469" checked=""/><div class="controls bullet"><span class="by">acheong08</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962404">parent</a><span>|</span><a href="#37964739">prev</a><span>|</span><a href="#37959147">next</a><span>|</span><label class="collapse" for="c-37962469">[-]</label><label class="expand" for="c-37962469">[2 more]</label></div><br/><div class="children"><div class="content">Telegram? Not Signal or Matrix?</div><br/><div id="37964930" class="c"><input type="checkbox" id="c-37964930" checked=""/><div class="controls bullet"><span class="by">toastal</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962469">parent</a><span>|</span><a href="#37959147">next</a><span>|</span><label class="collapse" for="c-37964930">[-]</label><label class="expand" for="c-37964930">[1 more]</label></div><br/><div class="children"><div class="content">Signal has massive usability issues: requires a phone number, requires a primary Android or iOS devices, can’t register multiple Android or iOS devices, requires Google Play services for notifications unless you get the APK which drains your battery (a fork, Molly, no supports UnifiedPush tho).</div><br/></div></div></div></div></div></div></div></div><div id="37959147" class="c"><input type="checkbox" id="c-37959147" checked=""/><div class="controls bullet"><span class="by">ValdikSS</span><span>|</span><a href="#37958508">parent</a><span>|</span><a href="#37960119">prev</a><span>|</span><a href="#37962395">next</a><span>|</span><label class="collapse" for="c-37959147">[-]</label><label class="expand" for="c-37959147">[1 more]</label></div><br/><div class="children"><div class="content">Yes, I tend to believe that as well. My guess it&#x27;s either related to Genesis Market or Qakbot takedowns.</div><br/></div></div><div id="37962395" class="c"><input type="checkbox" id="c-37962395" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">parent</a><span>|</span><a href="#37959147">prev</a><span>|</span><a href="#37964968">next</a><span>|</span><label class="collapse" for="c-37962395">[-]</label><label class="expand" for="c-37962395">[12 more]</label></div><br/><div class="children"><div class="content">This shows that Let&#x27;s Encrypt security is a joke because now any large national ISP can use same MiTM to issue a certificate for any site hosted within a country. The SSL infrastructure is completely compromised.<p>UPD: it seems that this is not Let&#x27;s Encrypt&#x27;s problem, but the large vulnerability of SSL infrastructure in general: many other CAs would also issue a valid certificate to an attacker capable of doing MitM.</div><br/><div id="37962556" class="c"><input type="checkbox" id="c-37962556" checked=""/><div class="controls bullet"><span class="by">bananapub</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962395">parent</a><span>|</span><a href="#37962671">next</a><span>|</span><label class="collapse" for="c-37962556">[-]</label><label class="expand" for="c-37962556">[3 more]</label></div><br/><div class="children"><div class="content">what?  nothing to do with Let&#x27;s Encrypt, if someone gets to large-scale MITM your traffic then they can get anyone to issue a DV cert.</div><br/><div id="37962594" class="c"><input type="checkbox" id="c-37962594" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962556">parent</a><span>|</span><a href="#37962671">next</a><span>|</span><label class="collapse" for="c-37962594">[-]</label><label class="expand" for="c-37962594">[2 more]</label></div><br/><div class="children"><div class="content">So for example, if traffic to Google goes through a Huawei router somewhere, then Huawei can issue a Let&#x27;s Encrypt certificate for Google, right? And any large national ISP can use MitM to issue fake certificates for any site hosted within that country?<p>To me it looks like SSL cert infra is completely compromised and unreliable.</div><br/><div id="37963281" class="c"><input type="checkbox" id="c-37963281" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962594">parent</a><span>|</span><a href="#37962671">next</a><span>|</span><label class="collapse" for="c-37963281">[-]</label><label class="expand" for="c-37963281">[1 more]</label></div><br/><div class="children"><div class="content">&gt; then Huawei can issue a Let&#x27;s Encrypt certificate for Google, right?<p>Google has CAA records set (<a href="https:&#x2F;&#x2F;www.entrust.com&#x2F;resources&#x2F;certificate-solutions&#x2F;tools&#x2F;caa-lookup" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.entrust.com&#x2F;resources&#x2F;certificate-solutions&#x2F;tool...</a>) and I guess CAs will have denylists of &quot;popular&quot; domains, so no.<p>&gt; And any large national ISP can use MitM to issue fake certificates for any site hosted within that country?<p>Yes. You can fix this by CAA and ACME-CAA.<p>I can&#x27;t think of a way to validate DV certificates in a better way that will resist this kind of attack.</div><br/></div></div></div></div></div></div><div id="37962671" class="c"><input type="checkbox" id="c-37962671" checked=""/><div class="controls bullet"><span class="by">Eduard</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962395">parent</a><span>|</span><a href="#37962556">prev</a><span>|</span><a href="#37962420">next</a><span>|</span><label class="collapse" for="c-37962671">[-]</label><label class="expand" for="c-37962671">[7 more]</label></div><br/><div class="children"><div class="content">&gt; This shows that Let&#x27;s Encrypt security is a joke because now any large national ISP can use same MiTM to issue a certificate for any site hosted within a country. The SSL infrastructure is completely compromised.<p>the information available right now are too vague to come to a conclusion this bold.<p>Instead, I find it something like the following more plausible:<p>jabber.ru and xmpp.ru seem to use  &quot;exotic&quot; DNS servers (at least as I checked right now).<p><a href="https:&#x2F;&#x2F;uk.godaddy.com&#x2F;whois&#x2F;results.aspx?itc=dlp_domain_whois&amp;domain=xmpp.ru" rel="nofollow noreferrer">https:&#x2F;&#x2F;uk.godaddy.com&#x2F;whois&#x2F;results.aspx?itc=dlp_domain_who...</a><p>All it then takes is an exploit there in the DNS server, or a badly set-up ACME DNS-01 there, in order for Let&#x27;s Encrypt to grant an SSL certificate.<p><a href="https:&#x2F;&#x2F;letsencrypt.org&#x2F;docs&#x2F;challenge-types&#x2F;#dns-01-challenge" rel="nofollow noreferrer">https:&#x2F;&#x2F;letsencrypt.org&#x2F;docs&#x2F;challenge-types&#x2F;#dns-01-challen...</a><p>The moment you&#x27;re able to write a (TXT) record for some domain name, you have proven to be eligible for getting an SSL certificate for that domain name.</div><br/><div id="37962690" class="c"><input type="checkbox" id="c-37962690" checked=""/><div class="controls bullet"><span class="by">hlandau</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962671">parent</a><span>|</span><a href="#37962699">next</a><span>|</span><label class="collapse" for="c-37962690">[-]</label><label class="expand" for="c-37962690">[3 more]</label></div><br/><div class="children"><div class="content">Both you and the grandparent are correct in that both propose viable attacks; it is a <i>known fact</i> (and not news to any expert in the space) that &quot;domain validation&quot; certificates are vulnerable to &quot;global&quot; MitM in which an attacker can intercept <i>all</i> traffic to a domain (and therefore intercept the validation probes). A situation in which a service&#x27;s hosting company is sitting on their &quot;front door&quot; (so to speak) and MitMing <i>all</i> traffic that goes their way is exactly such a situation (hence my recommended mitigation).</div><br/><div id="37962707" class="c"><input type="checkbox" id="c-37962707" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962690">parent</a><span>|</span><a href="#37962699">next</a><span>|</span><label class="collapse" for="c-37962707">[-]</label><label class="expand" for="c-37962707">[2 more]</label></div><br/><div class="children"><div class="content">Hosting company is not the only one who can do MitM; any ISP through which the traffic passes can do that as well; and if there are backdoors in foreign network equipment then the manufacturer of equipment can do MitM too.</div><br/><div id="37963388" class="c"><input type="checkbox" id="c-37963388" checked=""/><div class="controls bullet"><span class="by">supriyo-biswas</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962707">parent</a><span>|</span><a href="#37962699">next</a><span>|</span><label class="collapse" for="c-37963388">[-]</label><label class="expand" for="c-37963388">[1 more]</label></div><br/><div class="children"><div class="content">This is false, because Let’s Encrypt uses servers in multiple places to get a mix of routing paths to eliminate it as an attack vector.</div><br/></div></div></div></div></div></div><div id="37962699" class="c"><input type="checkbox" id="c-37962699" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962671">parent</a><span>|</span><a href="#37962690">prev</a><span>|</span><a href="#37962420">next</a><span>|</span><label class="collapse" for="c-37962699">[-]</label><label class="expand" for="c-37962699">[3 more]</label></div><br/><div class="children"><div class="content">ns2.jabber.ru is hosted at Akado (ordinary Russian ISP) in Moscow, as for ns1.jabber.ru it looks like it is hosted at Linode. So maybe ns1 was compromised as well, as for ns2 I doubt that.</div><br/><div id="37962995" class="c"><input type="checkbox" id="c-37962995" checked=""/><div class="controls bullet"><span class="by">asdfv09s9d80fu9</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962699">parent</a><span>|</span><a href="#37962420">next</a><span>|</span><label class="collapse" for="c-37962995">[-]</label><label class="expand" for="c-37962995">[2 more]</label></div><br/><div class="children"><div class="content">So because one is hosted in Moscow, you find it less likely to be hacked? What a humorous conclusion.</div><br/><div id="37963127" class="c"><input type="checkbox" id="c-37963127" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958508">root</a><span>|</span><a href="#37962995">parent</a><span>|</span><a href="#37962420">next</a><span>|</span><label class="collapse" for="c-37963127">[-]</label><label class="expand" for="c-37963127">[1 more]</label></div><br/><div class="children"><div class="content">Yes, because it is highly unlikely that Russian police or Russian ISP will cooperate with US or European police.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="37964968" class="c"><input type="checkbox" id="c-37964968" checked=""/><div class="controls bullet"><span class="by">chgo1</span><span>|</span><a href="#37958508">prev</a><span>|</span><a href="#37956291">next</a><span>|</span><label class="collapse" for="c-37964968">[-]</label><label class="expand" for="c-37964968">[1 more]</label></div><br/><div class="children"><div class="content">@dang: .org.ru should probably be treated as TLD</div><br/></div></div><div id="37956291" class="c"><input type="checkbox" id="c-37956291" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37964968">prev</a><span>|</span><a href="#37958071">next</a><span>|</span><label class="collapse" for="c-37956291">[-]</label><label class="expand" for="c-37956291">[34 more]</label></div><br/><div class="children"><div class="content">Archive [1]<p>Their theories are interesting and would explain how they obtained the certs if true.  Perhaps the take-away here is to have multiple probes on multiple providers checking all of ones TLS fingerprints and alerting on unknown fingerprints and then checking the certificate transparency log or lack thereof.<p><pre><code>    openssl s_client -servername news.ycombinator.com -connect news.ycombinator.com:443 &lt; &#x2F;dev&#x2F;null 2&gt;&#x2F;dev&#x2F;null | openssl x509 -fingerprint -noout -in &#x2F;dev&#x2F;stdin
    SHA1 Fingerprint=7E:49:BA:40:86:87:B3:39:66:93:94:9E:9C:45:71:85:3C:8D:95:16
</code></pre>
[1] - <a href="https:&#x2F;&#x2F;archive.ph&#x2F;C0jYJ" rel="nofollow noreferrer">https:&#x2F;&#x2F;archive.ph&#x2F;C0jYJ</a> [updated]</div><br/><div id="37956665" class="c"><input type="checkbox" id="c-37956665" checked=""/><div class="controls bullet"><span class="by">ValdikSS</span><span>|</span><a href="#37956291">parent</a><span>|</span><a href="#37958071">next</a><span>|</span><label class="collapse" for="c-37956665">[-]</label><label class="expand" for="c-37956665">[33 more]</label></div><br/><div class="children"><div class="content">I&#x27;ve added &quot;Could you prevent or monitor this kind of attack?&quot; section.<p>There are several indications which could be used to discover the attack from day 1:<p>* All issued SSL&#x2F;TLS certificates are subject to certificate transparency. It is worth configuring certificate transparency monitoring, such as Cert Spotter (source on github), which will notify you by email of new certificates issued for your domain names<p>* Limit validation methods and set exact account identifier which could issue new certificates with Certification Authority Authorization (CAA) Record Extensions for Account URI and Automatic Certificate Management Environment (ACME) Method Binding (RFC 8657) to prevent certificate issue for your domain using other certificate authorities, ACME accounts or validation methods<p>* Monitor SSL&#x2F;TLS certificate changes on all your services using external service<p>* Monitor MAC address of default gateway for changes</div><br/><div id="37956814" class="c"><input type="checkbox" id="c-37956814" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956665">parent</a><span>|</span><a href="#37956911">next</a><span>|</span><label class="collapse" for="c-37956814">[-]</label><label class="expand" for="c-37956814">[8 more]</label></div><br/><div class="children"><div class="content">Nice addition.  Me personally being the paranoid type, I don&#x27;t trust the transparency log for monitoring but rather for writing up the root cause analysis.  Reason being is that if someone can legally compel Hetzner and&#x2F;or Linode and&#x2F;or LetsEncrypt to do or not do something then the same entity can compel the certificate transparency site to ignore something.   But you covered what I would do and that is to have multiple nodes doing active monitoring of TLS changes using an external service.  That service being openssl s_client in my case.<p>In the case of Jabber it might be interesting to add some monitoring in the application that uses a cryptographic signed payload to list all the valid fingerprints and send an alert message to the server if something odd is happening <i>like public key pinning but without a hard-fail</i>.   That list could be pre-loaded with new certificate fingerprints prior to being deployed.  If the oddness is confirmed then perhaps add some way to tell the clients that certificate is likely forged.  That way both server operator and client are aware that something evil this way comes.<p>[Edit] - Looks like based on the comment from MattJ100 that some Jabber servers and some clients can already do something like this.</div><br/><div id="37962490" class="c"><input type="checkbox" id="c-37962490" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956814">parent</a><span>|</span><a href="#37959382">next</a><span>|</span><label class="collapse" for="c-37962490">[-]</label><label class="expand" for="c-37962490">[3 more]</label></div><br/><div class="children"><div class="content">The problem is that Let&#x27;s Encrypt issued a fake certificate without proper validation.<p>UPD: I was initially wrong. It looks like many CAs will issue a valid certificate to attacker capable of doing MitM.</div><br/><div id="37962575" class="c"><input type="checkbox" id="c-37962575" checked=""/><div class="controls bullet"><span class="by">bananapub</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37962490">parent</a><span>|</span><a href="#37959382">next</a><span>|</span><label class="collapse" for="c-37962575">[-]</label><label class="expand" for="c-37962575">[2 more]</label></div><br/><div class="children"><div class="content">why do you keep making this incorrect claim?<p>it was a DV cert, and it was considered validated because someone was MITMing the traffic.  that would have worked against any CA, nothing at all to do with Let&#x27;s Encrypt.</div><br/><div id="37962639" class="c"><input type="checkbox" id="c-37962639" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37962575">parent</a><span>|</span><a href="#37959382">next</a><span>|</span><label class="collapse" for="c-37962639">[-]</label><label class="expand" for="c-37962639">[1 more]</label></div><br/><div class="children"><div class="content">Corrected the comment to reflect that SSL cert infrastructure is ridiculously easy to hack.</div><br/></div></div></div></div></div></div><div id="37959382" class="c"><input type="checkbox" id="c-37959382" checked=""/><div class="controls bullet"><span class="by">Hello71</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956814">parent</a><span>|</span><a href="#37962490">prev</a><span>|</span><a href="#37956911">next</a><span>|</span><label class="collapse" for="c-37959382">[-]</label><label class="expand" for="c-37959382">[4 more]</label></div><br/><div class="children"><div class="content">&gt; if someone can legally compel Hetzner and&#x2F;or Linode and&#x2F;or LetsEncrypt to do or not do something then the same entity can compel the certificate transparency site to ignore something<p>the major certificate transparency logs are operated by several independent global companies, Apple and Google for LE. it&#x27;s unlikely that they will agree to forge their global CT logs for a single government. more importantly, SCTs allow cryptographic proof of anyone lying, making such an action very dangerous for their continued participation in the WebPKI ecosystem.</div><br/><div id="37961688" class="c"><input type="checkbox" id="c-37961688" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37959382">parent</a><span>|</span><a href="#37956911">next</a><span>|</span><label class="collapse" for="c-37961688">[-]</label><label class="expand" for="c-37961688">[3 more]</label></div><br/><div class="children"><div class="content">This sounds like the methodology for blockchain and multiple ledgers.  Ultimately however crt.sh is hosted somewhere and while there may be multiple controllers that have access to logs on the front-end, someone hosting that site could be compelled or blackmailed into tinkering with the levers behind the scene to exclude activity on a domain.  I&#x27;m not suggesting that is what is happening, just that it could and Apple, Google and others would have plausible deniability.  On the other hand having active probes distributed around the world on multiple ISP&#x27;s looking for fingerprint changes would be much harder to hide though more expensive to operate <i>along similar lines to archive.is or using distributed Nagios NPRE agents or using ThousandEyes probes</i>.</div><br/><div id="37963304" class="c"><input type="checkbox" id="c-37963304" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37961688">parent</a><span>|</span><a href="#37962581">next</a><span>|</span><label class="collapse" for="c-37963304">[-]</label><label class="expand" for="c-37963304">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Ultimately however crt.sh is hosted somewhere<p>So is it possible to run my own copy of crt.sh? How demanding it is (e.g. data size)?</div><br/></div></div><div id="37962581" class="c"><input type="checkbox" id="c-37962581" checked=""/><div class="controls bullet"><span class="by">bananapub</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37961688">parent</a><span>|</span><a href="#37963304">prev</a><span>|</span><a href="#37956911">next</a><span>|</span><label class="collapse" for="c-37962581">[-]</label><label class="expand" for="c-37962581">[1 more]</label></div><br/><div class="children"><div class="content">this is a very very silly take.  Apple and Google have armies of lawyers who spend all day telling cops with subpoenas from all around the world to fuck off.</div><br/></div></div></div></div></div></div></div></div><div id="37956911" class="c"><input type="checkbox" id="c-37956911" checked=""/><div class="controls bullet"><span class="by">MattJ100</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956665">parent</a><span>|</span><a href="#37956814">prev</a><span>|</span><a href="#37956928">next</a><span>|</span><label class="collapse" for="c-37956911">[-]</label><label class="expand" for="c-37956911">[4 more]</label></div><br/><div class="children"><div class="content">I mentioned this in the operators channel just now, but also worth noting is that channel binding (e.g. SCRAM-*-PLUS in combination with RFC 9266) also mitigates this attack. Essentially the connecting client is able to detect the mismatch between the certificate or handshake the server thinks it is presenting, and the one the client actually sees.<p>ejabberd and Prosody support it, and a number of clients too.</div><br/><div id="37957311" class="c"><input type="checkbox" id="c-37957311" checked=""/><div class="controls bullet"><span class="by">Avamander</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956911">parent</a><span>|</span><a href="#37956928">next</a><span>|</span><label class="collapse" for="c-37957311">[-]</label><label class="expand" for="c-37957311">[3 more]</label></div><br/><div class="children"><div class="content">&gt; I mentioned this in the operators channel just now, but also worth noting is that channel binding (e.g. SCRAM-*-PLUS in combination with RFC 9266) also mitigates this attack.<p>Doesn&#x27;t that require the server to persistently store user passwords in plaintext?</div><br/><div id="37957677" class="c"><input type="checkbox" id="c-37957677" checked=""/><div class="controls bullet"><span class="by">MattJ100</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957311">parent</a><span>|</span><a href="#37957689">next</a><span>|</span><label class="collapse" for="c-37957677">[-]</label><label class="expand" for="c-37957677">[1 more]</label></div><br/><div class="children"><div class="content">Not at all. If you mean SCRAM, it was actually pretty novel when it was introduced because it allows the server to store a hash, the client to store a hash, and only a hash is exchanged over the wire.<p>SCRAM also allows the client to verify that the server possesses the password (or a hash of it), so a MITM that just says &quot;yep, your credentials are correct - go ahead!&quot; can be detected.<p>Channel binding is an addition to SCRAM (it&#x27;s usable outside of SCRAM too) that allows securely checking the TLS stream as well. Specifically it allows verification that the TLS stream is terminated by the same entity that has (a hash of) your password.</div><br/></div></div><div id="37957689" class="c"><input type="checkbox" id="c-37957689" checked=""/><div class="controls bullet"><span class="by">mjl-</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957311">parent</a><span>|</span><a href="#37957677">prev</a><span>|</span><a href="#37956928">next</a><span>|</span><label class="collapse" for="c-37957689">[-]</label><label class="expand" for="c-37957689">[1 more]</label></div><br/><div class="children"><div class="content">no, scram is all about not exchanging and not storing plain text passwords.
the plus variants add tls channel binding.</div><br/></div></div></div></div></div></div><div id="37956928" class="c"><input type="checkbox" id="c-37956928" checked=""/><div class="controls bullet"><span class="by">mjl-</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956665">parent</a><span>|</span><a href="#37956911">prev</a><span>|</span><a href="#37957434">next</a><span>|</span><label class="collapse" for="c-37956928">[-]</label><label class="expand" for="c-37956928">[12 more]</label></div><br/><div class="children"><div class="content">DANE (with DNSSEC) may be an option to look at too, with public keys in DNS. though probably client support isn&#x27;t universal (i have no (recent) experience using jabber). the CA was one weak point here.<p>checking for new public keys in certificates when keeping private keys between renewals would also help.<p>i suppose any storage and possibly ram should also be considered compromised? e.g. private keys stored on disk without encryption, but also by being read into memory. especially on the vm.</div><br/><div id="37957295" class="c"><input type="checkbox" id="c-37957295" checked=""/><div class="controls bullet"><span class="by">Avamander</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956928">parent</a><span>|</span><a href="#37959968">next</a><span>|</span><label class="collapse" for="c-37957295">[-]</label><label class="expand" for="c-37957295">[6 more]</label></div><br/><div class="children"><div class="content">DNSSEC operators can be strong-armed the same way. You will also lose out on transparency logs.<p>In the end law enforcement can also walk up to the machine&#x2F;hypervisor and steal&#x2F;monitor interesting things from that as well. This is funnily the exact evil maid threat scenario so many (especially Linux people) find unrealistic.</div><br/><div id="37957551" class="c"><input type="checkbox" id="c-37957551" checked=""/><div class="controls bullet"><span class="by">mjl-</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957295">parent</a><span>|</span><a href="#37959691">next</a><span>|</span><label class="collapse" for="c-37957551">[-]</label><label class="expand" for="c-37957551">[4 more]</label></div><br/><div class="children"><div class="content">you could run your own dnssec servers (not too hard). and monitor the DS records for your domain at the TLD. have there been any reported cases of law enforcement changing DNSSEC (e.g. adding a DS record)?<p>i agree there&#x27;s probably no way to keep a machine hosted at a company secure from law enforcement. also why i suggested storage and anything in ram on the machine can be considered compromised. this attack (swapping out network connection for a while to get a certificate through let&#x27;s encrypt) was probably easiest&#x2F;least intrusive. if it wasn&#x27;t an option, the next easiest option would be taken. perhaps the options that are harder to execute are more likely to be detected, or less likely to be worthwhile.</div><br/><div id="37957680" class="c"><input type="checkbox" id="c-37957680" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957551">parent</a><span>|</span><a href="#37958075">next</a><span>|</span><label class="collapse" for="c-37957680">[-]</label><label class="expand" for="c-37957680">[1 more]</label></div><br/><div class="children"><div class="content">Law enforcement <i>routinely</i> manipulates the DNS; famously so.</div><br/></div></div><div id="37958075" class="c"><input type="checkbox" id="c-37958075" checked=""/><div class="controls bullet"><span class="by">Avamander</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957551">parent</a><span>|</span><a href="#37957680">prev</a><span>|</span><a href="#37959187">next</a><span>|</span><label class="collapse" for="c-37958075">[-]</label><label class="expand" for="c-37958075">[1 more]</label></div><br/><div class="children"><div class="content">&gt; have there been any reported cases of law enforcement changing DNSSEC (e.g. adding a DS record)?<p>It&#x27;s not like anybody is watching or using DNSSEC like that. Also at best you might be able to detect a change but it won&#x27;t prevent the attack and neither will it leave a long-term mark like CT would.</div><br/></div></div><div id="37959187" class="c"><input type="checkbox" id="c-37959187" checked=""/><div class="controls bullet"><span class="by">trevyn</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957551">parent</a><span>|</span><a href="#37958075">prev</a><span>|</span><a href="#37959691">next</a><span>|</span><label class="collapse" for="c-37959187">[-]</label><label class="expand" for="c-37959187">[1 more]</label></div><br/><div class="children"><div class="content">&gt;keep a machine hosted at a company secure from law enforcement<p>Your own hardware + continuous video monitoring is probably good enough. The idea is not to keep it secure, but to know when a breach has happened.</div><br/></div></div></div></div><div id="37959691" class="c"><input type="checkbox" id="c-37959691" checked=""/><div class="controls bullet"><span class="by">crosser</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957295">parent</a><span>|</span><a href="#37957551">prev</a><span>|</span><a href="#37959968">next</a><span>|</span><label class="collapse" for="c-37959691">[-]</label><label class="expand" for="c-37959691">[1 more]</label></div><br/><div class="children"><div class="content">&gt; DNSSEC operators can be strong-armed the same way. You will also lose out on transparency logs.<p>Kepping DNS registry, CA, and hosting in different jurisdictions could be a noticeable improvement...</div><br/></div></div></div></div><div id="37959968" class="c"><input type="checkbox" id="c-37959968" checked=""/><div class="controls bullet"><span class="by">fanf2</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956928">parent</a><span>|</span><a href="#37957295">prev</a><span>|</span><a href="#37957540">next</a><span>|</span><label class="collapse" for="c-37959968">[-]</label><label class="expand" for="c-37959968">[1 more]</label></div><br/><div class="children"><div class="content">You don’t need DANE to thwart this particular attack: DNSSEC and CAA could have prevented the MITM certificates from being issued in the way they were. If the xmpp.ru and jabber.ru domains used DNSSEC and CAA, it would not have been enough for the MITM to strong-arm Linode and Hetzner: they would also have to strong-arm the domains’ DNS providers. I don’t think the attackers could have done it stealthily (unnoticed for 3 months) without the co-operation of the .ru registry and a MITM attack on all of the Let’s Encrypt validation vantage points.<p>I am one of the co-authors of the DANE SRV RFC <a href="https:&#x2F;&#x2F;www.rfc-editor.org&#x2F;rfc&#x2F;rfc7673" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.rfc-editor.org&#x2F;rfc&#x2F;rfc7673</a> which is what XMPP would use. I don’t follow XMPP development so I don’t know if it has been deployed. I would like it if DANE were more widely used, but it’s not pertinent to this attack.</div><br/></div></div><div id="37957540" class="c"><input type="checkbox" id="c-37957540" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956928">parent</a><span>|</span><a href="#37959968">prev</a><span>|</span><a href="#37957434">next</a><span>|</span><label class="collapse" for="c-37957540">[-]</label><label class="expand" for="c-37957540">[4 more]</label></div><br/><div class="children"><div class="content">I think it&#x27;s a great example why DNSSEC would be bad: at least here, we had transparency logs and there was a simple method to get an attack notification. With DNSSEC, there would be no such thing.</div><br/><div id="37958226" class="c"><input type="checkbox" id="c-37958226" checked=""/><div class="controls bullet"><span class="by">rixthefox</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957540">parent</a><span>|</span><a href="#37958237">next</a><span>|</span><label class="collapse" for="c-37958226">[-]</label><label class="expand" for="c-37958226">[2 more]</label></div><br/><div class="children"><div class="content">I disagree. Forging DNSSEC requires LE to strong arm the domain registrar to modify the DS keys per domain which would also require them pointing to an adversary DNS server to answer those requests with a valid signature. That action would definitely be noticed. Without DNSSEC you are back to square 1 of unsigned DNS that can be modified in-flight, a much worse situation. I personally believe we should be advocating for more DNSSEC, not less.<p>What I think you&#x27;re advocating for is that DNSSEC should have it&#x27;s own transparency log that shows when domains update or cycle their DNSSEC KSK&#x2F;ZSKs which is a great idea, we would just need to get all the domain registrars on board as well which as we can already see with the transparency project, you can&#x27;t get buy in from everyone.</div><br/><div id="37962976" class="c"><input type="checkbox" id="c-37962976" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37958226">parent</a><span>|</span><a href="#37958237">next</a><span>|</span><label class="collapse" for="c-37962976">[-]</label><label class="expand" for="c-37962976">[1 more]</label></div><br/><div class="children"><div class="content">Well, with transparency project we _did_ get buy in from everyone because browsers (like Mozilla and Google) forced it. And there are severe penalties for not obeying transparency log, and well as technical measures to enforce it (for example certs with no CT log would not work in Chrome).<p>This of course only works because there is competition. If TrustCor fails to behave, then this CA is dropped. Customers complain, but not very strongly - there are plenty of CAs around, it&#x27;s annoying to have to switch to another one but still eminently doable. And TrustCor is out of business completely, all their investment is permanently gone.<p>With DNSSEC.. what do you do if you domain registrar does not play by the rules, say is caught double-issuing DS keys?<p>Answer is: likely nothing. Most orgs are not going to move .com to .io because of that -- there links, SEO, even things like business cards. People would complain, _maybe_ registrar would get a fine for 0.0001% of their annual income (but I would not count on this). And that&#x27;s it, the system will stay insecure and they will continue to double-issue certificates.<p>The separation of CA from registrar is a _feature_, and a very helpful one. Competition is good, and we should not make our existing natural monopolies even more useful.</div><br/></div></div></div></div><div id="37958237" class="c"><input type="checkbox" id="c-37958237" checked=""/><div class="controls bullet"><span class="by">mjl-</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957540">parent</a><span>|</span><a href="#37958226">prev</a><span>|</span><a href="#37957434">next</a><span>|</span><label class="collapse" for="c-37958237">[-]</label><label class="expand" for="c-37958237">[1 more]</label></div><br/><div class="children"><div class="content">good point. had me looking for a transparency log for dnssec, arriving at <a href="https:&#x2F;&#x2F;www.huque.com&#x2F;2014&#x2F;07&#x2F;30&#x2F;dnssec-key-trans.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.huque.com&#x2F;2014&#x2F;07&#x2F;30&#x2F;dnssec-key-trans.html</a>. it seems there hasn&#x27;t been activity on that topic in years.<p>an attack would involve a tld operator being compelled to cooperate, or their signing keys being compromised (and then probably adding a DS record for your domain). if that were found out, it would be bad news for trust in dnssec. have there been any known case of this happening? it would be hard (impossible?) to fully detect without transparency log (like for ca certificates).</div><br/></div></div></div></div></div></div><div id="37957434" class="c"><input type="checkbox" id="c-37957434" checked=""/><div class="controls bullet"><span class="by">vsviridov</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956665">parent</a><span>|</span><a href="#37956928">prev</a><span>|</span><a href="#37962484">next</a><span>|</span><label class="collapse" for="c-37957434">[-]</label><label class="expand" for="c-37957434">[7 more]</label></div><br/><div class="children"><div class="content">There&#x27;s also a DNS CAA record that sets up a whitelist of authorities that can issue certificates for the domain.</div><br/><div id="37957616" class="c"><input type="checkbox" id="c-37957616" checked=""/><div class="controls bullet"><span class="by">mcpherrinm</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957434">parent</a><span>|</span><a href="#37957582">next</a><span>|</span><label class="collapse" for="c-37957616">[-]</label><label class="expand" for="c-37957616">[1 more]</label></div><br/><div class="children"><div class="content">At least for Let’s Encrypt, you can also use CAA to require a specific account as well or validation method. This could prevent your hosting provider from issuing on your behalf if they don’t control DNS.<p><a href="https:&#x2F;&#x2F;letsencrypt.org&#x2F;docs&#x2F;caa&#x2F;#the-accounturi-parameter" rel="nofollow noreferrer">https:&#x2F;&#x2F;letsencrypt.org&#x2F;docs&#x2F;caa&#x2F;#the-accounturi-parameter</a></div><br/></div></div><div id="37957582" class="c"><input type="checkbox" id="c-37957582" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957434">parent</a><span>|</span><a href="#37957616">prev</a><span>|</span><a href="#37962484">next</a><span>|</span><label class="collapse" for="c-37957582">[-]</label><label class="expand" for="c-37957582">[5 more]</label></div><br/><div class="children"><div class="content">I use those as well.  I am curious if there has ever been a case where LetsEncrypt were legally compelled to create exemptions for domains <i>as in ignoring CAA and not logging to the transparency log</i> or to just outright issue certs to an agency for specific names.  CAA account and method restrictions would be negated at that point.<p>The more I think about it I would wager that Linode and Hetzner were just law enforcement having good taste in VPS providers.  It&#x27;s more likely to me that LE was the compelled target.</div><br/><div id="37958445" class="c"><input type="checkbox" id="c-37958445" checked=""/><div class="controls bullet"><span class="by">mcpherrinm</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957582">parent</a><span>|</span><a href="#37957791">next</a><span>|</span><label class="collapse" for="c-37958445">[-]</label><label class="expand" for="c-37958445">[3 more]</label></div><br/><div class="children"><div class="content">Let’s Encrypt publishes legal transparency reports on what law enforcement asks us.<p><a href="https:&#x2F;&#x2F;letsencrypt.org&#x2F;documents&#x2F;ISRG-Legal-Transparency-Report-April-1-2023.pdf" rel="nofollow noreferrer">https:&#x2F;&#x2F;letsencrypt.org&#x2F;documents&#x2F;ISRG-Legal-Transparency-Re...</a><p>We’ve never been ordered to issue a certificate.<p>While I am a Let’s Encrypt employee, this message is not an official communication of Let’s Encrypt and shouldn’t be interpreted as such.</div><br/><div id="37958593" class="c"><input type="checkbox" id="c-37958593" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37958445">parent</a><span>|</span><a href="#37957791">next</a><span>|</span><label class="collapse" for="c-37958593">[-]</label><label class="expand" for="c-37958593">[2 more]</label></div><br/><div class="children"><div class="content">I appreciate that.  I assume that would not cover and NSL which is also a gag order but nice that you have something for all other above board legal requests.  I see you have a column for NSL but have no idea how that could ever increment without violating the NSL.<p>For some background I&#x27;ve spent a good deal of time with lawyers and C-Levels playing devils advocate trying to find a way to indirectly notify customers but it&#x27;s just not legally possible in the United States of America and there is nobody that would risk violating one.  People here on HN often bring up canaries but they are not compatible with a NSL.</div><br/><div id="37963546" class="c"><input type="checkbox" id="c-37963546" checked=""/><div class="controls bullet"><span class="by">tough</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37958593">parent</a><span>|</span><a href="#37957791">next</a><span>|</span><label class="collapse" for="c-37963546">[-]</label><label class="expand" for="c-37963546">[1 more]</label></div><br/><div class="children"><div class="content">they could go the extra mile there and put a canary page about not having accepted any gag orders (which they could remove when they do)</div><br/></div></div></div></div></div></div><div id="37957791" class="c"><input type="checkbox" id="c-37957791" checked=""/><div class="controls bullet"><span class="by">vsviridov</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37957582">parent</a><span>|</span><a href="#37958445">prev</a><span>|</span><a href="#37962484">next</a><span>|</span><label class="collapse" for="c-37957791">[-]</label><label class="expand" for="c-37957791">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s a scary world we&#x27;re living in...</div><br/></div></div></div></div></div></div><div id="37962484" class="c"><input type="checkbox" id="c-37962484" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37956291">root</a><span>|</span><a href="#37956665">parent</a><span>|</span><a href="#37957434">prev</a><span>|</span><a href="#37958071">next</a><span>|</span><label class="collapse" for="c-37962484">[-]</label><label class="expand" for="c-37962484">[1 more]</label></div><br/><div class="children"><div class="content">Let&#x27;s encrypt (and other CAs) should not allow validation using unsecure schemes like HTTP. Especially for sites that have valid certificate from other CA.</div><br/></div></div></div></div></div></div><div id="37958071" class="c"><input type="checkbox" id="c-37958071" checked=""/><div class="controls bullet"><span class="by">upofadown</span><span>|</span><a href="#37956291">prev</a><span>|</span><a href="#37959867">next</a><span>|</span><label class="collapse" for="c-37958071">[-]</label><label class="expand" for="c-37958071">[1 more]</label></div><br/><div class="children"><div class="content">&gt;End-to-end encrypted communications, such as OMEMO, OTR or PGP, are protected from the interception only if both parties have validated the encryption keys. The users are asked to check their accounts for new unauthorized OMEMO and PGP keys in their PEP storage, and change passwords.<p>The attacker would need to set up a separate MiTM for the particular E2EE scheme used. Some of the XMPP clients I have encountered will not let you use a particular cryptographic identity unless you have explicitly claimed to have verified it.<p>Still a good reminder. If you have not seen and dealt with a ridiculously long number (or equivalent) you have not achieved end to end.</div><br/></div></div><div id="37959867" class="c"><input type="checkbox" id="c-37959867" checked=""/><div class="controls bullet"><span class="by">Libre___</span><span>|</span><a href="#37958071">prev</a><span>|</span><a href="#37957719">next</a><span>|</span><label class="collapse" for="c-37959867">[-]</label><label class="expand" for="c-37959867">[1 more]</label></div><br/><div class="children"><div class="content">I was a bit curious about the MAC address since it isn&#x27;t locally administered which indicates to me that someone likely deliberately chose this range of addresses.<p><a href="https:&#x2F;&#x2F;www.google.com&#x2F;search?q=%2290%253Ade%253A01%22+linode" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.google.com&#x2F;search?q=%2290%253Ade%253A01%22+linod...</a><p>Googling for &#x27;&quot;90:de:01&quot; linode&#x27; and &#x27;&quot;90:de:00&quot; linode&#x27; indicates that addresses from these blocks have been assigned to other linode VMs recently. I sadly don&#x27;t have a linode VM of my own to compare with right now but it would seem like the traffic has been routed to another VM on linode infrastructure</div><br/></div></div><div id="37957719" class="c"><input type="checkbox" id="c-37957719" checked=""/><div class="controls bullet"><span class="by">kristjank</span><span>|</span><a href="#37959867">prev</a><span>|</span><a href="#37956830">next</a><span>|</span><label class="collapse" for="c-37957719">[-]</label><label class="expand" for="c-37957719">[12 more]</label></div><br/><div class="children"><div class="content">This really wants me to re-evaluate all the times I have gracefuly TOFU&#x27;d while SSHing into a machine or even logging onto a website.</div><br/><div id="37958353" class="c"><input type="checkbox" id="c-37958353" checked=""/><div class="controls bullet"><span class="by">rodlette</span><span>|</span><a href="#37957719">parent</a><span>|</span><a href="#37957860">next</a><span>|</span><label class="collapse" for="c-37958353">[-]</label><label class="expand" for="c-37958353">[3 more]</label></div><br/><div class="children"><div class="content">Consider including SSH known hosts in your cfgmgmt.<p>I have all my machines&#x27; public keys, and all major git forge&#x27;s SSH keys in my git-managed cfgmgmt repo.<p>For NixOS users: <a href="https:&#x2F;&#x2F;search.nixos.org&#x2F;options?channel=23.05&amp;show=programs.ssh.knownHosts" rel="nofollow noreferrer">https:&#x2F;&#x2F;search.nixos.org&#x2F;options?channel=23.05&amp;show=programs...</a></div><br/><div id="37961831" class="c"><input type="checkbox" id="c-37961831" checked=""/><div class="controls bullet"><span class="by">ehPReth</span><span>|</span><a href="#37957719">root</a><span>|</span><a href="#37958353">parent</a><span>|</span><a href="#37957860">next</a><span>|</span><label class="collapse" for="c-37961831">[-]</label><label class="expand" for="c-37961831">[2 more]</label></div><br/><div class="children"><div class="content">one issue is that most hosting providers don&#x27;t display ssh host keys anywhere in the control panels so unless you have a... lot of fun (and spend time) with the virtual console... (or maybe a custom cloud-init script?) you&#x27;re SOL for the very very first connection</div><br/><div id="37962176" class="c"><input type="checkbox" id="c-37962176" checked=""/><div class="controls bullet"><span class="by">rudasn</span><span>|</span><a href="#37957719">root</a><span>|</span><a href="#37961831">parent</a><span>|</span><a href="#37957860">next</a><span>|</span><label class="collapse" for="c-37962176">[-]</label><label class="expand" for="c-37962176">[1 more]</label></div><br/><div class="children"><div class="content">Isn&#x27;t more important that the known key does not change unless you made the change, than having the &quot;right&quot; key to begin with?</div><br/></div></div></div></div></div></div><div id="37957860" class="c"><input type="checkbox" id="c-37957860" checked=""/><div class="controls bullet"><span class="by">marcosdumay</span><span>|</span><a href="#37957719">parent</a><span>|</span><a href="#37958353">prev</a><span>|</span><a href="#37957802">next</a><span>|</span><label class="collapse" for="c-37957860">[-]</label><label class="expand" for="c-37957860">[1 more]</label></div><br/><div class="children"><div class="content">Given that the attack subverted the TLS certificates, I&#x27;d say key-based TOFU is still a better alternative.<p>Of course, checking the server key is better than not doing so, but any knee-jerk response to TOFU will probably make your security worse.</div><br/></div></div><div id="37957802" class="c"><input type="checkbox" id="c-37957802" checked=""/><div class="controls bullet"><span class="by">lukevp</span><span>|</span><a href="#37957719">parent</a><span>|</span><a href="#37957860">prev</a><span>|</span><a href="#37960995">next</a><span>|</span><label class="collapse" for="c-37957802">[-]</label><label class="expand" for="c-37957802">[5 more]</label></div><br/><div class="children"><div class="content">What does TOFU mean in this context? I haven’t heard that word related to tech before OpenTofu just recently!</div><br/><div id="37957827" class="c"><input type="checkbox" id="c-37957827" checked=""/><div class="controls bullet"><span class="by">sirl1on</span><span>|</span><a href="#37957719">root</a><span>|</span><a href="#37957802">parent</a><span>|</span><a href="#37958157">next</a><span>|</span><label class="collapse" for="c-37957827">[-]</label><label class="expand" for="c-37957827">[1 more]</label></div><br/><div class="children"><div class="content">Trust On First Use. No relation to OpenTofu where Tofu is a word play in TerraForm.</div><br/></div></div><div id="37958157" class="c"><input type="checkbox" id="c-37958157" checked=""/><div class="controls bullet"><span class="by">mmh0000</span><span>|</span><a href="#37957719">root</a><span>|</span><a href="#37957802">parent</a><span>|</span><a href="#37957827">prev</a><span>|</span><a href="#37957824">next</a><span>|</span><label class="collapse" for="c-37958157">[-]</label><label class="expand" for="c-37958157">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Trust_on_first_use" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Trust_on_first_use</a></div><br/></div></div><div id="37957820" class="c"><input type="checkbox" id="c-37957820" checked=""/><div class="controls bullet"><span class="by">holmesworcester</span><span>|</span><a href="#37957719">root</a><span>|</span><a href="#37957802">parent</a><span>|</span><a href="#37957824">prev</a><span>|</span><a href="#37960995">next</a><span>|</span><label class="collapse" for="c-37957820">[-]</label><label class="expand" for="c-37957820">[1 more]</label></div><br/><div class="children"><div class="content">Trust On First Use</div><br/></div></div></div></div><div id="37960995" class="c"><input type="checkbox" id="c-37960995" checked=""/><div class="controls bullet"><span class="by">thriftwy</span><span>|</span><a href="#37957719">parent</a><span>|</span><a href="#37957802">prev</a><span>|</span><a href="#37959957">next</a><span>|</span><label class="collapse" for="c-37960995">[-]</label><label class="expand" for="c-37960995">[1 more]</label></div><br/><div class="children"><div class="content">An unknow key when connecting to a known server will raise all kinds of alarms in my head.</div><br/></div></div><div id="37959957" class="c"><input type="checkbox" id="c-37959957" checked=""/><div class="controls bullet"><span class="by">0xbadcafebee</span><span>|</span><a href="#37957719">parent</a><span>|</span><a href="#37960995">prev</a><span>|</span><a href="#37956830">next</a><span>|</span><label class="collapse" for="c-37959957">[-]</label><label class="expand" for="c-37959957">[1 more]</label></div><br/><div class="children"><div class="content">At DEFCON, fifteen years ago, MITM&#x27;ing TOFU ssh connections was what you did when you were bored in between talks. If you wanted to capture a new first connection, just keep dropping connections until they try a different host or device.<p>I don&#x27;t really get why people use ssh at all if they aren&#x27;t using certs. Might as well use telnet.</div><br/></div></div></div></div><div id="37956830" class="c"><input type="checkbox" id="c-37956830" checked=""/><div class="controls bullet"><span class="by">throwaway77384</span><span>|</span><a href="#37957719">prev</a><span>|</span><a href="#37958146">next</a><span>|</span><label class="collapse" for="c-37956830">[-]</label><label class="expand" for="c-37956830">[9 more]</label></div><br/><div class="children"><div class="content">This is baseless speculation, but I&#x27;m assuming Jabber is being targeted as it&#x27;s famously used on darknet markets for drug trades (or other illicit activity).
Goes to show that you should never just trust &quot;it&#x27;s encrypted, bro&quot;. You need to PGP your messages at the very least. 
Is PGP crackable by quantum computers? Will there be hardening against those kinds of attacks in the future? Since, if the messages have been hoovered up in encrypted form, it&#x27;s just a matter of time until they get decrypted. 
And this appears to be done for just about all web traffic they can get their hands on... see <a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Utah_Data_Center" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Utah_Data_Center</a></div><br/><div id="37957037" class="c"><input type="checkbox" id="c-37957037" checked=""/><div class="controls bullet"><span class="by">ndriscoll</span><span>|</span><a href="#37956830">parent</a><span>|</span><a href="#37957154">next</a><span>|</span><label class="collapse" for="c-37957037">[-]</label><label class="expand" for="c-37957037">[1 more]</label></div><br/><div class="children"><div class="content">Jabber&#x2F;XMPP has had e2e encryption for at least like 10-15 years. I used to use it with even my normie friends back when Facebook&#x2F;Google Talk supported XMPP and you could use pidgin, kopete, etc.<p>Obviously securely exchanging keys with an anonymous drug dealer over the Internet is error-prone though...</div><br/></div></div><div id="37957154" class="c"><input type="checkbox" id="c-37957154" checked=""/><div class="controls bullet"><span class="by">ValdikSS</span><span>|</span><a href="#37956830">parent</a><span>|</span><a href="#37957037">prev</a><span>|</span><a href="#37957597">next</a><span>|</span><label class="collapse" for="c-37957154">[-]</label><label class="expand" for="c-37957154">[1 more]</label></div><br/><div class="children"><div class="content">This mitm may be as a part of Genesis Market takedown, but it&#x27;s just out of the blue.<p><a href="https:&#x2F;&#x2F;therecord.media&#x2F;genesis-market-takedown-cybercrime" rel="nofollow noreferrer">https:&#x2F;&#x2F;therecord.media&#x2F;genesis-market-takedown-cybercrime</a></div><br/></div></div><div id="37957597" class="c"><input type="checkbox" id="c-37957597" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#37956830">parent</a><span>|</span><a href="#37957154">prev</a><span>|</span><a href="#37958146">next</a><span>|</span><label class="collapse" for="c-37957597">[-]</label><label class="expand" for="c-37957597">[6 more]</label></div><br/><div class="children"><div class="content">A second layer of encryption would help, but I don&#x27;t recommend PGP in particular.<p>If you haven&#x27;t heard, it has lots of problems and a lot of people recommend avoiding it (for example <a href="https:&#x2F;&#x2F;www.latacora.com&#x2F;blog&#x2F;2019&#x2F;07&#x2F;16&#x2F;the-pgp-problem&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.latacora.com&#x2F;blog&#x2F;2019&#x2F;07&#x2F;16&#x2F;the-pgp-problem&#x2F;</a> &#x2F;  <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=20455780">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=20455780</a>)</div><br/><div id="37957938" class="c"><input type="checkbox" id="c-37957938" checked=""/><div class="controls bullet"><span class="by">upofadown</span><span>|</span><a href="#37956830">root</a><span>|</span><a href="#37957597">parent</a><span>|</span><a href="#37958340">next</a><span>|</span><label class="collapse" for="c-37957938">[-]</label><label class="expand" for="c-37957938">[2 more]</label></div><br/><div class="children"><div class="content">&quot;The PGP Problem&quot; is generally misleading and is straight out wrong in some places. I ended up writing an article to save time:<p>* <a href="https:&#x2F;&#x2F;articles.59.ca&#x2F;doku.php?id=pgpfan:tpp" rel="nofollow noreferrer">https:&#x2F;&#x2F;articles.59.ca&#x2F;doku.php?id=pgpfan:tpp</a><p>PGP certainly has its problems, but isn&#x27;t really special compared to other similar things. The big advantage that PGP has is that it is a stable and well known standard. There is a tendency to imply that it is insecure in some way, but no real evidence seems to exist to that effect.</div><br/><div id="37962917" class="c"><input type="checkbox" id="c-37962917" checked=""/><div class="controls bullet"><span class="by">theamk</span><span>|</span><a href="#37956830">root</a><span>|</span><a href="#37957938">parent</a><span>|</span><a href="#37958340">next</a><span>|</span><label class="collapse" for="c-37962917">[-]</label><label class="expand" for="c-37962917">[1 more]</label></div><br/><div class="children"><div class="content">&gt; isn&#x27;t really special compared to other similar things.<p>If you define &quot;similar thing&quot; as &quot;kitchen-sink thing that tries to do everything like PGP does&quot;, then this is true, as no full alternatives exist, nor should they.<p>But for all practical applications? Pretty much every &quot;other similar thing&quot; that I have tried is _vastly_ more simple and more reliable and easier to debug and infinitely easier to script. For example, &quot;seccure&quot;, &quot;minisign&quot;, &quot;age&quot;, even &quot;ssh-keygen -Y&quot;. Especially cool are &quot;seccure&quot; which uses passphrases as private keys (no more private key files ever!) and &quot;ssh-keygen -Y&quot; which uses ssh keys which everyone already has anyway.<p>If you are writing a new software and thinking about integrating PGP, do yourself a favor and look for alternatives. If this is something developer-oriented, I recommend using something based on SSH keys, like git does.</div><br/></div></div></div></div><div id="37958340" class="c"><input type="checkbox" id="c-37958340" checked=""/><div class="controls bullet"><span class="by">alwayslikethis</span><span>|</span><a href="#37956830">root</a><span>|</span><a href="#37957597">parent</a><span>|</span><a href="#37957938">prev</a><span>|</span><a href="#37958146">next</a><span>|</span><label class="collapse" for="c-37958340">[-]</label><label class="expand" for="c-37958340">[3 more]</label></div><br/><div class="children"><div class="content">Most clients also support OMEMO now</div><br/><div id="37962703" class="c"><input type="checkbox" id="c-37962703" checked=""/><div class="controls bullet"><span class="by">kitkat_new</span><span>|</span><a href="#37956830">root</a><span>|</span><a href="#37958340">parent</a><span>|</span><a href="#37958146">next</a><span>|</span><label class="collapse" for="c-37962703">[-]</label><label class="expand" for="c-37962703">[2 more]</label></div><br/><div class="children"><div class="content">doesn&#x27;t OMEMO have the problem that you have to verify every session from all your sessions, which is practically infeasible?</div><br/><div id="37964376" class="c"><input type="checkbox" id="c-37964376" checked=""/><div class="controls bullet"><span class="by">nicoco</span><span>|</span><a href="#37956830">root</a><span>|</span><a href="#37962703">parent</a><span>|</span><a href="#37958146">next</a><span>|</span><label class="collapse" for="c-37964376">[-]</label><label class="expand" for="c-37964376">[1 more]</label></div><br/><div class="children"><div class="content">If you are serious about needing e2ee, using few sessions (well, devices) and actually verifying fingerprints OOB is a must, and that&#x27;s true for all E2EE methods AFAIK?</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37958146" class="c"><input type="checkbox" id="c-37958146" checked=""/><div class="controls bullet"><span class="by">Andrew_nenakhov</span><span>|</span><a href="#37956830">prev</a><span>|</span><a href="#37962553">next</a><span>|</span><label class="collapse" for="c-37958146">[-]</label><label class="expand" for="c-37958146">[6 more]</label></div><br/><div class="children"><div class="content">I wonder if there is a legal way to demand Hetzner&#x2F;Linode comments on this situation. Likely, the entity behind the interception is some government agency or police.</div><br/><div id="37958300" class="c"><input type="checkbox" id="c-37958300" checked=""/><div class="controls bullet"><span class="by">elliewithcolor</span><span>|</span><a href="#37958146">parent</a><span>|</span><a href="#37959239">next</a><span>|</span><label class="collapse" for="c-37958300">[-]</label><label class="expand" for="c-37958300">[1 more]</label></div><br/><div class="children"><div class="content">For Hetzner as German Company: If it is legal interception no. You can’t demand an answer, without going to a lawyer first.<p>On the other hand, if it is not lawful interception, I doubt Hetzner would allow it. Because that’s also against law.</div><br/></div></div><div id="37959239" class="c"><input type="checkbox" id="c-37959239" checked=""/><div class="controls bullet"><span class="by">dathinab</span><span>|</span><a href="#37958146">parent</a><span>|</span><a href="#37958300">prev</a><span>|</span><a href="#37958773">next</a><span>|</span><label class="collapse" for="c-37959239">[-]</label><label class="expand" for="c-37959239">[3 more]</label></div><br/><div class="children"><div class="content">there isn&#x27;t even any guarantee that the wiretapping was done through them instead of e.g. the carriers which pretty much in any country have since decades been forced to help with lawful wiretapping...</div><br/><div id="37961418" class="c"><input type="checkbox" id="c-37961418" checked=""/><div class="controls bullet"><span class="by">chatmasta</span><span>|</span><a href="#37958146">root</a><span>|</span><a href="#37959239">parent</a><span>|</span><a href="#37963339">next</a><span>|</span><label class="collapse" for="c-37961418">[-]</label><label class="expand" for="c-37961418">[1 more]</label></div><br/><div class="children"><div class="content">Carriers meaning the interconnect providers eg Level3, Cogent etc? How would this intercept be implemented in practice? Surely it&#x27;d be much easier to add a node as close as possible to the origin host, i.e. within the Hetzner network, rather than redirecting traffic from the outside with some sort of BGP hijack?</div><br/></div></div><div id="37963339" class="c"><input type="checkbox" id="c-37963339" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37958146">root</a><span>|</span><a href="#37959239">parent</a><span>|</span><a href="#37961418">prev</a><span>|</span><a href="#37958773">next</a><span>|</span><label class="collapse" for="c-37963339">[-]</label><label class="expand" for="c-37963339">[1 more]</label></div><br/><div class="children"><div class="content">I think the observed TTL 64 means the interceptor is on the same segment? (of course unless they have set it to e.g. 66 at the interceptor that is 2 hops away, but I guess if they were to mangle TTL, they would set it to the original value to avoid detection)</div><br/></div></div></div></div></div></div><div id="37962553" class="c"><input type="checkbox" id="c-37962553" checked=""/><div class="controls bullet"><span class="by">whytevuhuni</span><span>|</span><a href="#37958146">prev</a><span>|</span><a href="#37957612">next</a><span>|</span><label class="collapse" for="c-37962553">[-]</label><label class="expand" for="c-37962553">[3 more]</label></div><br/><div class="children"><div class="content">Could this be a blue pill attack? A vulnerability in the xmpp server exploited to inject a rootkit, which then hides itself inside the kernel?<p>Or creates network&#x2F;pid namespaces and puts you in them, while leaving the mitm server in the original one?<p>If so, the mitm could be on the same host, and wouldn&#x27;t need the cooperation of the hosting provider.<p>I&#x27;m not sure how to check for either of these without restarting (which the admin does not seem to want to do, as it is a live service).<p><a href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Blue_Pill_(software)" rel="nofollow noreferrer">https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Blue_Pill_(software)</a></div><br/><div id="37962564" class="c"><input type="checkbox" id="c-37962564" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962553">parent</a><span>|</span><a href="#37957612">next</a><span>|</span><label class="collapse" for="c-37962564">[-]</label><label class="expand" for="c-37962564">[2 more]</label></div><br/><div class="children"><div class="content">No because traffic redirection occured in provider&#x27;s infrastructure, not on a server.</div><br/><div id="37962647" class="c"><input type="checkbox" id="c-37962647" checked=""/><div class="controls bullet"><span class="by">whytevuhuni</span><span>|</span><a href="#37962553">root</a><span>|</span><a href="#37962564">parent</a><span>|</span><a href="#37957612">next</a><span>|</span><label class="collapse" for="c-37962647">[-]</label><label class="expand" for="c-37962647">[1 more]</label></div><br/><div class="children"><div class="content">Let&#x27;s say you are blue-pilled and what you see as your eth0 interface is actually a virtual interface controlled by the rootkit.<p>In that case, where the redirection happened is no longer something you would be able to tell, right?</div><br/></div></div></div></div></div></div><div id="37957612" class="c"><input type="checkbox" id="c-37957612" checked=""/><div class="controls bullet"><span class="by">beeboobaa</span><span>|</span><a href="#37962553">prev</a><span>|</span><a href="#37956858">next</a><span>|</span><label class="collapse" for="c-37957612">[-]</label><label class="expand" for="c-37957612">[18 more]</label></div><br/><div class="children"><div class="content">Are there any services that monitor the certificate transparency logs and send an email when a new certificate is issued for your domain? That would alert you to this kind of MITM</div><br/><div id="37958004" class="c"><input type="checkbox" id="c-37958004" checked=""/><div class="controls bullet"><span class="by">jpalomaki</span><span>|</span><a href="#37957612">parent</a><span>|</span><a href="#37957663">next</a><span>|</span><label class="collapse" for="c-37958004">[-]</label><label class="expand" for="c-37958004">[3 more]</label></div><br/><div class="children"><div class="content">As mentioned there are services for doing this (I&#x27;ve been using for example the free service from Facebook [1])<p>Since the certificates are nowadays renewing quite often, it&#x27;s very easy to just end up ignoring these notifications. To really get the benefits, I think you should somehow combine these with logs from the legit cert renewals and only alert when something strange pops up.<p>[1] <a href="https:&#x2F;&#x2F;developers.facebook.com&#x2F;tools&#x2F;ct&#x2F;search&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;developers.facebook.com&#x2F;tools&#x2F;ct&#x2F;search&#x2F;</a></div><br/><div id="37958471" class="c"><input type="checkbox" id="c-37958471" checked=""/><div class="controls bullet"><span class="by">agwa</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37958004">parent</a><span>|</span><a href="#37957663">next</a><span>|</span><label class="collapse" for="c-37958471">[-]</label><label class="expand" for="c-37958471">[2 more]</label></div><br/><div class="children"><div class="content">Indeed, a CT monitor which sends alerts about legitimate certificates is almost useless due to noise.  My service, Cert Spotter, provides an API endpoint[1] which you can upload your CSRs to, so you don&#x27;t get alerted about certificates using the same key as the CSR.  The open source version of Cert Spotter can invoke a script[2] when a certificate is discovered, and the script can cross reference against a list of legitimate certs.<p>[1] <a href="https:&#x2F;&#x2F;sslmate.com&#x2F;help&#x2F;reference&#x2F;certspotter_authorization_api" rel="nofollow noreferrer">https:&#x2F;&#x2F;sslmate.com&#x2F;help&#x2F;reference&#x2F;certspotter_authorization...</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;SSLMate&#x2F;certspotter&#x2F;blob&#x2F;master&#x2F;man&#x2F;certspotter-script.md">https:&#x2F;&#x2F;github.com&#x2F;SSLMate&#x2F;certspotter&#x2F;blob&#x2F;master&#x2F;man&#x2F;certs...</a></div><br/><div id="37964647" class="c"><input type="checkbox" id="c-37964647" checked=""/><div class="controls bullet"><span class="by">tehlike</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37958471">parent</a><span>|</span><a href="#37957663">next</a><span>|</span><label class="collapse" for="c-37964647">[-]</label><label class="expand" for="c-37964647">[1 more]</label></div><br/><div class="children"><div class="content">Could it check against public key for the certificate?</div><br/></div></div></div></div></div></div><div id="37957663" class="c"><input type="checkbox" id="c-37957663" checked=""/><div class="controls bullet"><span class="by">tptacek</span><span>|</span><a href="#37957612">parent</a><span>|</span><a href="#37958004">prev</a><span>|</span><a href="#37957918">next</a><span>|</span><label class="collapse" for="c-37957663">[-]</label><label class="expand" for="c-37957663">[1 more]</label></div><br/><div class="children"><div class="content">Yes. Several. They&#x27;re called CT &quot;Monitors&quot;.</div><br/></div></div><div id="37957918" class="c"><input type="checkbox" id="c-37957918" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37957612">parent</a><span>|</span><a href="#37957663">prev</a><span>|</span><a href="#37957659">next</a><span>|</span><label class="collapse" for="c-37957918">[-]</label><label class="expand" for="c-37957918">[6 more]</label></div><br/><div class="children"><div class="content">There are but this assumes that services like the transparency log servers and LetsEncrypt are not being legally compelled to do or not do something.</div><br/><div id="37958552" class="c"><input type="checkbox" id="c-37958552" checked=""/><div class="controls bullet"><span class="by">agwa</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37957918">parent</a><span>|</span><a href="#37957659">next</a><span>|</span><label class="collapse" for="c-37958552">[-]</label><label class="expand" for="c-37958552">[5 more]</label></div><br/><div class="children"><div class="content">If the CA doesn&#x27;t log a certificate, the certificate won&#x27;t work in CT-enforcing clients (Chrome, Safari, Edge) because it lacks receipts (SCTs) from CT logs.<p>If a log fails to publish a certificate despite issuing a receipt for it, Chrome&#x27;s SCT auditing infrastructure can detect that, as it did recently with the Nessie 2023 log: <a href="https:&#x2F;&#x2F;groups.google.com&#x2F;a&#x2F;chromium.org&#x2F;g&#x2F;ct-policy&#x2F;c&#x2F;5x1A61F9y4s" rel="nofollow noreferrer">https:&#x2F;&#x2F;groups.google.com&#x2F;a&#x2F;chromium.org&#x2F;g&#x2F;ct-policy&#x2F;c&#x2F;5x1A6...</a> (this was also detected by monitors operated by myself and Cloudflare)<p>But this is all moot when it comes to XMPP, since XMPP clients don&#x27;t check for SCTs, and there is no requirement for CAs to log certificates if they don&#x27;t need to work in non-CT-enforcing clients. Some CAs (e.g. DigiCert) will sell you unlogged certificates - no need to compel them.<p>tldr: situation is good and improving with browsers, not so much with non-browser clients</div><br/><div id="37958956" class="c"><input type="checkbox" id="c-37958956" checked=""/><div class="controls bullet"><span class="by">MattJ100</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37958552">parent</a><span>|</span><a href="#37957659">next</a><span>|</span><label class="collapse" for="c-37958956">[-]</label><label class="expand" for="c-37958956">[4 more]</label></div><br/><div class="children"><div class="content">XMPP has some adoption of channel binding (it could be better, but it&#x27;s heading in the right direction) which mitigates these kinds of attacks in a different way. It is able to do that because the client and server already share a secret (the user&#x27;s credentials), unlike most HTTP clients&#x2F;servers (at least as far as the protocol is concerned).<p>But SCT validation would indeed be something we should investigate for the ecosystem, it could be beneficial for certain use cases.</div><br/><div id="37959257" class="c"><input type="checkbox" id="c-37959257" checked=""/><div class="controls bullet"><span class="by">agwa</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37958956">parent</a><span>|</span><a href="#37957659">next</a><span>|</span><label class="collapse" for="c-37959257">[-]</label><label class="expand" for="c-37959257">[3 more]</label></div><br/><div class="children"><div class="content">It may be better for the XMPP ecosystem to focus on increasing adoption of channel binding rather than CT enforcement.  I wrote briefly about the challenges faced by non-browser clients at &lt;<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36436303">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=36436303</a>&gt; but the tldr is that all SCT-checking clients have to be able to respond to ecosystem changes very quickly. This is so important that Chrome and Safari both disable SCT checking entirely if the browser hasn&#x27;t been updated in more than 10 weeks.<p>Feel free to contact me (email in profile) or ask here if you want to talk more about this.  I use XMPP (thank you for Prosody!) and have been involved in the CT space for many years now.</div><br/><div id="37959733" class="c"><input type="checkbox" id="c-37959733" checked=""/><div class="controls bullet"><span class="by">aaomidi</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37959257">parent</a><span>|</span><a href="#37957659">next</a><span>|</span><label class="collapse" for="c-37959733">[-]</label><label class="expand" for="c-37959733">[2 more]</label></div><br/><div class="children"><div class="content">&gt; but the tldr is that all SCT-checking clients have to be able to respond to ecosystem changes very quickly.<p>This is fine. If you&#x27;re using a tool that&#x27;s connecting to the internet, you probably need to monitor for updates anyway.<p>I&#x27;d like to see a separate package, similar to Mozilla&#x27;s `ca-certificates`, but for CT that can be updated independently of the actual useragent.</div><br/><div id="37959907" class="c"><input type="checkbox" id="c-37959907" checked=""/><div class="controls bullet"><span class="by">agwa</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37959733">parent</a><span>|</span><a href="#37957659">next</a><span>|</span><label class="collapse" for="c-37959907">[-]</label><label class="expand" for="c-37959907">[1 more]</label></div><br/><div class="children"><div class="content">&gt; <i>This is fine. If you&#x27;re using a tool that&#x27;s connecting to the internet, you probably need to monitor for updates anyway.</i><p>People <i>should</i> do this, but in practice it often doesn&#x27;t happen - as witnessed by the Appmattus library fiasco earlier this year.<p>&gt; <i>I&#x27;d like to see a separate package, similar to Mozilla&#x27;s `ca-certificates`, but for CT that can be updated independently of the actual useragent.</i><p>Considering how slowly updates to the various ca-certificates packages propagate, this would be absolute disaster for CT.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="37957659" class="c"><input type="checkbox" id="c-37957659" checked=""/><div class="controls bullet"><span class="by">jauntywundrkind</span><span>|</span><a href="#37957612">parent</a><span>|</span><a href="#37957918">prev</a><span>|</span><a href="#37957675">next</a><span>|</span><label class="collapse" for="c-37957659">[-]</label><label class="expand" for="c-37957659">[4 more]</label></div><br/><div class="children"><div class="content">&gt; <i>Could you prevent or monitor this kind of attack?
There are several indications which could be used to discover the attack from day 1:</i><p>&gt; <i>All issued SSL&#x2F;TLS certificates are subject to certificate transparency. It is worth configuring certificate transparency monitoring, such as Cert Spotter (source on github), which will notify you by email of new certificates issued for your domain names</i></div><br/><div id="37957871" class="c"><input type="checkbox" id="c-37957871" checked=""/><div class="controls bullet"><span class="by">johnmaguire</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37957659">parent</a><span>|</span><a href="#37957675">next</a><span>|</span><label class="collapse" for="c-37957871">[-]</label><label class="expand" for="c-37957871">[3 more]</label></div><br/><div class="children"><div class="content">&gt; All issued SSL&#x2F;TLS certificates are subject to certificate transparency. It is worth configuring certificate transparency monitoring, such as Cert Spotter (source on github), which will notify you by email of new certificates issued for your domain names<p>This seems like the kind of thing domain registrars should do for you.</div><br/><div id="37957976" class="c"><input type="checkbox" id="c-37957976" checked=""/><div class="controls bullet"><span class="by">Operyl</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37957871">parent</a><span>|</span><a href="#37957675">next</a><span>|</span><label class="collapse" for="c-37957976">[-]</label><label class="expand" for="c-37957976">[2 more]</label></div><br/><div class="children"><div class="content">Who could in theory also be told “don’t notify your client about this specific one”. You’re best off self hosting if you think you’d be a target for these kind of attacks.</div><br/><div id="37959643" class="c"><input type="checkbox" id="c-37959643" checked=""/><div class="controls bullet"><span class="by">ratsmack</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37957976">parent</a><span>|</span><a href="#37957675">next</a><span>|</span><label class="collapse" for="c-37959643">[-]</label><label class="expand" for="c-37959643">[1 more]</label></div><br/><div class="children"><div class="content">It seems that trust is a highly variable quantity, maybe similar to intuition.</div><br/></div></div></div></div></div></div></div></div><div id="37957675" class="c"><input type="checkbox" id="c-37957675" checked=""/><div class="controls bullet"><span class="by">f311a</span><span>|</span><a href="#37957612">parent</a><span>|</span><a href="#37957659">prev</a><span>|</span><a href="#37957885">next</a><span>|</span><label class="collapse" for="c-37957675">[-]</label><label class="expand" for="c-37957675">[2 more]</label></div><br/><div class="children"><div class="content">Cloudflare does that</div><br/><div id="37958242" class="c"><input type="checkbox" id="c-37958242" checked=""/><div class="controls bullet"><span class="by">L29Ah</span><span>|</span><a href="#37957612">root</a><span>|</span><a href="#37957675">parent</a><span>|</span><a href="#37957885">next</a><span>|</span><label class="collapse" for="c-37958242">[-]</label><label class="expand" for="c-37958242">[1 more]</label></div><br/><div class="children"><div class="content">Cloudflare is a MITM you voluntarily setup yourself, innit?</div><br/></div></div></div></div><div id="37957885" class="c"><input type="checkbox" id="c-37957885" checked=""/><div class="controls bullet"><span class="by">detourdog</span><span>|</span><a href="#37957612">parent</a><span>|</span><a href="#37957675">prev</a><span>|</span><a href="#37956858">next</a><span>|</span><label class="collapse" for="c-37957885">[-]</label><label class="expand" for="c-37957885">[1 more]</label></div><br/><div class="children"><div class="content">Kerberos right?</div><br/></div></div></div></div><div id="37956858" class="c"><input type="checkbox" id="c-37956858" checked=""/><div class="controls bullet"><span class="by">zhovner</span><span>|</span><a href="#37957612">prev</a><span>|</span><a href="#37957889">next</a><span>|</span><label class="collapse" for="c-37956858">[-]</label><label class="expand" for="c-37956858">[11 more]</label></div><br/><div class="children"><div class="content">&gt;The attacker managed to issue multiple SSL&#x2F;TLS certificates via Let’s Encrypt for jabber.ru and xmpp.ru domains since 18 Apr 2023<p>Why is it even possible to issue more than 1 certificate on the same domain via Let’s Encrypt? Shouldn&#x27;t the previous certificate be revoked when a new one is issued?</div><br/><div id="37956953" class="c"><input type="checkbox" id="c-37956953" checked=""/><div class="controls bullet"><span class="by">MattJ100</span><span>|</span><a href="#37956858">parent</a><span>|</span><a href="#37959448">next</a><span>|</span><label class="collapse" for="c-37956953">[-]</label><label class="expand" for="c-37956953">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s fairly common for people to obtain multiple certificates for different machines or services, so they can be selectively revoked and they don&#x27;t have to share keys across machines.<p>More use-cases:<p>- You might obtain a new certificate, but deploy it gradually, so you want the old one to remain valid while you do that.<p>- One certificate may cover different sets of domain names. If you have a certificate for &quot;example.com, foo.example.com&quot; and then request a certificate for only &quot;foo.example.com&quot;, should the earlier one be revoked? (leaving &quot;example.com&quot; without a certificate).</div><br/></div></div><div id="37959448" class="c"><input type="checkbox" id="c-37959448" checked=""/><div class="controls bullet"><span class="by">dathinab</span><span>|</span><a href="#37956858">parent</a><span>|</span><a href="#37956953">prev</a><span>|</span><a href="#37962808">next</a><span>|</span><label class="collapse" for="c-37959448">[-]</label><label class="expand" for="c-37959448">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Why is it even possible to issue more than 1 certificate on the same domain via Let’s Encrypt?<p>it commonly used in a &quot;normal&quot; way all the time<p>- e.g. when there are multiple data-center for the same domain (e.g. using geo-location based routing) it&#x27;s a good practice to give them different certs so that if you need to revoke one the operation in other regions is unaffected<p>- or when rolling over from on cert to another<p>- or when moving certs into hardware security keys&#x2F;module (HSK) you preferably do have one per HSK (so that if e.g. hardware breaks and gets replaced you can just revoce the cert for the affected HSK module not all of them), you also normaly do not keep backups to make sure it can&#x27;t be leaked at all (as long as the HSK isn&#x27;t hacked which is normally quite hard)<p>- or losing access to a cert (e.g. in the case above a HSK breaks)<p>Lastly the whole CA system is in the end designed to provide good security for the industry while having the backdoor of issuing certs the legal organs to allow the police some degree of wiretapping (oversimplified, it&#x27;s slightly more complex then that).</div><br/></div></div><div id="37962808" class="c"><input type="checkbox" id="c-37962808" checked=""/><div class="controls bullet"><span class="by">silverwind</span><span>|</span><a href="#37956858">parent</a><span>|</span><a href="#37959448">prev</a><span>|</span><a href="#37961532">next</a><span>|</span><label class="collapse" for="c-37962808">[-]</label><label class="expand" for="c-37962808">[2 more]</label></div><br/><div class="children"><div class="content">This is actually a great suggestion and ACME providers should provide it as an opt-in feature via CAA record. Not even the provider having access to system memory could issue a mitm cert without you noticing.</div><br/><div id="37963373" class="c"><input type="checkbox" id="c-37963373" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37956858">root</a><span>|</span><a href="#37962808">parent</a><span>|</span><a href="#37961532">next</a><span>|</span><label class="collapse" for="c-37963373">[-]</label><label class="expand" for="c-37963373">[1 more]</label></div><br/><div class="children"><div class="content">The provider having access to system memory can copy the private key and use your original key+cert for MITM, unless you are using some fancy HSM.</div><br/></div></div></div></div><div id="37961532" class="c"><input type="checkbox" id="c-37961532" checked=""/><div class="controls bullet"><span class="by">ilyt</span><span>|</span><a href="#37956858">parent</a><span>|</span><a href="#37962808">prev</a><span>|</span><a href="#37957040">next</a><span>|</span><label class="collapse" for="c-37961532">[-]</label><label class="expand" for="c-37961532">[1 more]</label></div><br/><div class="children"><div class="content">&gt; Why is it even possible to issue more than 1 certificate on the same domain via Let’s Encrypt? Shouldn&#x27;t the previous certificate be revoked when a new one is issued?<p>First, you want to have to have some leeway so you don&#x27;t need to rotate certs at exact second the old one expires<p>Second, you might want to have cert-per-server rather than cert-per-domain, as that&#x27;s frankly easier to implement vs having common store for certs+key</div><br/></div></div><div id="37957040" class="c"><input type="checkbox" id="c-37957040" checked=""/><div class="controls bullet"><span class="by">aaomidi</span><span>|</span><a href="#37956858">parent</a><span>|</span><a href="#37961532">prev</a><span>|</span><a href="#37957276">next</a><span>|</span><label class="collapse" for="c-37957040">[-]</label><label class="expand" for="c-37957040">[1 more]</label></div><br/><div class="children"><div class="content">You should always have more than a single certificate for your domain honestly.<p>Cloudflare for example, tries to optimize certificate delivery (and have backup certificates available for you just in case a CA needs to revoke theirs).<p>Also, on distributed systems its less safe to share private keys between the various frontends.</div><br/></div></div><div id="37957276" class="c"><input type="checkbox" id="c-37957276" checked=""/><div class="controls bullet"><span class="by">blibble</span><span>|</span><a href="#37956858">parent</a><span>|</span><a href="#37957040">prev</a><span>|</span><a href="#37957889">next</a><span>|</span><label class="collapse" for="c-37957276">[-]</label><label class="expand" for="c-37957276">[4 more]</label></div><br/><div class="children"><div class="content">provisioning a 2nd machine into your webserver cluster before activating it?</div><br/><div id="37959129" class="c"><input type="checkbox" id="c-37959129" checked=""/><div class="controls bullet"><span class="by">KMag</span><span>|</span><a href="#37956858">root</a><span>|</span><a href="#37957276">parent</a><span>|</span><a href="#37957889">next</a><span>|</span><label class="collapse" for="c-37959129">[-]</label><label class="expand" for="c-37959129">[3 more]</label></div><br/><div class="children"><div class="content">You could sync certificates across hosts for this purpose, though.  The advantage of multiple certificates is being able to revoke a subset of certificates if you can determine only a subset of your hosts have been compromised.</div><br/><div id="37959286" class="c"><input type="checkbox" id="c-37959286" checked=""/><div class="controls bullet"><span class="by">blibble</span><span>|</span><a href="#37956858">root</a><span>|</span><a href="#37959129">parent</a><span>|</span><a href="#37957889">next</a><span>|</span><label class="collapse" for="c-37959286">[-]</label><label class="expand" for="c-37959286">[2 more]</label></div><br/><div class="children"><div class="content">you could, but unfortunately the LE certs have a very short lifetime, and renewals are a thing<p>so you need a master server to handle the renewals, periodic sync, and to handle the case when the master goes away<p>this would be considerably more complicated than having a second independent certificate (assuming you&#x27;ve automated the entire frontend provisioning process)</div><br/><div id="37961544" class="c"><input type="checkbox" id="c-37961544" checked=""/><div class="controls bullet"><span class="by">ilyt</span><span>|</span><a href="#37956858">root</a><span>|</span><a href="#37959286">parent</a><span>|</span><a href="#37957889">next</a><span>|</span><label class="collapse" for="c-37961544">[-]</label><label class="expand" for="c-37961544">[1 more]</label></div><br/><div class="children"><div class="content">Did that, can confirm.<p>For other more sensible reasons  but still.</div><br/></div></div></div></div></div></div></div></div></div></div><div id="37957889" class="c"><input type="checkbox" id="c-37957889" checked=""/><div class="controls bullet"><span class="by">vb-8448</span><span>|</span><a href="#37956858">prev</a><span>|</span><a href="#37958463">next</a><span>|</span><label class="collapse" for="c-37957889">[-]</label><label class="expand" for="c-37957889">[10 more]</label></div><br/><div class="children"><div class="content">&gt; The attacker managed to issue multiple SSL&#x2F;TLS certificates via Let’s Encrypt for jabber.ru and xmpp.ru domains since 18 Apr 2023<p>&gt; We tend to assume this is lawful interception Hetzner and Linode were forced to setup based on German police request.<p>&gt; Another possible, although much more unlikely scenario is an intrusion on the internal networks of both Hetzner and Linode targeting specifically jabber.ru — much harder to believe but not entirely impossible.<p>And what if the attacker tricked somehow the letsencrypt challenges?<p>Or this is supposed to be impossible?</div><br/><div id="37958219" class="c"><input type="checkbox" id="c-37958219" checked=""/><div class="controls bullet"><span class="by">mananaysiempre</span><span>|</span><a href="#37957889">parent</a><span>|</span><a href="#37958131">next</a><span>|</span><label class="collapse" for="c-37958219">[-]</label><label class="expand" for="c-37958219">[2 more]</label></div><br/><div class="children"><div class="content">Even after obtaining certificates allowing you to MITM, you have to actually find TM you can be a MI. In a targeted attack, this could be as easy and discreet as spoofing the target’s hotel WiFi. In a country without plentiful cross-border connections or a diverse backbone, a tap in the right IX could also work. (Famously, the NSA exploited the oligopoly the major consumer ISPs have in the US. Somewhat less famously, Roskomnadzor had to embark on a multi-year boiling of the frog to make Internet censorship in Russia even remotely workable, due to the diversity of the market and of the interconnects left over from the late nineties and early oughts, culminating in a requirement for every ISP in the country to patch MITM hardware into their network.)<p>But for this kind of thing to happen on <i>every</i> connection to the server being impersonated, you either have to bring a very big and publicly noisy hammer like a BGP hijack, or have the Internet upstream of the server cooperate. If the traceroute info in the post is to be trusted, in this particular case Linode and Hetzner themselves—or perhaps their datacenter operators—seem to be performing the intercept.</div><br/><div id="37958611" class="c"><input type="checkbox" id="c-37958611" checked=""/><div class="controls bullet"><span class="by">vb-8448</span><span>|</span><a href="#37957889">root</a><span>|</span><a href="#37958219">parent</a><span>|</span><a href="#37958131">next</a><span>|</span><label class="collapse" for="c-37958611">[-]</label><label class="expand" for="c-37958611">[1 more]</label></div><br/><div class="children"><div class="content">&gt; If the traceroute info in the post is to be trusted, in this particular case Linode and Hetzner themselves—or perhaps their datacenter operators—seem to be performing the intercept.<p>Ok, now I get it.
Thanks.</div><br/></div></div></div></div><div id="37958131" class="c"><input type="checkbox" id="c-37958131" checked=""/><div class="controls bullet"><span class="by">nmjohn</span><span>|</span><a href="#37957889">parent</a><span>|</span><a href="#37958219">prev</a><span>|</span><a href="#37958129">next</a><span>|</span><label class="collapse" for="c-37958131">[-]</label><label class="expand" for="c-37958131">[2 more]</label></div><br/><div class="children"><div class="content">The attacker effectively controlled the IP the domain was pointed to. If you have this, getting a cert issued from any CA is trivial - you&#x27;ve proved to them you control the domain in question.</div><br/><div id="37962230" class="c"><input type="checkbox" id="c-37962230" checked=""/><div class="controls bullet"><span class="by">3np</span><span>|</span><a href="#37957889">root</a><span>|</span><a href="#37958131">parent</a><span>|</span><a href="#37958129">next</a><span>|</span><label class="collapse" for="c-37962230">[-]</label><label class="expand" for="c-37962230">[1 more]</label></div><br/><div class="children"><div class="content">As mentioned elsewhere in the thread, RFC 8657 can prevent this.<p><a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37958831">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37958831</a></div><br/></div></div></div></div><div id="37958129" class="c"><input type="checkbox" id="c-37958129" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#37957889">parent</a><span>|</span><a href="#37958131">prev</a><span>|</span><a href="#37959576">next</a><span>|</span><label class="collapse" for="c-37958129">[-]</label><label class="expand" for="c-37958129">[3 more]</label></div><br/><div class="children"><div class="content">If that were the case, they wouldn&#x27;t have seen weird connectivity issues&#x2F;behaviors.</div><br/><div id="37958514" class="c"><input type="checkbox" id="c-37958514" checked=""/><div class="controls bullet"><span class="by">vb-8448</span><span>|</span><a href="#37957889">root</a><span>|</span><a href="#37958129">parent</a><span>|</span><a href="#37959576">next</a><span>|</span><label class="collapse" for="c-37958514">[-]</label><label class="expand" for="c-37958514">[2 more]</label></div><br/><div class="children"><div class="content">why not? They discover the issue only because the attacker failed to renew the certificates.</div><br/><div id="37962775" class="c"><input type="checkbox" id="c-37962775" checked=""/><div class="controls bullet"><span class="by">janosdebugs</span><span>|</span><a href="#37957889">root</a><span>|</span><a href="#37958514">parent</a><span>|</span><a href="#37959576">next</a><span>|</span><label class="collapse" for="c-37962775">[-]</label><label class="expand" for="c-37962775">[1 more]</label></div><br/><div class="children"><div class="content">Yeah, but just getting a hold of a valid certificate doesn&#x27;t automatically mean a MITM. For that the network connections need to be intercepted too.</div><br/></div></div></div></div></div></div><div id="37959576" class="c"><input type="checkbox" id="c-37959576" checked=""/><div class="controls bullet"><span class="by">stefan_</span><span>|</span><a href="#37957889">parent</a><span>|</span><a href="#37958129">prev</a><span>|</span><a href="#37958463">next</a><span>|</span><label class="collapse" for="c-37959576">[-]</label><label class="expand" for="c-37959576">[2 more]</label></div><br/><div class="children"><div class="content">They don&#x27;t need to, they controlled the domain IP and trivially got the certificates. This is not a novel technique, see this Twitter thread:<p><a href="https:&#x2F;&#x2F;twitter.com&#x2F;billmarczak&#x2F;status&#x2F;1710348549794185279" rel="nofollow noreferrer">https:&#x2F;&#x2F;twitter.com&#x2F;billmarczak&#x2F;status&#x2F;1710348549794185279</a><p>We need to go back to snail mail or something, this whole .well-known thing just stinks. We added layers on top like CT and while sound ideas, they don&#x27;t tend to do anything unless you are Google or FB.<p>&gt; Yes, the fraudulent certificate is memorialized in Certificate Transparency (CT) databases (the indelible, publicly accessible records of ~all issued TLS certs). But, most website owners don&#x27;t know what CT is, have no idea how to check it, and wouldn’t know what the results meant</div><br/><div id="37959700" class="c"><input type="checkbox" id="c-37959700" checked=""/><div class="controls bullet"><span class="by">aaomidi</span><span>|</span><a href="#37957889">root</a><span>|</span><a href="#37959576">parent</a><span>|</span><a href="#37958463">next</a><span>|</span><label class="collapse" for="c-37959700">[-]</label><label class="expand" for="c-37959700">[1 more]</label></div><br/><div class="children"><div class="content">CAA account binding is the response to this.</div><br/></div></div></div></div></div></div><div id="37958463" class="c"><input type="checkbox" id="c-37958463" checked=""/><div class="controls bullet"><span class="by">wutwutwat</span><span>|</span><a href="#37957889">prev</a><span>|</span><a href="#37962344">next</a><span>|</span><label class="collapse" for="c-37958463">[-]</label><label class="expand" for="c-37958463">[3 more]</label></div><br/><div class="children"><div class="content">As an end user, how can I monitor if I’m being MITM’d? If everything I do is proxied through an attacker’s network, nothing I do online could be trusted to properly test if I were being proxied, right? I know apps can do cert pinning, but as an end user how can I validate that when connect to anything that it’s the real one and not a request from being middled?</div><br/><div id="37961921" class="c"><input type="checkbox" id="c-37961921" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37958463">parent</a><span>|</span><a href="#37962519">next</a><span>|</span><label class="collapse" for="c-37961921">[-]</label><label class="expand" for="c-37961921">[1 more]</label></div><br/><div class="children"><div class="content">One can get fingerprints of TLS endpoints ahead of time and&#x2F;or from a known clean network then compare and contrast to what you see from the location you suspect might be MITM&#x27;d.  I believe there are browser addons that display certificate fingerprints and alert if a certificate changes however one can click on the lock symbol and drill down to the same info.<p><pre><code>    openssl s_client -servername news.ycombinator.com -connect news.ycombinator.com:443 &lt; &#x2F;dev&#x2F;null 2&gt;&#x2F;dev&#x2F;null | openssl x509 -fingerprint -noout -in &#x2F;dev&#x2F;stdin
    SHA1 Fingerprint=7E:49:BA:40:86:87:B3:39:66:93:94:9E:9C:45:71:85:3C:8D:95:16
</code></pre>
A higher friction method would be to use a browser addon that would pin a certificate to a site.  Not useful in the case of the Jabber client but useful if one was visiting Jabbers website to validate something.  Some Jabber clients and servers have their own method described in another part of this thread [1] to protect against interception.<p>The openssl s_client method is likely the most versatile for testing from different locations, ports and applications.<p>[1] - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37956911">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37956911</a></div><br/></div></div><div id="37962519" class="c"><input type="checkbox" id="c-37962519" checked=""/><div class="controls bullet"><span class="by">polski-g</span><span>|</span><a href="#37958463">parent</a><span>|</span><a href="#37961921">prev</a><span>|</span><a href="#37962344">next</a><span>|</span><label class="collapse" for="c-37962519">[-]</label><label class="expand" for="c-37962519">[1 more]</label></div><br/><div class="children"><div class="content"><a href="https:&#x2F;&#x2F;github.com&#x2F;matteocorti&#x2F;check_ssl_cert">https:&#x2F;&#x2F;github.com&#x2F;matteocorti&#x2F;check_ssl_cert</a></div><br/></div></div></div></div><div id="37962344" class="c"><input type="checkbox" id="c-37962344" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37958463">prev</a><span>|</span><a href="#37962975">next</a><span>|</span><label class="collapse" for="c-37962344">[-]</label><label class="expand" for="c-37962344">[15 more]</label></div><br/><div class="children"><div class="content">Wouldn&#x27;t be surprised if this happened in Russia; but not in Europe. Also, Let&#x27;s Encrypt security is a joke - they issued fake certificate without serious checking. Using unencrypted HTTP for confirmation is a vulnerability - doesn&#x27;t this mean that large national ISPs can easily issue ceritificates for any site hosted within a country?</div><br/><div id="37962405" class="c"><input type="checkbox" id="c-37962405" checked=""/><div class="controls bullet"><span class="by">ItsABytecode</span><span>|</span><a href="#37962344">parent</a><span>|</span><a href="#37962401">next</a><span>|</span><label class="collapse" for="c-37962405">[-]</label><label class="expand" for="c-37962405">[13 more]</label></div><br/><div class="children"><div class="content">&gt; Also, Let&#x27;s Encrypt security is a joke - they issued fake certificate without serious checking. Using unencrypted HTTP for confirmation is a vulnerability<p>They can’t use HTTPS if you don’t have a certificate yet</div><br/><div id="37962409" class="c"><input type="checkbox" id="c-37962409" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962405">parent</a><span>|</span><a href="#37962401">next</a><span>|</span><label class="collapse" for="c-37962409">[-]</label><label class="expand" for="c-37962409">[12 more]</label></div><br/><div class="children"><div class="content">This doesn&#x27;t mean you should use unsecure methods instead and issue certificates to anyone capable to do MitM.</div><br/><div id="37962438" class="c"><input type="checkbox" id="c-37962438" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962409">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962438">[-]</label><label class="expand" for="c-37962438">[8 more]</label></div><br/><div class="children"><div class="content">How could Letsencrypt even verify a server setup if not via DNS&#x2F;HTTP? Also, verify against what? The servers are basically random strangers without identity when they first talk to LE.</div><br/><div id="37962461" class="c"><input type="checkbox" id="c-37962461" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962438">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962461">[-]</label><label class="expand" for="c-37962461">[7 more]</label></div><br/><div class="children"><div class="content">In this case there has been a valid certificate for the site; this alone should raise suspicion.<p>Also, if they cannot do secure validation then maybe they should stop issuing certificates for sites that already have a proper certificate.</div><br/><div id="37962471" class="c"><input type="checkbox" id="c-37962471" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962461">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962471">[-]</label><label class="expand" for="c-37962471">[6 more]</label></div><br/><div class="children"><div class="content">This happens all the time when a server is rebuilt from scratch - same cert using a different keypair.</div><br/><div id="37962520" class="c"><input type="checkbox" id="c-37962520" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962471">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962520">[-]</label><label class="expand" for="c-37962520">[5 more]</label></div><br/><div class="children"><div class="content">So should we conclude that SSL cert infrastructure is completely compromised and now any country can issue fake certificates?</div><br/><div id="37962547" class="c"><input type="checkbox" id="c-37962547" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962520">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962547">[-]</label><label class="expand" for="c-37962547">[4 more]</label></div><br/><div class="children"><div class="content">No, there is no reason to jump to such extremes.</div><br/><div id="37962821" class="c"><input type="checkbox" id="c-37962821" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962547">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962821">[-]</label><label class="expand" for="c-37962821">[3 more]</label></div><br/><div class="children"><div class="content">There are approximately 10 Tier-1 ISPs through which majority of Internet traffic passes, and unless I misunderstood something, they can issue valid certificates for almost any domain. To me it looks like &quot;completely compromised&quot;.</div><br/><div id="37962838" class="c"><input type="checkbox" id="c-37962838" checked=""/><div class="controls bullet"><span class="by">blueflow</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962821">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37962838">[-]</label><label class="expand" for="c-37962838">[2 more]</label></div><br/><div class="children"><div class="content">Every CA can issue valid certificates for every domain? And it always has been that way.</div><br/><div id="37963135" class="c"><input type="checkbox" id="c-37963135" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962838">parent</a><span>|</span><a href="#37962514">next</a><span>|</span><label class="collapse" for="c-37963135">[-]</label><label class="expand" for="c-37963135">[1 more]</label></div><br/><div class="children"><div class="content">CA has a risk to get their root cert removed from browsers; ISP doesn&#x27;t risk anything especially when asked by the govt.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="37962514" class="c"><input type="checkbox" id="c-37962514" checked=""/><div class="controls bullet"><span class="by">sigio</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962409">parent</a><span>|</span><a href="#37962438">prev</a><span>|</span><a href="#37962401">next</a><span>|</span><label class="collapse" for="c-37962514">[-]</label><label class="expand" for="c-37962514">[3 more]</label></div><br/><div class="children"><div class="content">This is exactly the same as all other CA&#x27;s do this.... for DV-certificates you basically place a key&#x2F;special file on the webserver, or receive a verficiation code via (plaintext) email.<p>For EV certs there might be more validation, but users will never see the difference between EV and DV certificates.</div><br/><div id="37962549" class="c"><input type="checkbox" id="c-37962549" checked=""/><div class="controls bullet"><span class="by">codedokode</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962514">parent</a><span>|</span><a href="#37962401">next</a><span>|</span><label class="collapse" for="c-37962549">[-]</label><label class="expand" for="c-37962549">[2 more]</label></div><br/><div class="children"><div class="content">So SSL certificates are completely unreliable; we should only wait until Russian or Chinese comrades find a good use for this attack (e.g. temporary redirecting Western traffic using BGP to validate a Let&#x27;s Encrypt&#x27;s cert for Western site).</div><br/><div id="37962596" class="c"><input type="checkbox" id="c-37962596" checked=""/><div class="controls bullet"><span class="by">bananapub</span><span>|</span><a href="#37962344">root</a><span>|</span><a href="#37962549">parent</a><span>|</span><a href="#37962401">next</a><span>|</span><label class="collapse" for="c-37962596">[-]</label><label class="expand" for="c-37962596">[1 more]</label></div><br/><div class="children"><div class="content">yes?  this is a well-known problem, which is why CAA-ACME etc and certificate transparency logs exist.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div><div id="37962975" class="c"><input type="checkbox" id="c-37962975" checked=""/><div class="controls bullet"><span class="by">mrbonner</span><span>|</span><a href="#37962344">prev</a><span>|</span><a href="#37964328">next</a><span>|</span><label class="collapse" for="c-37962975">[-]</label><label class="expand" for="c-37962975">[1 more]</label></div><br/><div class="children"><div class="content">I’m wondering if mTLS (aka zero-trust) is used, would take prevent this kind of MITM attack? My understanding is that it should since the cert is self-signed to be used from both ends.</div><br/></div></div><div id="37964328" class="c"><input type="checkbox" id="c-37964328" checked=""/><div class="controls bullet"><span class="by">snvzz</span><span>|</span><a href="#37962975">prev</a><span>|</span><a href="#37958447">next</a><span>|</span><label class="collapse" for="c-37964328">[-]</label><label class="expand" for="c-37964328">[1 more]</label></div><br/><div class="children"><div class="content">A reminder e2ee is a must.</div><br/></div></div><div id="37958447" class="c"><input type="checkbox" id="c-37958447" checked=""/><div class="controls bullet"><span class="by">zxwrt</span><span>|</span><a href="#37964328">prev</a><span>|</span><a href="#37962406">next</a><span>|</span><label class="collapse" for="c-37958447">[-]</label><label class="expand" for="c-37958447">[7 more]</label></div><br/><div class="children"><div class="content">What a nefarious move by Hetzner and Linode. How to trust them after this?</div><br/><div id="37959028" class="c"><input type="checkbox" id="c-37959028" checked=""/><div class="controls bullet"><span class="by">Nextgrid</span><span>|</span><a href="#37958447">parent</a><span>|</span><a href="#37959309">next</a><span>|</span><label class="collapse" for="c-37959028">[-]</label><label class="expand" for="c-37959028">[1 more]</label></div><br/><div class="children"><div class="content">If it&#x27;s a &quot;lawful intercept&quot; then they most likely have no choice.</div><br/></div></div><div id="37959309" class="c"><input type="checkbox" id="c-37959309" checked=""/><div class="controls bullet"><span class="by">dathinab</span><span>|</span><a href="#37958447">parent</a><span>|</span><a href="#37959028">prev</a><span>|</span><a href="#37962406">next</a><span>|</span><label class="collapse" for="c-37959309">[-]</label><label class="expand" for="c-37959309">[5 more]</label></div><br/><div class="children"><div class="content">first the article jumped the gun when saying it&#x27;s by Hetzner&#x2F;Linode, as it as much could have been done by the carrier the data-center connects to and from what I know about German espionage&#x2F;wiretapping by police law that would be far more likely<p>second pretty much _every_ country has laws which require carriers to help them wiretap in case of an investigation with appropriate court orders<p>thirdly even if it went through Hetzner&#x2F;Linode instead of carriers it wasn&#x27;t done &quot;a move from them&quot; but something they where legally binding ordered to silently tolerate<p>lastly if as unlikely as it seems it was not lawful interception of police or similar then they (or a carrier) would have been hacked, i.e. there is absolutely no chance that server providers will do such an attack on their own violation, especially Hetzner (they also don&#x27;t have the legal means to get the necessary certificates)</div><br/><div id="37960682" class="c"><input type="checkbox" id="c-37960682" checked=""/><div class="controls bullet"><span class="by">cassonmars</span><span>|</span><a href="#37958447">root</a><span>|</span><a href="#37959309">parent</a><span>|</span><a href="#37962229">next</a><span>|</span><label class="collapse" for="c-37960682">[-]</label><label class="expand" for="c-37960682">[1 more]</label></div><br/><div class="children"><div class="content">That &quot;lawful&quot; interception allows certificate issuance to be a means of wiretap completely undermines any trust one should have in CAs. It seems that an alternative is greatly needed.</div><br/></div></div><div id="37962229" class="c"><input type="checkbox" id="c-37962229" checked=""/><div class="controls bullet"><span class="by">scraptor</span><span>|</span><a href="#37958447">root</a><span>|</span><a href="#37959309">parent</a><span>|</span><a href="#37960682">prev</a><span>|</span><a href="#37962406">next</a><span>|</span><label class="collapse" for="c-37962229">[-]</label><label class="expand" for="c-37962229">[3 more]</label></div><br/><div class="children"><div class="content">The fact that they were legally required to MITM their customers does not make them more trustworthy (in the sense of unlikely to do it in the future), just the opposite!
Of course that applies equally to any other cloud host (modulo jurisdiction games) but that does little to restore my interest in running my software on other peoples computers.</div><br/><div id="37963371" class="c"><input type="checkbox" id="c-37963371" checked=""/><div class="controls bullet"><span class="by">wlonkly</span><span>|</span><a href="#37958447">root</a><span>|</span><a href="#37962229">parent</a><span>|</span><a href="#37963404">next</a><span>|</span><label class="collapse" for="c-37963371">[-]</label><label class="expand" for="c-37963371">[1 more]</label></div><br/><div class="children"><div class="content">Or, presumably, using other people&#x27;s internet peering, since the MITM was outside of the XMPP server host.<p>I think jurisdiction games is all you have, because outside of that there&#x27;s going to be _someone_ close to you network-wise who will fold when faced with a lawful intercept order.</div><br/></div></div><div id="37963404" class="c"><input type="checkbox" id="c-37963404" checked=""/><div class="controls bullet"><span class="by">Jenda_</span><span>|</span><a href="#37958447">root</a><span>|</span><a href="#37962229">parent</a><span>|</span><a href="#37963371">prev</a><span>|</span><a href="#37962406">next</a><span>|</span><label class="collapse" for="c-37963404">[-]</label><label class="expand" for="c-37963404">[1 more]</label></div><br/><div class="children"><div class="content">It&#x27;s not about &quot;other peoples computers&quot; (there is no evidence of the system itself to be backdoored). If you are running on your own hardware in your own house, you still need an ISP that can do exactly this time of MITM.</div><br/></div></div></div></div></div></div></div></div><div id="37962406" class="c"><input type="checkbox" id="c-37962406" checked=""/><div class="controls bullet"><span class="by">wizzard0</span><span>|</span><a href="#37958447">prev</a><span>|</span><a href="#37962540">next</a><span>|</span><label class="collapse" for="c-37962406">[-]</label><label class="expand" for="c-37962406">[1 more]</label></div><br/><div class="children"><div class="content">well i must admit monitoring certificate issuance with LetsEncrypt is quite boring even if you HAVE alerts set up (I do)<p>so… not surprised. Still cool. What a time to be alive</div><br/></div></div><div id="37962540" class="c"><input type="checkbox" id="c-37962540" checked=""/><div class="controls bullet"><span class="by">riku_iki</span><span>|</span><a href="#37962406">prev</a><span>|</span><a href="#37962144">next</a><span>|</span><label class="collapse" for="c-37962540">[-]</label><label class="expand" for="c-37962540">[4 more]</label></div><br/><div class="children"><div class="content">So, if I rent server in those services, it all potentially can be compromised and there is no way to make sure things are secure?..</div><br/><div id="37962554" class="c"><input type="checkbox" id="c-37962554" checked=""/><div class="controls bullet"><span class="by">bananapub</span><span>|</span><a href="#37962540">parent</a><span>|</span><a href="#37962144">next</a><span>|</span><label class="collapse" for="c-37962554">[-]</label><label class="expand" for="c-37962554">[3 more]</label></div><br/><div class="children"><div class="content">?  did you not read the article?</div><br/><div id="37962603" class="c"><input type="checkbox" id="c-37962603" checked=""/><div class="controls bullet"><span class="by">riku_iki</span><span>|</span><a href="#37962540">root</a><span>|</span><a href="#37962554">parent</a><span>|</span><a href="#37962144">next</a><span>|</span><label class="collapse" for="c-37962603">[-]</label><label class="expand" for="c-37962603">[2 more]</label></div><br/><div class="children"><div class="content">I briefly read the article, maybe you can explain what is your point?</div><br/><div id="37964620" class="c"><input type="checkbox" id="c-37964620" checked=""/><div class="controls bullet"><span class="by">_flux</span><span>|</span><a href="#37962540">root</a><span>|</span><a href="#37962603">parent</a><span>|</span><a href="#37962144">next</a><span>|</span><label class="collapse" for="c-37964620">[-]</label><label class="expand" for="c-37964620">[1 more]</label></div><br/><div class="children"><div class="content">The point is probably the heading of the final chapter &quot;Could you prevent or monitor this kind of attack?&quot; which enumerates the ways how you could detect this attack.</div><br/></div></div></div></div></div></div></div></div><div id="37962144" class="c"><input type="checkbox" id="c-37962144" checked=""/><div class="controls bullet"><span class="by">Traubenfuchs</span><span>|</span><a href="#37962540">prev</a><span>|</span><a href="#37962190">next</a><span>|</span><label class="collapse" for="c-37962144">[-]</label><label class="expand" for="c-37962144">[1 more]</label></div><br/><div class="children"><div class="content">We are using self developed application layer security. It requires specialized client code and is terminated at a gateway that proxies requests to our normal applications.<p>I really, really hate the idea of this kind of eavesdropping.</div><br/></div></div><div id="37962190" class="c"><input type="checkbox" id="c-37962190" checked=""/><div class="controls bullet"><span class="by">gigatexal</span><span>|</span><a href="#37962144">prev</a><span>|</span><a href="#37962051">next</a><span>|</span><label class="collapse" for="c-37962190">[-]</label><label class="expand" for="c-37962190">[4 more]</label></div><br/><div class="children"><div class="content">This is a deal breaker for me. Which is a shame because Hetzner has such great pricing. Oh well.</div><br/><div id="37962205" class="c"><input type="checkbox" id="c-37962205" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37962190">parent</a><span>|</span><a href="#37962198">next</a><span>|</span><label class="collapse" for="c-37962205">[-]</label><label class="expand" for="c-37962205">[1 more]</label></div><br/><div class="children"><div class="content">In fairness to them if it&#x27;s a lawful intercept then they have no choice.  Non compliance can shut down a business.<p>Your only alternatives in that case would be the underground style hosters sometimes <i>marketed</i> as <i>bullet-proof hosting</i> though they are just shady resellers with bold claims.  They do not typically last long.  There are a couple I know of in Amsterdam that are right down the street from The Hague that have been around for a while so I suspect they are just honeypots.</div><br/></div></div><div id="37962198" class="c"><input type="checkbox" id="c-37962198" checked=""/><div class="controls bullet"><span class="by">ComputerGuru</span><span>|</span><a href="#37962190">parent</a><span>|</span><a href="#37962205">prev</a><span>|</span><a href="#37962051">next</a><span>|</span><label class="collapse" for="c-37962198">[-]</label><label class="expand" for="c-37962198">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s likely legally enforced, and any other provider would be subject to the same.</div><br/><div id="37963910" class="c"><input type="checkbox" id="c-37963910" checked=""/><div class="controls bullet"><span class="by">gigatexal</span><span>|</span><a href="#37962190">root</a><span>|</span><a href="#37962198">parent</a><span>|</span><a href="#37962051">next</a><span>|</span><label class="collapse" for="c-37963910">[-]</label><label class="expand" for="c-37963910">[1 more]</label></div><br/><div class="children"><div class="content">Fair enough</div><br/></div></div></div></div></div></div><div id="37962051" class="c"><input type="checkbox" id="c-37962051" checked=""/><div class="controls bullet"><span class="by">SergeAx</span><span>|</span><a href="#37962190">prev</a><span>|</span><a href="#37960882">next</a><span>|</span><label class="collapse" for="c-37962051">[-]</label><label class="expand" for="c-37962051">[2 more]</label></div><br/><div class="children"><div class="content">And this is why, kids, you need to enforce certificate pinning on your critical infrastructure!</div><br/><div id="37962263" class="c"><input type="checkbox" id="c-37962263" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37962051">parent</a><span>|</span><a href="#37960882">next</a><span>|</span><label class="collapse" for="c-37962263">[-]</label><label class="expand" for="c-37962263">[1 more]</label></div><br/><div class="children"><div class="content">Public key pinning has been mostly abandoned on popular websites due to high risk of prolonged outages should someone make a mistake and mistakes do happen.<p>There are browser addons that replicate this behavior however and some Jabber clients&#x2F;servers apparently have their own mechanism for this [1] but one can only hope everyone is using the combination of servers and clients that support this feature.<p>[1] - <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37956911">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37956911</a></div><br/></div></div></div></div><div id="37960882" class="c"><input type="checkbox" id="c-37960882" checked=""/><div class="controls bullet"><span class="by">hnarn</span><span>|</span><a href="#37962051">prev</a><span>|</span><a href="#37959099">next</a><span>|</span><label class="collapse" for="c-37960882">[-]</label><label class="expand" for="c-37960882">[1 more]</label></div><br/><div class="children"><div class="content"><a href="http:&#x2F;&#x2F;archive.today&#x2F;0R7Or" rel="nofollow noreferrer">http:&#x2F;&#x2F;archive.today&#x2F;0R7Or</a></div><br/></div></div><div id="37959099" class="c"><input type="checkbox" id="c-37959099" checked=""/><div class="controls bullet"><span class="by">mak234</span><span>|</span><a href="#37960882">prev</a><span>|</span><a href="#37959951">next</a><span>|</span><label class="collapse" for="c-37959099">[-]</label><label class="expand" for="c-37959099">[2 more]</label></div><br/><div class="children"><div class="content">so is jabber.ru still secure now? what needs to be done on the user side to make it so? can one reissue&#x2F;request new server certificate from the server and not from let&#x27;s encrypt? thanks</div><br/><div id="37961255" class="c"><input type="checkbox" id="c-37961255" checked=""/><div class="controls bullet"><span class="by">zaik</span><span>|</span><a href="#37959099">parent</a><span>|</span><a href="#37959951">next</a><span>|</span><label class="collapse" for="c-37961255">[-]</label><label class="expand" for="c-37961255">[1 more]</label></div><br/><div class="children"><div class="content">If you have used OMEMO or OpenPGP to encrypt your messages, the content of your messages is secure, provided you have verified the public keys of your contacts. If you didn&#x27;t verify the keys, you should do it now and check that no suspicious keys have been injected.</div><br/></div></div></div></div><div id="37959951" class="c"><input type="checkbox" id="c-37959951" checked=""/><div class="controls bullet"><span class="by">AtNightWeCode</span><span>|</span><a href="#37959099">prev</a><span>|</span><a href="#37965027">next</a><span>|</span><label class="collapse" for="c-37959951">[-]</label><label class="expand" for="c-37959951">[2 more]</label></div><br/><div class="children"><div class="content">The way that certbot works with let&#x27;s encrypt the only surprise is that this does not occur more often. We have monitoring on several certs used for TLS. We should probably add an alert if an A-record changes as well.<p>I assume the root cause is DNS tricks.</div><br/><div id="37961558" class="c"><input type="checkbox" id="c-37961558" checked=""/><div class="controls bullet"><span class="by">ilyt</span><span>|</span><a href="#37959951">parent</a><span>|</span><a href="#37965027">next</a><span>|</span><label class="collapse" for="c-37961558">[-]</label><label class="expand" for="c-37961558">[1 more]</label></div><br/><div class="children"><div class="content">&gt; I assume the root cause is DNS tricks.<p>Maybe read the article</div><br/></div></div></div></div><div id="37959913" class="c"><input type="checkbox" id="c-37959913" checked=""/><div class="controls bullet"><span class="by">0xbadcafebee</span><span>|</span><a href="#37959085">prev</a><span>|</span><label class="collapse" for="c-37959913">[-]</label><label class="expand" for="c-37959913">[10 more]</label></div><br/><div class="children"><div class="content">Getting a valid cert for a domain you don&#x27;t own is getting close to trivial. All of the mitigation strategies are defeated a number of ways, have been for years. I&#x27;ve commented on incidents like these for years on HN. I&#x27;m not some internet big wig, and any blog I write isn&#x27;t going to trend, so this never gets traction. But anyone who understands the tech can find a half dozen ways to get a cert. If you really need to trust your connection, don&#x27;t rely on internet PKI &#x2F; public certs. It was secure enough for general purpose in the aughts, it&#x27;s not anymore.</div><br/><div id="37960057" class="c"><input type="checkbox" id="c-37960057" checked=""/><div class="controls bullet"><span class="by">dewey</span><span>|</span><a href="#37959913">parent</a><span>|</span><a href="#37960590">next</a><span>|</span><label class="collapse" for="c-37960057">[-]</label><label class="expand" for="c-37960057">[3 more]</label></div><br/><div class="children"><div class="content">What are these trival steps to get a valid certificate for news.ycombinator.com?</div><br/><div id="37962175" class="c"><input type="checkbox" id="c-37962175" checked=""/><div class="controls bullet"><span class="by">LinuxBender</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37960057">parent</a><span>|</span><a href="#37960126">next</a><span>|</span><label class="collapse" for="c-37962175">[-]</label><label class="expand" for="c-37962175">[1 more]</label></div><br/><div class="children"><div class="content">This would not be trivial and would require successful phishing.  I&#x27;ve sent an email requesting to make this even harder to do.  <i>leaving out those details on purpose</i></div><br/></div></div><div id="37960126" class="c"><input type="checkbox" id="c-37960126" checked=""/><div class="controls bullet"><span class="by">escalt</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37960057">parent</a><span>|</span><a href="#37962175">prev</a><span>|</span><a href="#37960590">next</a><span>|</span><label class="collapse" for="c-37960126">[-]</label><label class="expand" for="c-37960126">[1 more]</label></div><br/><div class="children"><div class="content">this is left as an exercise for the reader</div><br/></div></div></div></div><div id="37960590" class="c"><input type="checkbox" id="c-37960590" checked=""/><div class="controls bullet"><span class="by">gouggoug</span><span>|</span><a href="#37959913">parent</a><span>|</span><a href="#37960057">prev</a><span>|</span><label class="collapse" for="c-37960590">[-]</label><label class="expand" for="c-37960590">[6 more]</label></div><br/><div class="children"><div class="content">Bold claim lacking substantiation. Care to share? Maybe it will get traction this time.</div><br/><div id="37962628" class="c"><input type="checkbox" id="c-37962628" checked=""/><div class="controls bullet"><span class="by">0xbadcafebee</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37960590">parent</a><span>|</span><a href="#37960966">next</a><span>|</span><label class="collapse" for="c-37962628">[-]</label><label class="expand" for="c-37962628">[2 more]</label></div><br/><div class="children"><div class="content">It&#x27;s really not that bold. Ask anyone who works for a CA, or an ISP, or a registrar, or a mail hoster, or a browser manufacturer, or DNS provider... If you just read up on how PKI works, on how certificates get issued, how the network protocols work, etc, it&#x27;s all just right there. The holes are very well known and understood and not fixed because they&#x27;re in the design. Every so often somebody comes up with another mitigation, which of course you have to opt into, and still doesn&#x27;t solve all the holes.<p>It&#x27;s like SS7, or SWIFT. It&#x27;s not bold to claim that all public phone networks and bank transfers are insecure, it&#x27;s just a fact. People who know what they are know they&#x27;re vulnerable.<p>As an aside to the design issues, social engineering any of the thousands of organizations involved with issuing certs (not just CAs) is trivial. A bored teenager could get certs issued for most domains by using nothing more than a telephone or e-mail. But that&#x27;s cheating, so I don&#x27;t count it.</div><br/><div id="37962932" class="c"><input type="checkbox" id="c-37962932" checked=""/><div class="controls bullet"><span class="by">gouggoug</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37962628">parent</a><span>|</span><a href="#37960966">next</a><span>|</span><label class="collapse" for="c-37962932">[-]</label><label class="expand" for="c-37962932">[1 more]</label></div><br/><div class="children"><div class="content">Fair enough and this HN submission[0] goes into some details.<p>[0]<a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37961166">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=37961166</a></div><br/></div></div></div></div><div id="37960966" class="c"><input type="checkbox" id="c-37960966" checked=""/><div class="controls bullet"><span class="by">thriftwy</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37960590">parent</a><span>|</span><a href="#37962628">prev</a><span>|</span><label class="collapse" for="c-37960966">[-]</label><label class="expand" for="c-37960966">[3 more]</label></div><br/><div class="children"><div class="content">If you are your hoster and can reroute requests, you can get all kinds of valid SSL certs for any domains that you host.<p>Just grab these IP packets when CA comes to validate that you own that domain. Perhaps EV could solve that to some extent but it is never mandated.<p>Even if you tried to put any stuff into WHOIS to mitigate this, your hoster can serve any bullshit on this channel too.<p>It does look very bad and SSH approach to certificates is just infinitely better. If Jabber used SSL keys instead, they will be alerted immediately.<p>Come to think of it, your hoster can also find ways to steal keys directly from hardware, though.</div><br/><div id="37962292" class="c"><input type="checkbox" id="c-37962292" checked=""/><div class="controls bullet"><span class="by">dewey</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37960966">parent</a><span>|</span><label class="collapse" for="c-37962292">[-]</label><label class="expand" for="c-37962292">[2 more]</label></div><br/><div class="children"><div class="content">Step 1: Become a hoster popular enough that interesting targets are being hosted there</div><br/><div id="37962410" class="c"><input type="checkbox" id="c-37962410" checked=""/><div class="controls bullet"><span class="by">thriftwy</span><span>|</span><a href="#37959913">root</a><span>|</span><a href="#37962292">parent</a><span>|</span><label class="collapse" for="c-37962410">[-]</label><label class="expand" for="c-37962410">[1 more]</label></div><br/><div class="children"><div class="content">If you&#x27;re a government you may just bully existing ones.</div><br/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>